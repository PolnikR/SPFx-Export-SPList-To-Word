define("5a49faec-74c2-46c1-bb59-b48247b4204c_0.0.1",["@microsoft/sp-core-library","@microsoft/decorators","@microsoft/sp-listview-extensibility","@microsoft/sp-http"],function(e,t,r,n){return function(e){function t(n){if(r[n])return r[n].exports;var o=r[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var r={};return t.m=e,t.c=r,t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:n})},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=50)}([function(e,t,r){"use strict";(function(e){function n(e){if(null===e)return"";var t=e.indexOf("_api/");return t>-1?e.substr(0,t):e}Object.defineProperty(t,"__esModule",{value:!0});var o=r(4);t.extractWebUrl=n;var i=function(){function t(){}return t.getCtxCallback=function(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];return function(){t.apply(e,r)}},t.urlParamExists=function(e){return e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]"),new RegExp("[\\?&]"+e+"=([^&#]*)").test(location.search)},t.getUrlParamByName=function(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var t=new RegExp("[\\?&]"+e+"=([^&#]*)"),r=t.exec(location.search);return null==r?"":decodeURIComponent(r[1].replace(/\+/g," "))},t.getUrlParamBoolByName=function(e){var t=this.getUrlParamByName(e);return!(""===t||/false|0/i.test(t))},t.stringInsert=function(e,t,r){return t>0?e.substring(0,t)+r+e.substring(t,e.length):r+e},t.dateAdd=function(e,t,r){var n=new Date(e);switch(t.toLowerCase()){case"year":n.setFullYear(n.getFullYear()+r);break;case"quarter":n.setMonth(n.getMonth()+3*r);break;case"month":n.setMonth(n.getMonth()+r);break;case"week":n.setDate(n.getDate()+7*r);break;case"day":n.setDate(n.getDate()+r);break;case"hour":n.setTime(n.getTime()+36e5*r);break;case"minute":n.setTime(n.getTime()+6e4*r);break;case"second":n.setTime(n.getTime()+1e3*r);break;default:n=void 0}return n},t.loadStylesheet=function(e,t){t&&(e+="?"+encodeURIComponent((new Date).getTime().toString()));var r=document.getElementsByTagName("head");if(r.length>0){var n=document.createElement("link");r[0].appendChild(n),n.setAttribute("type","text/css"),n.setAttribute("rel","stylesheet"),n.setAttribute("href",e)}},t.combinePaths=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return e.filter(function(e){return!t.stringIsNullOrEmpty(e)}).map(function(e){return e.replace(/^[\\|\/]/,"").replace(/[\\|\/]$/,"")}).join("/").replace(/\\/g,"/")},t.getRandomString=function(e){for(var t=new Array(e),r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=0;n<e;n++)t[n]=r.charAt(Math.floor(Math.random()*r.length));return t.join("")},t.getGUID=function(){var e=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var r=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?r:3&r|8).toString(16)})},t.isFunction=function(e){return"function"==typeof e},t.isArray=function(e){return Array.isArray?Array.isArray(e):e&&"number"==typeof e.length&&e.constructor===Array},t.stringIsNullOrEmpty=function(e){return void 0===e||null===e||e.length<1},t.extend=function(e,t,r){if(void 0===r&&(r=!1),null===t||void 0===t)return e;var n=r?function(e,t){return!(t in e)}:function(){return!0};return Object.getOwnPropertyNames(t).filter(function(t){return n(e,t)}).reduce(function(e,r){return e[r]=t[r],e},e)},t.isUrlAbsolute=function(e){return/^https?:\/\/|^\/\//i.test(e)},t.toAbsoluteUrl=function(r){return new Promise(function(n){if(t.isUrlAbsolute(r))return n(r);if(null!==o.RuntimeConfig.spBaseUrl)return n(t.combinePaths(o.RuntimeConfig.spBaseUrl,r));if(void 0!==e._spPageContextInfo){if(e._spPageContextInfo.hasOwnProperty("webAbsoluteUrl"))return n(t.combinePaths(e._spPageContextInfo.webAbsoluteUrl,r));if(e._spPageContextInfo.hasOwnProperty("webServerRelativeUrl"))return n(t.combinePaths(e._spPageContextInfo.webServerRelativeUrl,r))}if(void 0!==e.location){var i=e.location.toString().toLowerCase();["/_layouts/","/siteassets/"].forEach(function(e){var o=i.indexOf(e);if(o>0)return n(t.combinePaths(i.substr(0,o),r))})}return n(r)})},t}();t.Util=i}).call(t,r(34))},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=r(0),i=r(10),s=r(11),a=r(2),u=r(5),l=r(22),c=r(23),p=r(24),d=function(e){function t(t,r){var n=e.call(this)||this;if(n._options={},n._query=new i.Dictionary,n._batch=null,"string"==typeof t){var s=t;if(o.Util.isUrlAbsolute(s)||s.lastIndexOf("/")<0)n._parentUrl=s,n._url=o.Util.combinePaths(s,r);else if(s.lastIndexOf("/")>s.lastIndexOf("(")){var a=s.lastIndexOf("/");n._parentUrl=s.slice(0,a),r=o.Util.combinePaths(s.slice(a),r),n._url=o.Util.combinePaths(n._parentUrl,r)}else{var a=s.lastIndexOf("(");n._parentUrl=s.slice(0,a),n._url=o.Util.combinePaths(s,r)}}else{var u=t;n._parentUrl=u._url,n._options=u._options;var l=u._query.get("@target");null!==l&&n._query.add("@target",l),n._url=o.Util.combinePaths(n._parentUrl,r)}return n}return n(t,e),t.prototype.addBatchDependency=function(){return this.hasBatch?this._batch.addDependency():function(){return null}},Object.defineProperty(t.prototype,"hasBatch",{get:function(){return null!==this._batch},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"batch",{get:function(){return this.hasBatch?this._batch:null},enumerable:!0,configurable:!0}),t.prototype.as=function(e){var t=new e(this._url,null);return o.Util.extend(t,this,!0)},t.prototype.inBatch=function(e){if(null!==this._batch)throw new a.AlreadyInBatchException;return this._batch=e,this},t.prototype.toUrlAndQuery=function(){var e=new i.Dictionary,t=this.toUrl().replace(/'!(@.*?)::(.*?)'/gi,function(t,r,n){return u.Logger.write("Rewriting aliased parameter from match "+t+" to label: "+r+" value: "+n,u.LogLevel.Verbose),e.add(r,"'"+n+"'"),r});return e.merge(this._query),e.count()>0&&(t+="?"+e.getKeys().map(function(t){return t+"="+e.get(t)}).join("&")),t},t.prototype.getParent=function(e,t,r,n){void 0===t&&(t=this.parentUrl);var o=new e(t,r);o.configure(this._options);var i=this.query.get("@target");return null!==i&&o.query.add("@target",i),void 0!==n&&(o=o.inBatch(n)),o},t.prototype.clone=function(e,t,r){void 0===r&&(r=!0);var n=new e(this,t);n.configure(this._options);var o=this.query.get("@target");return null!==o&&n.query.add("@target",o),r&&this.hasBatch&&(n=n.inBatch(this.batch)),n},t.prototype.toRequestContext=function(e,t,r,n){var i=this;void 0===t&&(t={}),void 0===n&&(n=c.PipelineMethods.default);var a=this.hasBatch?this.addBatchDependency():function(){};return o.Util.toAbsoluteUrl(this.toUrlAndQuery()).then(function(u){return s.mergeOptions(t,i._options),{batch:i._batch,batchDependency:a,cachingOptions:i._cachingOptions,clientFactory:function(){return new p.HttpClient},isBatched:i.hasBatch,isCached:i._useCaching,options:t,parser:r,pipeline:n,requestAbsoluteUrl:u,requestId:o.Util.getGUID(),verb:e}})},t}(l.ODataQueryable);t.SharePointQueryable=d;var f=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.filter=function(e){return this._query.add("$filter",e),this},t.prototype.select=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.length>0&&this._query.add("$select",e.join(",")),this},t.prototype.expand=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.length>0&&this._query.add("$expand",e.join(",")),this},t.prototype.orderBy=function(e,t){void 0===t&&(t=!0);for(var r=this._query.getKeys(),n=[],o=t?" asc":" desc",i=0;i<r.length;i++)if("$orderby"===r[i]){n.push(this._query.get("$orderby"));break}return n.push(""+e+o),this._query.add("$orderby",n.join(",")),this},t.prototype.skip=function(e){return this._query.add("$skip",e.toString()),this},t.prototype.top=function(e){return this._query.add("$top",e.toString()),this},t}(d);t.SharePointQueryableCollection=f;var h=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.select=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.length>0&&this._query.add("$select",e.join(",")),this},t.prototype.expand=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.length>0&&this._query.add("$expand",e.join(",")),this},t}(d);t.SharePointQueryableInstance=h},function(e,t,r){"use strict";function n(e){i.Logger.log({data:{},level:i.LogLevel.Error,message:"["+e.name+"]::"+e.message})}var o=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var i=r(5),s=function(e){function t(t,r,n){var o=e.call(this,"Error making HttpClient request in queryable: ["+t+"] "+r)||this;return o.status=t,o.statusText=r,o.data=n,o.name="ProcessHttpClientResponseException",i.Logger.log({data:o.data,level:i.LogLevel.Error,message:o.message}),o}return o(t,e),t}(Error);t.ProcessHttpClientResponseException=s;var a=function(e){function t(t){void 0===t&&(t="Cannot create a caching configuration provider since cache is not available.");var r=e.call(this,t)||this;return r.name="NoCacheAvailableException",n(r),r}return o(t,e),t}(Error);t.NoCacheAvailableException=a;var u=function(e){function t(t){void 0===t&&(t="Unable to determine API url.");var r=e.call(this,t)||this;return r.name="APIUrlException",n(r),r}return o(t,e),t}(Error);t.APIUrlException=u;var l=function(e){function t(t,r){void 0===r&&(r="Auth URL Endpoint could not be determined from data. Data logged.");var n=e.call(this,r)||this;return n.name="APIUrlException",i.Logger.log({data:t,level:i.LogLevel.Error,message:n.message}),n}return o(t,e),t}(Error);t.AuthUrlException=l;var c=function(e){function t(t){void 0===t&&(t="Using NodeFetchClient in the browser is not supported.");var r=e.call(this,t)||this;return r.name="NodeFetchClientUnsupportedException",n(r),r}return o(t,e),t}(Error);t.NodeFetchClientUnsupportedException=c;var p=function(e){function t(){var t=this,r=["SP.RequestExecutor is undefined. ","Load the SP.RequestExecutor.js library (/_layouts/15/SP.RequestExecutor.js) before loading the PnP JS Core library."].join(" ");return t=e.call(this,r)||this,t.name="SPRequestExecutorUndefinedException",n(t),t}return o(t,e),t}(Error);t.SPRequestExecutorUndefinedException=p;var d=function(e){function t(t){void 0===t&&(t="The maximum comment length is 1023 characters.");var r=e.call(this,t)||this;return r.name="MaxCommentLengthException",n(r),r}return o(t,e),t}(Error);t.MaxCommentLengthException=d;var f=function(e){function t(t){void 0===t&&(t="This operation");var r=e.call(this,t+" is not supported as part of a batch.")||this;return r.name="NotSupportedInBatchException",n(r),r}return o(t,e),t}(Error);t.NotSupportedInBatchException=f;var h=function(e){function t(t,r){void 0===r&&(r="Could not extract odata id in object, you may be using nometadata. Object data logged to logger.");var n=e.call(this,r)||this;return n.name="ODataIdException",i.Logger.log({data:t,level:i.LogLevel.Error,message:n.message}),n}return o(t,e),t}(Error);t.ODataIdException=h;var y=function(e){function t(t){var r=e.call(this,t)||this;return r.name="BatchParseException",n(r),r}return o(t,e),t}(Error);t.BatchParseException=y;var g=function(e){function t(t){void 0===t&&(t="This query is already part of a batch.");var r=e.call(this,t)||this;return r.name="AlreadyInBatchException",n(r),r}return o(t,e),t}(Error);t.AlreadyInBatchException=g;var b=function(e){function t(t){void 0===t&&(t="This query is already part of a batch.");var r=e.call(this,t)||this;return r.name="FunctionExpectedException",n(r),r}return o(t,e),t}(Error);t.FunctionExpectedException=b;var m=function(e){function t(t){var r=e.call(this,t)||this;return r.name="UrlException",n(r),r}return o(t,e),t}(Error);t.UrlException=m},function(e,t,r){"use strict";function n(e){if(e.hasOwnProperty("odata.id"))return e["odata.id"];if(e.hasOwnProperty("__metadata")&&e.__metadata.hasOwnProperty("id"))return e.__metadata.id;throw new c.ODataIdException(e)}function o(e){return e.hasOwnProperty("odata.metadata")&&e.hasOwnProperty("odata.editLink")?u.Util.combinePaths(u.extractWebUrl(e["odata.metadata"]),"_api",e["odata.editLink"]):e.hasOwnProperty("__metadata")?e.__metadata.uri:(l.Logger.write("No uri information found in ODataEntity parsing, chaining will fail for this object.",l.LogLevel.Warning),"")}function i(e){return new d(e)}function s(e){return new f(e)}var a=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var u=r(0),l=r(5),c=r(2),p=r(16);t.spExtractODataId=n;var d=function(e){function t(t){var r=e.call(this)||this;return r.factory=t,r.hydrate=function(e){var t=new r.factory(o(e),null);return u.Util.extend(t,e)},r}return a(t,e),t.prototype.parse=function(t){var r=this;return e.prototype.parse.call(this,t).then(function(e){var t=new r.factory(o(e),null);return u.Util.extend(t,e)})},t}(p.ODataParserBase),f=function(e){function t(t){var r=e.call(this)||this;return r.factory=t,r.hydrate=function(e){return e.map(function(e){var t=new r.factory(o(e),null);return u.Util.extend(t,e)})},r}return a(t,e),t.prototype.parse=function(t){var r=this;return e.prototype.parse.call(this,t).then(function(e){return e.map(function(e){var t=new r.factory(o(e),null);return u.Util.extend(t,e)})})},t}(p.ODataParserBase);t.spGetEntityUrl=o,t.spODataEntity=i,t.spODataEntityArray=s},function(e,t,r){"use strict";function n(e){s.set(e)}Object.defineProperty(t,"__esModule",{value:!0});var o=r(35),i=function(){function e(){this._defaultCachingStore="session",this._defaultCachingTimeoutSeconds=60,this._globalCacheDisable=!1,this._enableCacheExpiration=!1,this._cacheExpirationIntervalMilliseconds=750,this._spfxContext=null,this._spFetchClientFactory=function(){return new o.FetchClient},this._spBaseUrl=null,this._spHeaders=null,this._graphHeaders=null,this._graphFetchClientFactory=function(){return null}}return e.prototype.set=function(e){var t=this;if(e.hasOwnProperty("globalCacheDisable")&&(this._globalCacheDisable=e.globalCacheDisable),e.hasOwnProperty("defaultCachingStore")&&(this._defaultCachingStore=e.defaultCachingStore),e.hasOwnProperty("defaultCachingTimeoutSeconds")&&(this._defaultCachingTimeoutSeconds=e.defaultCachingTimeoutSeconds),e.hasOwnProperty("sp")&&(e.sp.hasOwnProperty("fetchClientFactory")&&(this._spFetchClientFactory=e.sp.fetchClientFactory),e.sp.hasOwnProperty("baseUrl")&&(this._spBaseUrl=e.sp.baseUrl),e.sp.hasOwnProperty("headers")&&(this._spHeaders=e.sp.headers)),e.hasOwnProperty("spfxContext")&&(this._spfxContext=e.spfxContext,void 0!==this._spfxContext.graphHttpClient&&(this._graphFetchClientFactory=function(){return t._spfxContext.graphHttpClient})),e.hasOwnProperty("graph")&&(e.graph.hasOwnProperty("headers")&&(this._graphHeaders=e.graph.headers),e.graph.hasOwnProperty("fetchClientFactory")&&(this._graphFetchClientFactory=e.graph.fetchClientFactory)),e.hasOwnProperty("enableCacheExpiration")&&(this._enableCacheExpiration=e.enableCacheExpiration),e.hasOwnProperty("cacheExpirationIntervalMilliseconds")){var r=e.cacheExpirationIntervalMilliseconds<300?300:e.cacheExpirationIntervalMilliseconds;this._cacheExpirationIntervalMilliseconds=r}},Object.defineProperty(e.prototype,"defaultCachingStore",{get:function(){return this._defaultCachingStore},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"defaultCachingTimeoutSeconds",{get:function(){return this._defaultCachingTimeoutSeconds},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"globalCacheDisable",{get:function(){return this._globalCacheDisable},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"spFetchClientFactory",{get:function(){return this._spFetchClientFactory},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"spBaseUrl",{get:function(){return null!==this._spBaseUrl?this._spBaseUrl:null!==this._spfxContext?this._spfxContext.pageContext.web.absoluteUrl:null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"spHeaders",{get:function(){return this._spHeaders},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"enableCacheExpiration",{get:function(){return this._enableCacheExpiration},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cacheExpirationIntervalMilliseconds",{get:function(){return this._cacheExpirationIntervalMilliseconds},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"spfxContext",{get:function(){return this._spfxContext},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"graphFetchClientFactory",{get:function(){return this._graphFetchClientFactory},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"graphHeaders",{get:function(){return this._graphHeaders},enumerable:!0,configurable:!0}),e}();t.RuntimeConfigImpl=i;var s=new i;t.RuntimeConfig=s,t.setRuntimeConfig=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;!function(e){e[e.Verbose=0]="Verbose",e[e.Info=1]="Info",e[e.Warning=2]="Warning",e[e.Error=3]="Error",e[e.Off=99]="Off"}(n=t.LogLevel||(t.LogLevel={}));var o=function(){function e(){}return Object.defineProperty(e,"activeLogLevel",{get:function(){return e.instance.activeLogLevel},set:function(t){e.instance.activeLogLevel=t},enumerable:!0,configurable:!0}),Object.defineProperty(e,"instance",{get:function(){return void 0!==e._instance&&null!==e._instance||(e._instance=new i),e._instance},enumerable:!0,configurable:!0}),e.subscribe=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];t.map(function(t){return e.instance.subscribe(t)})},e.clearSubscribers=function(){return e.instance.clearSubscribers()},Object.defineProperty(e,"count",{get:function(){return e.instance.count},enumerable:!0,configurable:!0}),e.write=function(t,r){void 0===r&&(r=n.Verbose),e.instance.log({level:r,message:t})},e.writeJSON=function(t,r){void 0===r&&(r=n.Verbose),e.instance.log({level:r,message:JSON.stringify(t)})},e.log=function(t){e.instance.log(t)},e.measure=function(t,r){return e.instance.measure(t,r)},e}();t.Logger=o;var i=function(){function e(e,t){void 0===e&&(e=n.Warning),void 0===t&&(t=[]),this.activeLogLevel=e,this.subscribers=t}return e.prototype.subscribe=function(e){this.subscribers.push(e)},e.prototype.clearSubscribers=function(){var e=this.subscribers.slice(0);return this.subscribers.length=0,e},Object.defineProperty(e.prototype,"count",{get:function(){return this.subscribers.length},enumerable:!0,configurable:!0}),e.prototype.write=function(e,t){void 0===t&&(t=n.Verbose),this.log({level:t,message:e})},e.prototype.log=function(e){void 0===e||e.level<this.activeLogLevel||this.subscribers.map(function(t){return t.log(e)})},e.prototype.measure=function(e,t){console.profile(e);try{return t()}finally{console.profileEnd()}},e}(),s=function(){function e(){}return e.prototype.log=function(e){var t=this.format(e);switch(e.level){case n.Verbose:case n.Info:console.log(t);break;case n.Warning:console.warn(t);break;case n.Error:console.error(t)}},e.prototype.format=function(e){var t=[];return t.push("Message: "+e.message),void 0!==e.data&&t.push(" Data: "+JSON.stringify(e.data)),t.join("")},e}();t.ConsoleListener=s;var a=function(){function e(e){this.method=e}return e.prototype.log=function(e){this.method(e)},e}();t.FunctionListener=a},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=r(0),i=r(10),s=r(48),a=r(22),u=r(23),l=function(e){function t(t,r){var n=e.call(this)||this;if(n._query=new i.Dictionary,"string"==typeof t){var s=t;n._parentUrl=s,n._url=o.Util.combinePaths(s,r)}else{var a=t;n._parentUrl=a._url,n._url=o.Util.combinePaths(n._parentUrl,r)}return n}return n(t,e),t.prototype.as=function(e){var t=new e(this._url,null);return o.Util.extend(t,this,!0)},t.prototype.toUrlAndQuery=function(){var e=this;return this.toUrl()+"?"+this._query.getKeys().map(function(t){return t+"="+e._query.get(t)}).join("&")},t.prototype.getParent=function(e,t,r){return void 0===t&&(t=this.parentUrl),new e(t,r)},t.prototype.clone=function(e,t,r){return void 0===r&&(r=!0),new e(this,t)},t.prototype.toRequestContext=function(e,t,r,n){return void 0===t&&(t={}),void 0===n&&(n=u.PipelineMethods.default),Promise.resolve({batch:null,batchDependency:function(){},cachingOptions:this._cachingOptions,clientFactory:function(){return new s.GraphHttpClient},isBatched:!1,isCached:this._useCaching,options:t,parser:r,pipeline:n,requestAbsoluteUrl:this.toUrlAndQuery(),requestId:o.Util.getGUID(),verb:e})},t}(a.ODataQueryable);t.GraphQueryable=l;var c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.filter=function(e){return this._query.add("$filter",e),this},t.prototype.select=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.length>0&&this._query.add("$select",e.join(",")),this},t.prototype.expand=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.length>0&&this._query.add("$expand",e.join(",")),this},t.prototype.orderBy=function(e,t){void 0===t&&(t=!0);for(var r=this._query.getKeys(),n=[],o=t?" asc":" desc",i=0;i<r.length;i++)if("$orderby"===r[i]){n.push(this._query.get("$orderby"));break}return n.push(""+e+o),this._query.add("$orderby",n.join(",")),this},t.prototype.top=function(e){return this._query.add("$top",e.toString()),this},t.prototype.skip=function(e){return this._query.add("$top",e.toString()),this},t.prototype.skipToken=function(e){return this._query.add("$skiptoken",e),this},Object.defineProperty(t.prototype,"count",{get:function(){return this._query.add("$count","true"),this},enumerable:!0,configurable:!0}),t}(l);t.GraphQueryableCollection=c;var p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.search=function(e){return this._query.add("$search",e),this},t}(c);t.GraphQueryableSearchableCollection=p;var d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.select=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.length>0&&this._query.add("$select",e.join(",")),this},t.prototype.expand=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.length>0&&this._query.add("$expand",e.join(",")),this},t}(l);t.GraphQueryableInstance=d},function(t,r){t.exports=e},function(e,t,r){"use strict";function n(){return new u}var o=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var i=r(16),s=r(0),a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t}(i.ODataParserBase);t.ODataDefaultParser=a;var u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.parse=function(t){return e.prototype.parse.call(this,t).then(function(e){return e})},t}(i.ODataParserBase);t.ODataValue=n;var l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.parseImpl=function(e,t){e.json().then(t)},t}(i.ODataParserBase);t.ODataRawParserImpl=l,t.ODataRaw=new l;var c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.parseImpl=function(e,t){e.text().then(t)},t}(i.ODataParserBase);t.TextFileParser=c;var p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.parseImpl=function(e,t){e.blob().then(t)},t}(i.ODataParserBase);t.BlobFileParser=p;var d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.parseImpl=function(e,t){e.json().then(t)},t}(i.ODataParserBase);t.JSONFileParser=d;var f=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.parseImpl=function(e,t){s.Util.isFunction(e.arrayBuffer)&&e.arrayBuffer().then(t),e.buffer().then(t)},t}(i.ODataParserBase);t.BufferFileParser=f},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=r(1),i=r(8),s=r(0),a=r(2),u=r(42),l=r(13),c=r(18),p=r(3),d=function(e){function t(t,r){return void 0===r&&(r="files"),e.call(this,t,r)||this}return n(t,e),t.prototype.getByName=function(e){var t=new f(this);return t.concat("('"+e+"')"),t},t.prototype.add=function(e,r,n){var o=this;return void 0===n&&(n=!0),new t(this,"add(overwrite="+n+",url='"+e+"')").postCore({body:r}).then(function(t){return{data:t,file:o.getByName(e)}})},t.prototype.addChunked=function(e,r,n,o,i){var s=this;return void 0===o&&(o=!0),void 0===i&&(i=10485760),this.clone(t,"add(overwrite="+o+",url='"+e+"')",!1).postCore().then(function(){return s.getByName(e)}).then(function(e){return e.setContentChunked(r,n,i)})},t.prototype.addTemplateFile=function(e,r){var n=this;return this.clone(t,"addTemplateFile(urloffile='"+e+"',templatefiletype="+r+")",!1).postCore().then(function(t){return{data:t,file:n.getByName(e)}})},t}(o.SharePointQueryableCollection);t.Files=d;var f=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),Object.defineProperty(t.prototype,"listItemAllFields",{get:function(){return new o.SharePointQueryableCollection(this,"listItemAllFields")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"versions",{get:function(){return new h(this)},enumerable:!0,configurable:!0}),t.prototype.approve=function(e){return void 0===e&&(e=""),this.clone(t,"approve(comment='"+e+"')").postCore()},t.prototype.cancelUpload=function(e){return this.clone(t,"cancelUpload(uploadId=guid'"+e+"')",!1).postCore()},t.prototype.checkin=function(e,r){if(void 0===e&&(e=""),void 0===r&&(r=g.Major),e.length>1023)throw new a.MaxCommentLengthException;return this.clone(t,"checkin(comment='"+e+"',checkintype="+r+")").postCore()},t.prototype.checkout=function(){return this.clone(t,"checkout").postCore()},t.prototype.copyTo=function(e,r){return void 0===r&&(r=!0),this.clone(t,"copyTo(strnewurl='"+e+"',boverwrite="+r+")").postCore()},t.prototype.delete=function(e){return void 0===e&&(e="*"),this.clone(t,null).postCore({headers:{"IF-Match":e,"X-HTTP-Method":"DELETE"}})},t.prototype.deny=function(e){if(void 0===e&&(e=""),e.length>1023)throw new a.MaxCommentLengthException;return this.clone(t,"deny(comment='"+e+"')").postCore()},t.prototype.getLimitedWebPartManager=function(e){return void 0===e&&(e=b.Shared),new u.LimitedWebPartManager(this,"getLimitedWebPartManager(scope="+e+")")},t.prototype.moveTo=function(e,r){return void 0===r&&(r=m.Overwrite),this.clone(t,"moveTo(newurl='"+e+"',flags="+r+")").postCore()},t.prototype.publish=function(e){if(void 0===e&&(e=""),e.length>1023)throw new a.MaxCommentLengthException;return this.clone(t,"publish(comment='"+e+"')").postCore()},t.prototype.recycle=function(){return this.clone(t,"recycle").postCore()},t.prototype.undoCheckout=function(){return this.clone(t,"undoCheckout").postCore()},t.prototype.unpublish=function(e){if(void 0===e&&(e=""),e.length>1023)throw new a.MaxCommentLengthException;return this.clone(t,"unpublish(comment='"+e+"')").postCore()},t.prototype.getText=function(){return this.clone(t,"$value",!1).get(new i.TextFileParser,{headers:{binaryStringResponseBody:"true"}})},t.prototype.getBlob=function(){return this.clone(t,"$value",!1).get(new i.BlobFileParser,{headers:{binaryStringResponseBody:"true"}})},t.prototype.getBuffer=function(){return this.clone(t,"$value",!1).get(new i.BufferFileParser,{headers:{binaryStringResponseBody:"true"}})},t.prototype.getJSON=function(){return this.clone(t,"$value",!1).get(new i.JSONFileParser,{headers:{binaryStringResponseBody:"true"}})},t.prototype.setContent=function(e){var r=this;return this.clone(t,"$value",!1).postCore({body:e,headers:{"X-HTTP-Method":"PUT"}}).then(function(e){return new t(r)})},t.prototype.getItem=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=this.listItemAllFields;return r.select.apply(r,e).get().then(function(e){return s.Util.extend(new l.Item(p.spGetEntityUrl(e)),e)})},t.prototype.setContentChunked=function(e,t,r){var n=this;void 0===r&&(r=10485760),void 0===t&&(t=function(){return null});var o=e.size,i=parseInt((e.size/r).toString(),10)+(e.size%r==0?1:0),a=s.Util.getGUID();t({uploadId:a,blockNumber:1,chunkSize:r,currentPointer:0,fileSize:o,stage:"starting",totalBlocks:i});for(var u=this.startUpload(a,e.slice(0,r)),l=2;l<i;l++)!function(s){u=u.then(function(u){return t({uploadId:a,blockNumber:s,chunkSize:r,currentPointer:u,fileSize:o,stage:"continue",totalBlocks:i}),n.continueUpload(a,u,e.slice(u,u+r))})}(l);return u.then(function(s){return t({uploadId:a,blockNumber:i,chunkSize:r,currentPointer:s,fileSize:o,stage:"finishing",totalBlocks:i}),n.finishUpload(a,s,e.slice(s))})},t.prototype.startUpload=function(e,r){return this.clone(t,"startUpload(uploadId=guid'"+e+"')",!1).postAsCore({body:r}).then(function(e){return"object"==typeof e&&(e=e.StartUpload),parseFloat(e)})},t.prototype.continueUpload=function(e,r,n){return this.clone(t,"continueUpload(uploadId=guid'"+e+"',fileOffset="+r+")",!1).postAsCore({body:n}).then(function(e){return"object"==typeof e&&(e=e.ContinueUpload),parseFloat(e)})},t.prototype.finishUpload=function(e,r,n){return this.clone(t,"finishUpload(uploadId=guid'"+e+"',fileOffset="+r+")",!1).postAsCore({body:n}).then(function(e){return{data:e,file:new t(e.ServerRelativeUrl)}})},t}(c.SharePointQueryableShareableFile);t.File=f;var h=function(e){function t(t,r){return void 0===r&&(r="versions"),e.call(this,t,r)||this}return n(t,e),t.prototype.getById=function(e){var t=new y(this);return t.concat("("+e+")"),t},t.prototype.deleteAll=function(){return new t(this,"deleteAll").postCore()},t.prototype.deleteById=function(e){return this.clone(t,"deleteById(vid="+e+")").postCore()},t.prototype.recycleByID=function(e){return this.clone(t,"recycleByID(vid="+e+")").postCore()},t.prototype.deleteByLabel=function(e){return this.clone(t,"deleteByLabel(versionlabel='"+e+"')").postCore()},t.prototype.recycleByLabel=function(e){return this.clone(t,"recycleByLabel(versionlabel='"+e+"')").postCore()},t.prototype.restoreByLabel=function(e){return this.clone(t,"restoreByLabel(versionlabel='"+e+"')").postCore()},t}(o.SharePointQueryableCollection);t.Versions=h;var y=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.delete=function(e){return void 0===e&&(e="*"),this.postCore({headers:{"IF-Match":e,"X-HTTP-Method":"DELETE"}})},t.prototype.openBinaryStream=function(){return this.clone(t,"openBinaryStream").postCore()},t}(o.SharePointQueryableInstance);t.Version=y;var g;!function(e){e[e.Minor=0]="Minor",e[e.Major=1]="Major",e[e.Overwrite=2]="Overwrite"}(g=t.CheckinType||(t.CheckinType={}));var b;!function(e){e[e.User=0]="User",e[e.Shared=1]="Shared"}(b=t.WebPartsPersonalizationScope||(t.WebPartsPersonalizationScope={}));var m;!function(e){e[e.Overwrite=1]="Overwrite",e[e.AllowBrokenThickets=8]="AllowBrokenThickets"}(m=t.MoveOperations||(t.MoveOperations={}));!function(e){e[e.StandardPage=0]="StandardPage",e[e.WikiPage=1]="WikiPage",e[e.FormPage=2]="FormPage",e[e.ClientSidePage=3]="ClientSidePage"}(t.TemplateFileType||(t.TemplateFileType={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){void 0===e&&(e=[]),void 0===t&&(t=[]),this.keys=e,this.values=t}return e.prototype.get=function(e){var t=this.keys.indexOf(e);return t<0?null:this.values[t]},e.prototype.add=function(e,t){var r=this.keys.indexOf(e);r>-1?this.values[r]=t:(this.keys.push(e),this.values.push(t))},e.prototype.merge=function(e){var t=this;if("getKeys"in e){var r=e;r.getKeys().map(function(e){t.add(e,r.get(e))})}else{var n=e;for(var o in n)n.hasOwnProperty(o)&&this.add(o,n[o])}},e.prototype.remove=function(e){var t=this.keys.indexOf(e);if(t<0)return null;var r=this.values[t];return this.keys.splice(t,1),this.values.splice(t,1),r},e.prototype.getKeys=function(){return this.keys},e.prototype.getValues=function(){return this.values},e.prototype.clear=function(){this.keys=[],this.values=[]},e.prototype.count=function(){return this.keys.length},e}();t.Dictionary=n},function(e,t,r){"use strict";function n(e,t){e.headers=e.headers||{};var r=i.Util.extend(e.headers,t.headers);e=i.Util.extend(e,t),e.headers=r}function o(e,t){if(void 0!==t&&null!==t){new Request("",{headers:t}).headers.forEach(function(t,r){e.append(r,t)})}}Object.defineProperty(t,"__esModule",{value:!0});var i=r(0);t.mergeOptions=n,t.mergeHeaders=o},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=r(1),i=r(17),s=r(28),a=r(30),u=r(26),l=r(27),c=r(66),p=r(20),d=r(25),f=r(9),h=r(0),y=r(17),g=r(41),b=r(29),m=r(3),v=r(31),w=r(43),P=r(18),_=r(67),S=r(44),C=r(45),O=function(e){function t(t,r){return void 0===r&&(r="webs"),e.call(this,t,r)||this}return n(t,e),t.prototype.add=function(e,r,n,o,i,s){void 0===n&&(n=""),void 0===o&&(o="STS"),void 0===i&&(i=1033),void 0===s&&(s=!0);var a={Description:n,Language:i,Title:e,Url:r,UseSamePermissionsAsParentSite:s,WebTemplate:o},u=JSON.stringify({parameters:h.Util.extend({__metadata:{type:"SP.WebCreationInformation"}},a)});return this.clone(t,"add").postCore({body:u}).then(function(e){return{data:e,web:new T(m.spExtractODataId(e).replace(/_api\/web\/?/i,""))}})},t}(o.SharePointQueryableCollection);t.Webs=O;var x=function(e){function t(t,r){return void 0===r&&(r="webinfos"),e.call(this,t,r)||this}return n(t,e),t}(o.SharePointQueryableCollection);t.WebInfos=x;var T=function(e){function t(t,r){return void 0===r&&(r="_api/web"),e.call(this,t,r)||this}return n(t,e),t.fromUrl=function(e,r){return new t(h.extractWebUrl(e),r)},Object.defineProperty(t.prototype,"webs",{get:function(){return new O(this)},enumerable:!0,configurable:!0}),t.prototype.getSubwebsFilteredForCurrentUser=function(e,t){return void 0===e&&(e=-1),void 0===t&&(t=-1),this.clone(O,"getSubwebsFilteredForCurrentUser(nWebTemplateFilter="+e+",nConfigurationFilter="+t+")")},Object.defineProperty(t.prototype,"allProperties",{get:function(){return this.clone(o.SharePointQueryableCollection,"allproperties")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"webinfos",{get:function(){return new x(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"contentTypes",{get:function(){return new l.ContentTypes(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"lists",{get:function(){return new i.Lists(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fields",{get:function(){return new s.Fields(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"features",{get:function(){return new w.Features(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"availablefields",{get:function(){return new s.Fields(this,"availablefields")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"navigation",{get:function(){return new a.Navigation(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"siteUsers",{get:function(){return new g.SiteUsers(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"siteGroups",{get:function(){return new u.SiteGroups(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"siteUserInfoList",{get:function(){return new y.List(this,"siteuserinfolist")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"regionalSettings",{get:function(){return new c.RegionalSettings(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"currentUser",{get:function(){return new g.CurrentUser(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"folders",{get:function(){return new p.Folders(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"userCustomActions",{get:function(){return new b.UserCustomActions(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"effectiveBasePermissions",{get:function(){return new o.SharePointQueryable(this,"effectivebasepermissions")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"roleDefinitions",{get:function(){return new d.RoleDefinitions(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"relatedItems",{get:function(){return _.RelatedItemManagerImpl.FromUrl(this.toUrl())},enumerable:!0,configurable:!0}),t.prototype.createBatch=function(){return new v.ODataBatch(this.parentUrl)},Object.defineProperty(t.prototype,"rootFolder",{get:function(){return new p.Folder(this,"rootFolder")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"associatedOwnerGroup",{get:function(){return new u.SiteGroup(this,"associatedownergroup")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"associatedMemberGroup",{get:function(){return new u.SiteGroup(this,"associatedmembergroup")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"associatedVisitorGroup",{get:function(){return new u.SiteGroup(this,"associatedvisitorgroup")},enumerable:!0,configurable:!0}),t.prototype.getFolderByServerRelativeUrl=function(e){return new p.Folder(this,"getFolderByServerRelativeUrl('"+e+"')")},t.prototype.getFolderByServerRelativePath=function(e){return new p.Folder(this,"getFolderByServerRelativePath(decodedUrl='"+e+"')")},t.prototype.getFileByServerRelativeUrl=function(e){return new f.File(this,"getFileByServerRelativeUrl('"+e+"')")},t.prototype.getFileByServerRelativePath=function(e){return new f.File(this,"getFileByServerRelativePath(decodedUrl='"+e+"')")},t.prototype.getList=function(e){return new y.List(this,"getList('"+e+"')")},t.prototype.update=function(e){var t=this,r=JSON.stringify(h.Util.extend({__metadata:{type:"SP.Web"}},e));return this.postCore({body:r,headers:{"X-HTTP-Method":"MERGE"}}).then(function(e){return{data:e,web:t}})},t.prototype.delete=function(){return e.prototype.deleteCore.call(this)},t.prototype.applyTheme=function(e,r,n,o){var i=JSON.stringify({backgroundImageUrl:n,colorPaletteUrl:e,fontSchemeUrl:r,shareGenerated:o});return this.clone(t,"applytheme").postCore({body:i})},t.prototype.applyWebTemplate=function(e){var r=this.clone(t,"applywebtemplate");return r.concat("(@t)"),r.query.add("@t",e),r.postCore()},t.prototype.ensureUser=function(e){var r=JSON.stringify({logonName:e});return this.clone(t,"ensureuser").postCore({body:r}).then(function(e){return{data:e,user:new g.SiteUser(m.spExtractODataId(e))}})},t.prototype.availableWebTemplates=function(e,t){return void 0===e&&(e=1033),void 0===t&&(t=!0),new o.SharePointQueryableCollection(this,"getavailablewebtemplates(lcid="+e+", doincludecrosslanguage="+t+")")},t.prototype.getCatalog=function(e){return this.clone(t,"getcatalog("+e+")").select("Id").get().then(function(e){return new y.List(m.spExtractODataId(e))})},t.prototype.getChanges=function(e){var r=JSON.stringify({query:h.Util.extend({__metadata:{type:"SP.ChangeQuery"}},e)});return this.clone(t,"getchanges").postCore({body:r})},Object.defineProperty(t.prototype,"customListTemplate",{get:function(){return new o.SharePointQueryableCollection(this,"getcustomlisttemplates")},enumerable:!0,configurable:!0}),t.prototype.getUserById=function(e){return new g.SiteUser(this,"getUserById("+e+")")},t.prototype.mapToIcon=function(e,r,n){return void 0===r&&(r=0),void 0===n&&(n=""),this.clone(t,"maptoicon(filename='"+e+"', progid='"+n+"', size="+r+")").get()},t.prototype.getStorageEntity=function(e){return this.clone(t,"getStorageEntity('"+e+"')").get()},t.prototype.getAppCatalog=function(e){return new S.AppCatalog(e||this)},t.prototype.getClientSideWebParts=function(){return this.clone(o.SharePointQueryableCollection,"GetClientSideWebParts").get()},t.prototype.addClientSidePage=function(e,t,r){return void 0===t&&(t=e.replace(/\.[^\/.]+$/,"")),void 0===r&&(r="Site Pages"),C.ClientSidePage.create(this.lists.getByTitle(r),e,t)},t.prototype.addClientSidePageByPath=function(e,t,r){return void 0===r&&(r=e.replace(/\.[^\/.]+$/,"")),C.ClientSidePage.create(this.getList(t),e,r)},t}(P.SharePointQueryableShareableWeb);t.Web=T},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=r(1),i=r(18),s=r(20),a=r(9),u=r(27),l=r(0),c=r(16),p=r(62),d=r(17),f=r(33),h=function(e){function t(t,r){return void 0===r&&(r="items"),e.call(this,t,r)||this}return n(t,e),t.prototype.getById=function(e){var t=new y(this);return t.concat("("+e+")"),t},t.prototype.getItemByStringId=function(e){var t=new y(this);return t.concat("/../getItemByStringId('"+e+"')"),t},t.prototype.skip=function(e,t){return void 0===t&&(t=!1),t?this._query.add("$skiptoken",encodeURIComponent("Paged=TRUE&PagedPrev=TRUE&p_ID="+e)):this._query.add("$skiptoken",encodeURIComponent("Paged=TRUE&p_ID="+e)),this},t.prototype.getPaged=function(){return this.getAs(new v)},t.prototype.getAll=function(e){var r=this;void 0===e&&(e=2e3),f.Logger.write("Calling items.getAll should be done sparingly. Ensure this is the correct choice. If you are unsure, it is not.",f.LogLevel.Warning);var n=new t(this,"").top(e).configure({headers:{Accept:"application/json;odata=nometadata"}});return this.query.getKeys().filter(function(e){return/^\$select$|^\$filter$|^\$top$|^\$expand$/.test(e.toLowerCase())}).reduce(function(e,t){return e.query.add(t,r.query.get(t)),e},n),new Promise(function(e,t){var r=[],o=function(n){[].push.apply(r,n.results),n.hasNext?n.getNext().then(o).catch(t):e(r)};n.getPaged().then(o).catch(t)})},t.prototype.add=function(e,r){var n=this;void 0===e&&(e={}),void 0===r&&(r=null);var o=this.addBatchDependency();return this.ensureListItemEntityTypeName(r).then(function(r){var i=JSON.stringify(l.Util.extend({__metadata:{type:r}},e)),s=n.clone(t,null).postAsCore({body:i}).then(function(e){return{data:e,item:n.getById(e.Id)}});return o(),s})},t.prototype.ensureListItemEntityTypeName=function(e){return e?Promise.resolve(e):this.getParent(d.List).getListItemEntityTypeFullName()},t}(o.SharePointQueryableCollection);t.Items=h;var y=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),Object.defineProperty(t.prototype,"attachmentFiles",{get:function(){return new p.AttachmentFiles(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"contentType",{get:function(){return new u.ContentType(this,"ContentType")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"effectiveBasePermissions",{get:function(){return new o.SharePointQueryable(this,"EffectiveBasePermissions")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"effectiveBasePermissionsForUI",{get:function(){return new o.SharePointQueryable(this,"EffectiveBasePermissionsForUI")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fieldValuesAsHTML",{get:function(){return new o.SharePointQueryableInstance(this,"FieldValuesAsHTML")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fieldValuesAsText",{get:function(){return new o.SharePointQueryableInstance(this,"FieldValuesAsText")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fieldValuesForEdit",{get:function(){return new o.SharePointQueryableInstance(this,"FieldValuesForEdit")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"folder",{get:function(){return new s.Folder(this,"folder")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"file",{get:function(){return new a.File(this,"file")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"versions",{get:function(){return new b(this)},enumerable:!0,configurable:!0}),t.prototype.update=function(e,t,r){var n=this;return void 0===t&&(t="*"),void 0===r&&(r=null),new Promise(function(o,i){var s=n.addBatchDependency();return n.ensureListItemEntityTypeName(r).then(function(r){var i=JSON.stringify(l.Util.extend({__metadata:{type:r}},e));return s(),n.postCore({body:i,headers:{"IF-Match":t,"X-HTTP-Method":"MERGE"}},new w).then(function(e){o({data:e,item:n})})}).catch(function(e){return i(e)})})},t.prototype.delete=function(e){return void 0===e&&(e="*"),this.postCore({headers:{"IF-Match":e,"X-HTTP-Method":"DELETE"}})},t.prototype.recycle=function(){return this.clone(t,"recycle").postCore()},t.prototype.getWopiFrameUrl=function(e){void 0===e&&(e=0);var r=this.clone(t,"getWOPIFrameUrl(@action)");return r._query.add("@action",e),r.postCore().then(function(e){return e.hasOwnProperty("GetWOPIFrameUrl")?e.GetWOPIFrameUrl:e})},t.prototype.validateUpdateListItem=function(e,r){return void 0===r&&(r=!1),this.clone(t,"validateupdatelistitem").postCore({body:JSON.stringify({formValues:e,bNewDocumentUpdate:r})})},t.prototype.ensureListItemEntityTypeName=function(e){return e?Promise.resolve(e):this.getParent(d.List,this.parentUrl.substr(0,this.parentUrl.lastIndexOf("/"))).getListItemEntityTypeFullName()},t}(i.SharePointQueryableShareableItem);t.Item=y;var g=function(){function e(e,t){this.nextUrl=e,this.results=t}return Object.defineProperty(e.prototype,"hasNext",{get:function(){return"string"==typeof this.nextUrl&&this.nextUrl.length>0},enumerable:!0,configurable:!0}),e.prototype.getNext=function(){if(this.hasNext){return new h(this.nextUrl,null).getPaged()}return new Promise(function(e){return e(null)})},e}();t.PagedItemCollection=g;var b=function(e){function t(t,r){return void 0===r&&(r="versions"),e.call(this,t,r)||this}return n(t,e),t.prototype.getById=function(e){var t=new m(this);return t.concat("("+e+")"),t},t}(o.SharePointQueryableCollection);t.ItemVersions=b;var m=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.delete=function(){return this.postCore({headers:{"X-HTTP-Method":"DELETE"}})},t}(o.SharePointQueryableInstance);t.ItemVersion=m;var v=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.parse=function(e){var t=this;return new Promise(function(r,n){t.handleError(e,n)&&e.json().then(function(e){var n=e.hasOwnProperty("d")&&e.d.hasOwnProperty("__next")?e.d.__next:e["odata.nextLink"];r(new g(n,t.parseODataJSON(e)))})})},t}(c.ODataParserBase),w=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.parse=function(e){var t=this;return new Promise(function(r,n){t.handleError(e,n)&&r({"odata.etag":e.headers.get("etag")})})},t}(c.ODataParserBase)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(7),o=function(){function e(){}return e.isEmptyString=function(e){try{return n.Validate.isNonemptyString(e,"value"),!1}catch(e){return!0}},e.isNull=function(e){try{return n.Validate.isNotNullOrUndefined(e,"value"),!1}catch(e){return!0}},e.getFieldInternalName=function(e){try{return n.Text.replaceAll(e," ","_x0020_")}catch(e){throw e}},e.getParameterValue=function(e,t){return new n.UrlQueryParameterCollection(e).getValue(t)},e.calculateAge=function(e){try{var t=new Date(e),r=Date.now()-t.getTime(),n=new Date(r),o=n.getUTCFullYear()-1970;return o=o>0?o:0}catch(e){return-1}},e.getLocalStorage=function(){return e.isNull(typeof Storage)?void 0:localStorage},e}();t.SPCore=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(10),i=r(4),s=r(5),a=function(){function e(e,t){this.store=e,this.defaultTimeoutMinutes=t,this.defaultTimeoutMinutes=void 0===t?-1:t,this.enabled=this.test(),i.RuntimeConfig.enableCacheExpiration&&(s.Logger.write("Enabling cache expiration.",s.LogLevel.Info),this.cacheExpirationHandler())}return e.prototype.get=function(e){if(!this.enabled)return null;var t=this.store.getItem(e);if(null==t)return null;var r=JSON.parse(t);return new Date(r.expiration)<=new Date?(s.Logger.write("Removing item with key '"+e+"' from cache due to expiration.",s.LogLevel.Info),this.delete(e),null):r.value},e.prototype.put=function(e,t,r){this.enabled&&this.store.setItem(e,this.createPersistable(t,r))},e.prototype.delete=function(e){this.enabled&&this.store.removeItem(e)},e.prototype.getOrPut=function(e,t,r){var n=this;return this.enabled?new Promise(function(o){var i=n.get(e);null==i?t().then(function(t){n.put(e,t,r),o(t)}):o(i)}):t()},e.prototype.deleteExpired=function(){var e=this;return new Promise(function(t,r){e.enabled||t();try{for(var n=0;n<e.store.length;n++){var o=e.store.key(n);/["|']?pnp["|']? ?: ?1/i.test(e.store.getItem(o))&&e.get(o)}t()}catch(e){r(e)}})},e.prototype.test=function(){try{return this.store.setItem("test","test"),this.store.removeItem("test"),!0}catch(e){return!1}},e.prototype.createPersistable=function(e,t){if(void 0===t){var r=i.RuntimeConfig.defaultCachingTimeoutSeconds;this.defaultTimeoutMinutes>0&&(r=60*this.defaultTimeoutMinutes),t=n.Util.dateAdd(new Date,"second",r)}return JSON.stringify({pnp:1,expiration:t,value:e})},e.prototype.cacheExpirationHandler=function(){var e=this;s.Logger.write("Called cache expiration handler.",s.LogLevel.Verbose),this.deleteExpired().then(function(t){setTimeout(n.Util.getCtxCallback(e,e.cacheExpirationHandler),i.RuntimeConfig.cacheExpirationIntervalMilliseconds)}).catch(function(e){s.Logger.log({data:e,level:s.LogLevel.Error,message:"Error deleting expired cache entries, see data for details. Timeout not reset."})})},e}();t.PnPClientStorageWrapper=a;var u=function(){function e(e){void 0===e&&(e=new o.Dictionary),this._store=e}return Object.defineProperty(e.prototype,"length",{get:function(){return this._store.count()},enumerable:!0,configurable:!0}),e.prototype.clear=function(){this._store.clear()},e.prototype.getItem=function(e){return this._store.get(e)},e.prototype.key=function(e){return this._store.getKeys()[e]},e.prototype.removeItem=function(e){this._store.remove(e)},e.prototype.setItem=function(e,t){this._store.add(e,t)},e}(),l=function(){function e(e,t){void 0===e&&(e=null),void 0===t&&(t=null),this._local=e,this._session=t}return Object.defineProperty(e.prototype,"local",{get:function(){return null===this._local&&(this._local=new a("undefined"!=typeof localStorage?localStorage:new u)),this._local},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"session",{get:function(){return null===this._session&&(this._session=new a("undefined"!=typeof sessionStorage?sessionStorage:new u)),this._session},enumerable:!0,configurable:!0}),e}();t.PnPClientStorage=l},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2),o=r(5),i=function(){function e(){}return e.prototype.parse=function(e){var t=this;return new Promise(function(r,n){t.handleError(e,n)&&t.parseImpl(e,r,n)})},e.prototype.parseImpl=function(e,t,r){var n=this;e.headers.has("Content-Length")&&0===parseFloat(e.headers.get("Content-Length"))||204===e.status?t({}):e.text().then(function(e){return e.replace(/\s/gi,"").length>0?JSON.parse(e):{}}).then(function(e){return t(n.parseODataJSON(e))}).catch(function(e){return r(e)})},e.prototype.handleError=function(e,t){return e.ok||e.json().then(function(r){var o={responseBody:r,responseHeaders:e.headers};t(new n.ProcessHttpClientResponseException(e.status,e.statusText,o))}).catch(function(r){o.Logger.log({data:r,level:o.LogLevel.Warning,message:"There was an error parsing the error response body. See data for details."});var i={responseBody:"[[body not available]]",responseHeaders:e.headers};t(new n.ProcessHttpClientResponseException(e.status,e.statusText,i))}),e.ok},e.prototype.parseODataJSON=function(e){var t=e;return e.hasOwnProperty("d")?t=e.d.hasOwnProperty("results")?e.d.results:e.d:e.hasOwnProperty("value")&&(t=e.value),t},e}();t.ODataParserBase=i},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=r(13),i=r(63),s=r(27),a=r(28),u=r(64),l=r(65),c=r(1),p=r(40),d=r(0),f=r(29),h=r(3),y=r(2),g=r(20),b=function(e){function t(t,r){return void 0===r&&(r="lists"),e.call(this,t,r)||this}return n(t,e),t.prototype.getByTitle=function(e){return new m(this,"getByTitle('"+e+"')")},t.prototype.getById=function(e){var t=new m(this);return t.concat("('"+e+"')"),t},t.prototype.add=function(e,t,r,n,o){var i=this;void 0===t&&(t=""),void 0===r&&(r=100),void 0===n&&(n=!1),void 0===o&&(o={});var s=d.Util.extend({AllowContentTypes:n,BaseTemplate:r,ContentTypesEnabled:n,Description:t,Title:e,__metadata:{type:"SP.List"}},o);return this.postCore({body:JSON.stringify(s)}).then(function(e){return{data:e,list:i.getByTitle(s.Title)}})},t.prototype.ensure=function(e,t,r,n,o){var i=this;if(void 0===t&&(t=""),void 0===r&&(r=100),void 0===n&&(n=!1),void 0===o&&(o={}),this.hasBatch)throw new y.NotSupportedInBatchException("The ensure list method");return new Promise(function(s,a){var u=d.Util.extend(o,{Title:e,Description:t,ContentTypesEnabled:n},!0),l=i.getByTitle(u.Title);l.get().then(function(e){l.update(u).then(function(e){s({created:!1,data:e,list:i.getByTitle(u.Title)})}).catch(function(e){return a(e)})}).catch(function(o){i.add(e,t,r,n,u).then(function(e){s({created:!0,data:e.data,list:i.getByTitle(u.Title)})}).catch(function(e){return a(e)})})})},t.prototype.ensureSiteAssetsLibrary=function(){return this.clone(t,"ensuresiteassetslibrary").postCore().then(function(e){return new m(h.spExtractODataId(e))})},t.prototype.ensureSitePagesLibrary=function(){return this.clone(t,"ensuresitepageslibrary").postCore().then(function(e){return new m(h.spExtractODataId(e))})},t}(c.SharePointQueryableCollection);t.Lists=b;var m=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),Object.defineProperty(t.prototype,"contentTypes",{get:function(){return new s.ContentTypes(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"items",{get:function(){return new o.Items(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"views",{get:function(){return new i.Views(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fields",{get:function(){return new a.Fields(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"forms",{get:function(){return new u.Forms(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"defaultView",{get:function(){return new i.View(this,"DefaultView")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"userCustomActions",{get:function(){return new f.UserCustomActions(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"effectiveBasePermissions",{get:function(){return new c.SharePointQueryable(this,"EffectiveBasePermissions")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"eventReceivers",{get:function(){return new c.SharePointQueryableCollection(this,"EventReceivers")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"relatedFields",{get:function(){return new c.SharePointQueryable(this,"getRelatedFields")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"informationRightsManagementSettings",{get:function(){return new c.SharePointQueryable(this,"InformationRightsManagementSettings")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"subscriptions",{get:function(){return new l.Subscriptions(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rootFolder",{get:function(){return new g.Folder(this,"rootFolder")},enumerable:!0,configurable:!0}),t.prototype.getView=function(e){return new i.View(this,"getView('"+e+"')")},t.prototype.update=function(e,r){var n=this;void 0===r&&(r="*");var o=JSON.stringify(d.Util.extend({__metadata:{type:"SP.List"}},e));return this.postCore({body:o,headers:{"IF-Match":r,"X-HTTP-Method":"MERGE"}}).then(function(r){var o=n;return e.hasOwnProperty("Title")&&(o=n.getParent(t,n.parentUrl,"getByTitle('"+e.Title+"')")),{data:r,list:o}})},t.prototype.delete=function(e){return void 0===e&&(e="*"),this.postCore({headers:{"IF-Match":e,"X-HTTP-Method":"DELETE"}})},t.prototype.getChanges=function(e){return this.clone(t,"getchanges").postCore({body:JSON.stringify({query:d.Util.extend({__metadata:{type:"SP.ChangeQuery"}},e)})})},t.prototype.getItemsByCAMLQuery=function(e){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];var o=this.clone(t,"getitems");return o.expand.apply(o,r).postCore({body:JSON.stringify({query:d.Util.extend({__metadata:{type:"SP.CamlQuery"}},e)})})},t.prototype.getListItemChangesSinceToken=function(e){return this.clone(t,"getlistitemchangessincetoken").postCore({body:JSON.stringify({query:d.Util.extend({__metadata:{type:"SP.ChangeLogItemQuery"}},e)})},{parse:function(e){return e.text()}})},t.prototype.recycle=function(){return this.clone(t,"recycle").postCore().then(function(e){return e.hasOwnProperty("Recycle")?e.Recycle:e})},t.prototype.renderListData=function(e){var r=this.clone(t,"renderlistdata(@viewXml)");return r.query.add("@viewXml","'"+e+"'"),r.postCore().then(function(e){return e.hasOwnProperty("RenderListData")?JSON.parse(e.RenderListData):JSON.parse(e)})},t.prototype.renderListDataAsStream=function(e,r){void 0===r&&(r=null);var n={overrideParameters:d.Util.extend({__metadata:{type:"SP.RenderListDataOverrideParameters"}},r),parameters:d.Util.extend({__metadata:{type:"SP.RenderListDataParameters"}},e)};return this.clone(t,"RenderListDataAsStream",!0).postCore({body:JSON.stringify(n)})},t.prototype.renderListFormData=function(e,r,n){return this.clone(t,"renderlistformdata(itemid="+e+", formid='"+r+"', mode='"+n+"')").postCore().then(function(e){return e=JSON.parse(e),e.hasOwnProperty("ListData")?e.ListData:e})},t.prototype.reserveListItemId=function(){return this.clone(t,"reservelistitemid").postCore().then(function(e){return e.hasOwnProperty("ReserveListItemId")?e.ReserveListItemId:e})},t.prototype.getListItemEntityTypeFullName=function(){return this.clone(t,null,!1).select("ListItemEntityTypeFullName").getAs().then(function(e){return e.ListItemEntityTypeFullName})},t}(p.SharePointQueryableSecurable);t.List=m},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=r(0),i=r(12),s=r(3),a=r(1),u=r(40),l=r(19),c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.getShareLink=function(e,r){void 0===r&&(r=null);var n=null!==r?r.toISOString():null;return this.clone(t,"shareLink").postAsCore({body:JSON.stringify({request:{createLink:!0,emailData:null,settings:{expiration:n,linkKind:e}}})})},t.prototype.shareWith=function(e,r,n,s,a){var u=this;void 0===n&&(n=!1),void 0===s&&(s=!1),Array.isArray(e)||(e=[e]);var c=JSON.stringify(e.map(function(e){return{Key:e}})),p=r===l.SharingRole.Edit?l.RoleType.Contributor:l.RoleType.Reader;return i.Web.fromUrl(this.toUrl()).roleDefinitions.select("Id").filter("RoleTypeKind eq "+p).get().then(function(e){if(!Array.isArray(e)||e.length<1)throw new Error("Could not locate a role defintion with RoleTypeKind "+p);var r={includeAnonymousLinkInEmail:n,peoplePickerInput:c,propagateAcl:s,roleValue:"role:"+e[0].Id,useSimplifiedRoles:!0};return void 0!==a&&(r=o.Util.extend(r,{emailBody:a.body,emailSubject:void 0!==a.subject?a.subject:"",sendEmail:!0})),u.clone(t,"shareObject").postAsCore({body:JSON.stringify(r)})})},t.prototype.shareObject=function(e,t){var r=this;return void 0===t&&(t=!1),t?this.sendShareObjectRequest(e):(e=o.Util.extend(e,{group:null,includeAnonymousLinkInEmail:!1,propagateAcl:!1,useSimplifiedRoles:!0},!0),this.getRoleValue(e.role,e.group).then(function(t){Array.isArray(e.loginNames)||(e.loginNames=[e.loginNames]);var n=JSON.stringify(e.loginNames.map(function(e){return{Key:e}})),i={peoplePickerInput:n,roleValue:t,url:e.url};return void 0!==e.emailData&&null!==e.emailData&&(i=o.Util.extend(i,{emailBody:e.emailData.body,emailSubject:void 0!==e.emailData.subject?e.emailData.subject:"Shared with you.",sendEmail:!0})),r.sendShareObjectRequest(i)}))},t.prototype.unshareObjectWeb=function(e){return this.clone(t,"unshareObject").postAsCore({body:JSON.stringify({url:e})})},t.prototype.checkPermissions=function(e){return this.clone(t,"checkPermissions").postAsCore({body:JSON.stringify({recipients:e})})},t.prototype.getSharingInformation=function(e){return void 0===e&&(e=null),this.clone(t,"getSharingInformation").postAsCore({body:JSON.stringify({request:e})})},t.prototype.getObjectSharingSettings=function(e){return void 0===e&&(e=!0),this.clone(t,"getObjectSharingSettings").postAsCore({body:JSON.stringify({useSimplifiedRoles:e})})},t.prototype.unshareObject=function(){return this.clone(t,"unshareObject").postAsCore()},t.prototype.deleteLinkByKind=function(e){return this.clone(t,"deleteLinkByKind").postCore({body:JSON.stringify({linkKind:e})})},t.prototype.unshareLink=function(e,r){return void 0===r&&(r="00000000-0000-0000-0000-000000000000"),this.clone(t,"unshareLink").postCore({body:JSON.stringify({linkKind:e,shareId:r})})},t.prototype.getRoleValue=function(e,t){if(void 0===t||null===t){var r=e===l.SharingRole.Edit?l.RoleType.Contributor:l.RoleType.Reader;return i.Web.fromUrl(this.toUrl()).roleDefinitions.select("Id").top(1).filter("RoleTypeKind eq "+r).getAs().then(function(e){if(e.length<1)throw new Error("Could not locate associated role definition for supplied role. Edit and View are supported");return"role: "+e[0].Id})}switch(t){case l.RoleType.Contributor:return i.Web.fromUrl(this.toUrl()).associatedMemberGroup.select("Id").getAs().then(function(e){return"group: "+e.Id});case l.RoleType.Reader:case l.RoleType.Guest:return i.Web.fromUrl(this.toUrl()).associatedVisitorGroup.select("Id").getAs().then(function(e){return"group: "+e.Id});default:throw new Error("Could not determine role value for supplied value. Contributor, Reader, and Guest are supported")}},t.prototype.getShareObjectWeb=function(e){return Promise.resolve(i.Web.fromUrl(e,"/_api/SP.Web.ShareObject"))},t.prototype.sendShareObjectRequest=function(e){return this.getShareObjectWeb(this.toUrl()).then(function(r){return r.expand("UsersWithAccessRequests","GroupsSharedWith").as(t).postCore({body:JSON.stringify(e)})})},t}(a.SharePointQueryable);t.SharePointQueryableShareable=c;var p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.shareWith=function(e,t,r){var n=this;void 0===t&&(t=l.SharingRole.View);var s=this.addBatchDependency();return i.Web.fromUrl(this.toUrl(),"/_api/web/url").get().then(function(i){return s(),n.shareObject(o.Util.combinePaths(i,"/_layouts/15/aclinv.aspx?forSharing=1&mbypass=1"),e,t,r)})},t.prototype.shareObject=function(e,t,r,n,o,i,s,a){return void 0===i&&(i=!1),void 0===s&&(s=!1),void 0===a&&(a=!0),this.clone(c,null).shareObject({emailData:n,group:o,includeAnonymousLinkInEmail:s,loginNames:t,propagateAcl:i,role:r,url:e,useSimplifiedRoles:a})},t.prototype.shareObjectRaw=function(e){return this.clone(c,null).shareObject(e,!0)},t.prototype.unshareObject=function(e){return this.clone(c,null).unshareObjectWeb(e)},t}(u.SharePointQueryableSecurable);t.SharePointQueryableShareableWeb=p;var d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.getShareLink=function(e,t){return void 0===e&&(e=l.SharingLinkKind.OrganizationView),void 0===t&&(t=null),this.clone(c,null).getShareLink(e,t)},t.prototype.shareWith=function(e,t,r,n){return void 0===t&&(t=l.SharingRole.View),void 0===r&&(r=!1),this.clone(c,null).shareWith(e,t,r,!1,n)},t.prototype.checkSharingPermissions=function(e){return this.clone(c,null).checkPermissions(e)},t.prototype.getSharingInformation=function(e){return void 0===e&&(e=null),this.clone(c,null).getSharingInformation(e)},t.prototype.getObjectSharingSettings=function(e){return void 0===e&&(e=!0),this.clone(c,null).getObjectSharingSettings(e)},t.prototype.unshare=function(){return this.clone(c,null).unshareObject()},t.prototype.deleteSharingLinkByKind=function(e){return this.clone(c,null).deleteLinkByKind(e)},t.prototype.unshareLink=function(e,t){return this.clone(c,null).unshareLink(e,t)},t}(u.SharePointQueryableSecurable);t.SharePointQueryableShareableItem=d;var f=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.getShareLink=function(e,t){void 0===e&&(e=l.SharingLinkKind.OrganizationView),void 0===t&&(t=null);var r=this.addBatchDependency();return this.getShareable().then(function(n){return r(),n.getShareLink(e,t)})},t.prototype.checkSharingPermissions=function(e){var t=this.addBatchDependency();return this.getShareable().then(function(r){return t(),r.checkPermissions(e)})},t.prototype.getSharingInformation=function(e){void 0===e&&(e=null);var t=this.addBatchDependency();return this.getShareable().then(function(r){return t(),r.getSharingInformation(e)})},t.prototype.getObjectSharingSettings=function(e){void 0===e&&(e=!0);var t=this.addBatchDependency();return this.getShareable().then(function(r){return t(),r.getObjectSharingSettings(e)})},t.prototype.unshare=function(){var e=this.addBatchDependency();return this.getShareable().then(function(t){return e(),t.unshareObject()})},t.prototype.deleteSharingLinkByKind=function(e){var t=this.addBatchDependency();return this.getShareable().then(function(r){return t(),r.deleteLinkByKind(e)})},t.prototype.unshareLink=function(e,t){var r=this.addBatchDependency();return this.getShareable().then(function(n){return r(),n.unshareLink(e,t)})},t.prototype.getShareable=function(){var e=this;return this.clone(h,"listItemAllFields",!1).select("odata.editlink").get().then(function(t){var r=new c(s.spGetEntityUrl(t));return e.hasBatch&&(r=r.inBatch(e.batch)),r})},t}(a.SharePointQueryableInstance);t.FileFolderShared=f;var h=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.shareWith=function(e,t,r,n){void 0===t&&(t=l.SharingRole.View),void 0===r&&(r=!1);var o=this.addBatchDependency();return this.getShareable().then(function(i){return o(),i.shareWith(e,t,r,!1,n)})},t}(f);t.SharePointQueryableShareableFile=h;var y=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.shareWith=function(e,t,r,n,o){void 0===t&&(t=l.SharingRole.View),void 0===r&&(r=!1),void 0===n&&(n=!1);var i=this.addBatchDependency();return this.getShareable().then(function(s){return i(),s.shareWith(e,t,r,n,o)})},t}(f);t.SharePointQueryableShareableFolder=y},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.Display=1]="Display",e[e.Edit=2]="Edit",e[e.New=3]="New"}(t.ControlMode||(t.ControlMode={}));!function(e){e[e.Invalid=0]="Invalid",e[e.Integer=1]="Integer",e[e.Text=2]="Text",e[e.Note=3]="Note",e[e.DateTime=4]="DateTime",e[e.Counter=5]="Counter",e[e.Choice=6]="Choice",e[e.Lookup=7]="Lookup",e[e.Boolean=8]="Boolean",e[e.Number=9]="Number",e[e.Currency=10]="Currency",e[e.URL=11]="URL",e[e.Computed=12]="Computed",e[e.Threading=13]="Threading",e[e.Guid=14]="Guid",e[e.MultiChoice=15]="MultiChoice",e[e.GridChoice=16]="GridChoice",e[e.Calculated=17]="Calculated",e[e.File=18]="File",e[e.Attachments=19]="Attachments",e[e.User=20]="User",e[e.Recurrence=21]="Recurrence",e[e.CrossProjectLink=22]="CrossProjectLink",e[e.ModStat=23]="ModStat",e[e.Error=24]="Error",e[e.ContentTypeId=25]="ContentTypeId",e[e.PageSeparator=26]="PageSeparator",e[e.ThreadIndex=27]="ThreadIndex",e[e.WorkflowStatus=28]="WorkflowStatus",e[e.AllDayEvent=29]="AllDayEvent",e[e.WorkflowEventType=30]="WorkflowEventType"}(t.FieldTypes||(t.FieldTypes={}));!function(e){e[e.DateOnly=0]="DateOnly",e[e.DateTime=1]="DateTime"}(t.DateTimeFieldFormatType||(t.DateTimeFieldFormatType={}));!function(e){e[e.DefaultValue=0]="DefaultValue",e[e.AddToDefaultContentType=1]="AddToDefaultContentType",e[e.AddToNoContentType=2]="AddToNoContentType",e[e.AddToAllContentTypes=4]="AddToAllContentTypes",e[e.AddFieldInternalNameHint=8]="AddFieldInternalNameHint",e[e.AddFieldToDefaultView=16]="AddFieldToDefaultView",e[e.AddFieldCheckDisplayName=32]="AddFieldCheckDisplayName"}(t.AddFieldOptions||(t.AddFieldOptions={}));!function(e){e[e.Gregorian=1]="Gregorian",e[e.Japan=3]="Japan",e[e.Taiwan=4]="Taiwan",e[e.Korea=5]="Korea",e[e.Hijri=6]="Hijri",e[e.Thai=7]="Thai",e[e.Hebrew=8]="Hebrew",e[e.GregorianMEFrench=9]="GregorianMEFrench",e[e.GregorianArabic=10]="GregorianArabic",e[e.GregorianXLITEnglish=11]="GregorianXLITEnglish",e[e.GregorianXLITFrench=12]="GregorianXLITFrench",e[e.KoreaJapanLunar=14]="KoreaJapanLunar",e[e.ChineseLunar=15]="ChineseLunar",e[e.SakaEra=16]="SakaEra",e[e.UmAlQura=23]="UmAlQura"}(t.CalendarType||(t.CalendarType={}));!function(e){e[e.Hyperlink=0]="Hyperlink",e[e.Image=1]="Image"}(t.UrlFieldFormatType||(t.UrlFieldFormatType={}));!function(e){e[e.Dropdown=0]="Dropdown",e[e.RadioButtons=1]="RadioButtons"}(t.ChoiceFieldFormatType||(t.ChoiceFieldFormatType={}));!function(e){e[e.EmptyMask=0]="EmptyMask",e[e.ViewListItems=1]="ViewListItems",e[e.AddListItems=2]="AddListItems",e[e.EditListItems=3]="EditListItems",e[e.DeleteListItems=4]="DeleteListItems",e[e.ApproveItems=5]="ApproveItems",e[e.OpenItems=6]="OpenItems",e[e.ViewVersions=7]="ViewVersions",e[e.DeleteVersions=8]="DeleteVersions",e[e.CancelCheckout=9]="CancelCheckout",e[e.ManagePersonalViews=10]="ManagePersonalViews",e[e.ManageLists=12]="ManageLists",e[e.ViewFormPages=13]="ViewFormPages",e[e.AnonymousSearchAccessList=14]="AnonymousSearchAccessList",e[e.Open=17]="Open",e[e.ViewPages=18]="ViewPages",e[e.AddAndCustomizePages=19]="AddAndCustomizePages",e[e.ApplyThemeAndBorder=20]="ApplyThemeAndBorder",e[e.ApplyStyleSheets=21]="ApplyStyleSheets",e[e.ViewUsageData=22]="ViewUsageData",e[e.CreateSSCSite=23]="CreateSSCSite",e[e.ManageSubwebs=24]="ManageSubwebs",e[e.CreateGroups=25]="CreateGroups",e[e.ManagePermissions=26]="ManagePermissions",e[e.BrowseDirectories=27]="BrowseDirectories",e[e.BrowseUserInfo=28]="BrowseUserInfo",e[e.AddDelPrivateWebParts=29]="AddDelPrivateWebParts",e[e.UpdatePersonalWebParts=30]="UpdatePersonalWebParts",e[e.ManageWeb=31]="ManageWeb",e[e.AnonymousSearchAccessWebLists=32]="AnonymousSearchAccessWebLists",e[e.UseClientIntegration=37]="UseClientIntegration",e[e.UseRemoteAPIs=38]="UseRemoteAPIs",e[e.ManageAlerts=39]="ManageAlerts",e[e.CreateAlerts=40]="CreateAlerts",e[e.EditMyUserInfo=41]="EditMyUserInfo",e[e.EnumeratePermissions=63]="EnumeratePermissions",e[e.FullMask=65]="FullMask"}(t.PermissionKind||(t.PermissionKind={}));!function(e){e[e.None=0]="None",e[e.Guest=1]="Guest",e[e.Reader=2]="Reader",e[e.Contributor=3]="Contributor",e[e.WebDesigner=4]="WebDesigner",e[e.Administrator=5]="Administrator"}(t.RoleType||(t.RoleType={}));!function(e){e[e.Invalid=-1]="Invalid",e[e.DefaultView=0]="DefaultView",e[e.NormalView=1]="NormalView",e[e.DialogView=2]="DialogView",e[e.View=3]="View",e[e.DisplayForm=4]="DisplayForm",e[e.DisplayFormDialog=5]="DisplayFormDialog",e[e.EditForm=6]="EditForm",e[e.EditFormDialog=7]="EditFormDialog",e[e.NewForm=8]="NewForm",e[e.NewFormDialog=9]="NewFormDialog",e[e.SolutionForm=10]="SolutionForm",e[e.PAGE_MAXITEMS=11]="PAGE_MAXITEMS"}(t.PageType||(t.PageType={}));!function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Direct=1]="Direct",e[e.OrganizationView=2]="OrganizationView",e[e.OrganizationEdit=3]="OrganizationEdit",e[e.AnonymousView=4]="AnonymousView",e[e.AnonymousEdit=5]="AnonymousEdit",e[e.Flexible=6]="Flexible"}(t.SharingLinkKind||(t.SharingLinkKind={}));!function(e){e[e.None=0]="None",e[e.View=1]="View",e[e.Edit=2]="Edit",e[e.Owner=3]="Owner"}(t.SharingRole||(t.SharingRole={}));!function(e){e[e.CompletedSuccessfully=0]="CompletedSuccessfully",e[e.AccessRequestsQueued=1]="AccessRequestsQueued",e[e.NoResolvedUsers=-1]="NoResolvedUsers",e[e.AccessDenied=-2]="AccessDenied",e[e.CrossSiteRequestNotSupported=-3]="CrossSiteRequestNotSupported",e[e.UnknowError=-4]="UnknowError",e[e.EmailBodyTooLong=-5]="EmailBodyTooLong",e[e.ListUniqueScopesExceeded=-6]="ListUniqueScopesExceeded",e[e.CapabilityDisabled=-7]="CapabilityDisabled",e[e.ObjectNotSupported=-8]="ObjectNotSupported",e[e.NestedGroupsNotSupported=-9]="NestedGroupsNotSupported"}(t.SharingOperationStatusCode||(t.SharingOperationStatusCode={}));!function(e){e[e.Unknown=0]="Unknown",e[e.File=1]="File",e[e.Folder=2]="Folder",e[e.Item=3]="Item",e[e.List=4]="List",e[e.Web=5]="Web",e[e.Max=6]="Max"}(t.SPSharedObjectType||(t.SPSharedObjectType={}));!function(e){e[e.None=0]="None",e[e.AllowList=1]="AllowList",e[e.BlockList=2]="BlockList"}(t.SharingDomainRestrictionMode||(t.SharingDomainRestrictionMode={}));!function(e){e[e.None=0]="None",e[e.ContextInfo=1]="ContextInfo",e[e.ListData=2]="ListData",e[e.ListSchema=4]="ListSchema",e[e.MenuView=8]="MenuView",e[e.ListContentType=16]="ListContentType",e[e.FileSystemItemId=32]="FileSystemItemId",e[e.ClientFormSchema=64]="ClientFormSchema",e[e.QuickLaunch=128]="QuickLaunch",e[e.Spotlight=256]="Spotlight",e[e.Visualization=512]="Visualization",e[e.ViewMetadata=1024]="ViewMetadata",e[e.DisableAutoHyperlink=2048]="DisableAutoHyperlink",e[e.EnableMediaTAUrls=4096]="EnableMediaTAUrls",e[e.ParentInfo=8192]="ParentInfo",e[e.PageContextInfo=16384]="PageContextInfo",e[e.ClientSideComponentManifest=32768]="ClientSideComponentManifest"}(t.RenderListDataOptions||(t.RenderListDataOptions={}));!function(e){e[e.PeopleAndGroups=1]="PeopleAndGroups",e[e.PeopleOnly=0]="PeopleOnly"}(t.FieldUserSelectionMode||(t.FieldUserSelectionMode={}))},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=r(1),i=r(18),s=r(9),a=r(0),u=r(3),l=r(13),c=function(e){function t(t,r){return void 0===r&&(r="folders"),e.call(this,t,r)||this}return n(t,e),t.prototype.getByName=function(e){var t=new p(this);return t.concat("('"+e+"')"),t},t.prototype.add=function(e){var r=this;return this.clone(t,"add('"+e+"')").postCore().then(function(t){return{data:t,folder:r.getByName(e)}})},t}(o.SharePointQueryableCollection);t.Folders=c;var p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),Object.defineProperty(t.prototype,"contentTypeOrder",{get:function(){return new o.SharePointQueryableCollection(this,"contentTypeOrder")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"files",{get:function(){return new s.Files(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"folders",{get:function(){return new c(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"listItemAllFields",{get:function(){return new o.SharePointQueryableCollection(this,"listItemAllFields")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"parentFolder",{get:function(){return new t(this,"parentFolder")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"properties",{get:function(){return new o.SharePointQueryableInstance(this,"properties")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"serverRelativeUrl",{get:function(){return new o.SharePointQueryable(this,"serverRelativeUrl")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"uniqueContentTypeOrder",{get:function(){return new o.SharePointQueryableCollection(this,"uniqueContentTypeOrder")},enumerable:!0,configurable:!0}),t.prototype.update=function(e){var t=this,r=JSON.stringify(a.Util.extend({__metadata:{type:"SP.Folder"}},e));return this.postCore({body:r,headers:{"X-HTTP-Method":"MERGE"}}).then(function(e){return{data:e,folder:t}})},t.prototype.delete=function(e){return void 0===e&&(e="*"),this.clone(t,null).postCore({headers:{"IF-Match":e,"X-HTTP-Method":"DELETE"}})},t.prototype.recycle=function(){return this.clone(t,"recycle").postCore()},t.prototype.getItem=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=this.listItemAllFields;return r.select.apply(r,e).get().then(function(e){return a.Util.extend(new l.Item(u.spGetEntityUrl(e)),e)})},t}(i.SharePointQueryableShareableFolder);t.Folder=p},function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(o,i){function s(e){try{u(n.next(e))}catch(e){i(e)}}function a(e){try{u(n.throw(e))}catch(e){i(e)}}function u(e){e.done?o(e.value):new r(function(t){t(e.value)}).then(s,a)}u((n=n.apply(e,t||[])).next())})},o=this&&this.__generator||function(e,t){function r(e){return function(t){return n([e,t])}}function n(r){if(o)throw new TypeError("Generator is already executing.");for(;u;)try{if(o=1,i&&(s=i[2&r[0]?"return":r[0]?"throw":"next"])&&!(s=s.call(i,r[1])).done)return s;switch(i=0,s&&(r=[0,s.value]),r[0]){case 0:case 1:s=r;break;case 4:return u.label++,{value:r[1],done:!1};case 5:u.label++,i=r[1],r=[0];continue;case 7:r=u.ops.pop(),u.trys.pop();continue;default:if(s=u.trys,!(s=s.length>0&&s[s.length-1])&&(6===r[0]||2===r[0])){u=0;continue}if(3===r[0]&&(!s||r[1]>s[0]&&r[1]<s[3])){u.label=r[1];break}if(6===r[0]&&u.label<s[1]){u.label=s[1],s=r;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(r);break}s[2]&&u.ops.pop(),u.trys.pop();continue}r=t.call(e,u)}catch(e){r=[6,e],i=0}finally{o=s=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}var o,i,s,a,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return a={next:r(0),throw:r(1),return:r(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a};Object.defineProperty(t,"__esModule",{value:!0});var i=r(55),s=r(14),a=r(7),u=function(){function e(e,t,r){this.logSource="SPFXHelper",this.spHttpClient=e,this.webURL=t,this.logSource=r}return Object.defineProperty(e.prototype,"WebUrl",{get:function(){return this.webURL},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"LogSource",{get:function(){return this.logSource},enumerable:!0,configurable:!0}),e.prototype.spQueryGET=function(e){return n(this,void 0,void 0,function(){var t,r,n,s,u;return o(this,function(o){switch(o.label){case 0:return o.trys.push([0,3,4,5]),n={headers:{Accept:"application/json","odata-version":""}},[4,this.spHttpClient.get(e,i.SPHttpClient.configurations.v1,n)];case 1:return s=o.sent(),[4,s.json()];case 2:return r=o.sent(),s.ok?t={error:void 0,ok:!0,result:r}:(t={error:new Error(""+r["odata.error"].message.value),ok:!1,result:void 0},a.Log.error(this.logSource,new Error("Error occured in SPHelperBase.spQueryGET")),a.Log.error(this.LogSource,t.error)),[3,5];case 3:return u=o.sent(),a.Log.error(this.logSource,new Error("Error occured in SPHelperBase.spQueryGET")),a.Log.error(this.logSource,new Error("Query: "+e)),a.Log.error(this.logSource,u),t={error:u,ok:!1,result:void 0},[3,5];case 4:return[2,Promise.resolve(t)];case 5:return[2]}})})},e.prototype.spQueryPOST=function(e){return n(this,void 0,void 0,function(){var t,r,n;return o(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,3,4]),r={headers:{"odata-version":"3.0"}},s.SPCore.isEmptyString(e.body)||(r.body=e.body),[4,this.executePOSTRequest(e.url,r)];case 1:return t=o.sent(),[3,4];case 2:return n=o.sent(),a.Log.error(this.LogSource,new Error("Error occured in SPBase.spQueryPOST")),a.Log.error(this.LogSource,n),t={ok:!1,error:n,result:void 0},[3,4];case 3:return[2,t];case 4:return[2]}})})},e.prototype.spQueryMERGE=function(e){return n(this,void 0,void 0,function(){var t,r,n;return o(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,3,4]),r={},r=s.SPCore.isEmptyString(e.body)?{headers:{"odata-version":"3.0"}}:{headers:{Accept:"application/json;odata=nometadata","Content-type":"application/json;odata=verbose","odata-version":"","IF-MATCH":"*","X-HTTP-Method":"MERGE"},body:e.body},[4,this.executePOSTRequest(e.url,r)];case 1:return t=o.sent(),[3,4];case 2:return n=o.sent(),a.Log.error(this.LogSource,new Error("Error occured in SPBase.spQueryMERGE")),a.Log.error(this.LogSource,n),t={ok:!1,error:n,result:void 0},[3,4];case 3:return[2,t];case 4:return[2]}})})},e.prototype.spQueryPATCH=function(e){return n(this,void 0,void 0,function(){var t,r,n;return o(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,3,4]),r={},r=s.SPCore.isEmptyString(e.body)?{headers:{"odata-version":"3.0"}}:{headers:{Accept:"application/json;odata=nometadata","Content-type":"application/json;odata=verbose","odata-version":"","IF-MATCH":"*","X-HTTP-Method":"PATCH"},body:e.body},[4,this.executePOSTRequest(e.url,r)];case 1:return t=o.sent(),[3,4];case 2:return n=o.sent(),a.Log.error(this.LogSource,new Error("Error occured in SPBase.spQueryPATCH")),a.Log.error(this.LogSource,n),t={ok:!1,error:n,result:void 0},[3,4];case 3:return[2,t];case 4:return[2]}})})},e.prototype.executePOSTRequest=function(e,t){return n(this,void 0,void 0,function(){var r,n,s,u;return o(this,function(o){switch(o.label){case 0:return o.trys.push([0,3,4,5]),[4,this.spHttpClient.post(e,i.SPHttpClient.configurations.v1,t)];case 1:return n=o.sent(),[4,n.json()];case 2:return s=o.sent(),n.ok?r={ok:!0,result:s,error:void 0}:(r={ok:!1,error:new Error(""+s["odata.error"].message.value),result:void 0},a.Log.error(this.LogSource,new Error("Error occured in SPBase.executePOSTRequest")),a.Log.error(this.LogSource,r.error)),[3,5];case 3:return u=o.sent(),a.Log.error(this.LogSource,new Error("Error occured in SPBase.executePOSTRequest")),a.Log.error(this.LogSource,u),r={ok:!1,error:u,result:void 0},[3,5];case 4:return[2,r];case 5:return[2]}})})},e}();t.SPBase=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(11),i=r(8),s=r(4),a=r(23),u=function(){function e(){}return e.prototype.concat=function(e){return this._url+=e,this},e.prototype.append=function(e){this._url=n.Util.combinePaths(this._url,e)},Object.defineProperty(e.prototype,"parentUrl",{get:function(){return this._parentUrl},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"query",{get:function(){return this._query},enumerable:!0,configurable:!0}),e.prototype.configure=function(e){return o.mergeOptions(this._options,e),this},e.prototype.usingCaching=function(e){return s.RuntimeConfig.globalCacheDisable||(this._useCaching=!0,this._cachingOptions=e),this},e.prototype.toUrl=function(){return this._url},e.prototype.get=function(e,t){return void 0===e&&(e=new i.ODataDefaultParser),void 0===t&&(t={}),this.toRequestContext("GET",t,e,a.PipelineMethods.default).then(function(e){return a.pipe(e)})},e.prototype.getAs=function(e,t){return void 0===e&&(e=new i.ODataDefaultParser),void 0===t&&(t={}),this.toRequestContext("GET",t,e,a.PipelineMethods.default).then(function(e){return a.pipe(e)})},e.prototype.postCore=function(e,t){return void 0===e&&(e={}),void 0===t&&(t=new i.ODataDefaultParser),this.toRequestContext("POST",e,t,a.PipelineMethods.default).then(function(e){return a.pipe(e)})},e.prototype.postAsCore=function(e,t){return void 0===e&&(e={}),void 0===t&&(t=new i.ODataDefaultParser),this.toRequestContext("POST",e,t,a.PipelineMethods.default).then(function(e){return a.pipe(e)})},e.prototype.patchCore=function(e,t){return void 0===e&&(e={}),void 0===t&&(t=new i.ODataDefaultParser),this.toRequestContext("PATCH",e,t,a.PipelineMethods.default).then(function(e){return a.pipe(e)})},e.prototype.deleteCore=function(e,t){return void 0===e&&(e={}),void 0===t&&(t=new i.ODataDefaultParser),this.toRequestContext("DELETE",e,t,a.PipelineMethods.default).then(function(e){return a.pipe(e)})},e}();t.ODataQueryable=u},function(e,t,r){"use strict";function n(e){return c.Logger.log({data:e.result,level:c.LogLevel.Verbose,message:"["+e.requestId+"] ("+(new Date).getTime()+") Returning result, see data property for value."}),Promise.resolve(e.result)}function o(e,t){return new Promise(function(r){e.result=t,e.hasResult=!0,r(e)})}function i(e){return e.pipeline.length<1?Promise.resolve(e):e.pipeline.shift()(e)}function s(e){return i(e).then(function(e){return n(e)}).catch(function(e){throw c.Logger.log({data:e,level:c.LogLevel.Error,message:"Error in request pipeline: "+e.message}),e})}function a(e){return void 0===e&&(e=!1),function(t,r,n){var o=n.value;n.value=function(){for(var n=[],s=0;s<arguments.length;s++)n[s]=arguments[s];return!e&&n.length>0&&n[0].hasOwnProperty("hasResult")&&n[0].hasResult?(c.Logger.write("["+n[0].requestId+"] ("+(new Date).getTime()+") Skipping request pipeline method "+r+", existing result in pipeline.",c.LogLevel.Verbose),Promise.resolve(n[0])):(c.Logger.write("["+n[0].requestId+"] ("+(new Date).getTime()+") Calling request pipeline method "+r+".",c.LogLevel.Verbose),o.apply(t,n).then(function(e){return i(e)}))}}}var u=this&&this.__decorate||function(e,t,r,n){var o,i=arguments.length,s=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,r,s):o(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s};Object.defineProperty(t,"__esModule",{value:!0});var l=r(37),c=r(5),p=r(0);t.setResult=o,t.pipe=s,t.requestPipelineMethod=a;var d=function(){function e(){}return e.logStart=function(e){return new Promise(function(t){c.Logger.log({data:c.Logger.activeLogLevel===c.LogLevel.Info?{}:e,level:c.LogLevel.Info,message:"["+e.requestId+"] ("+(new Date).getTime()+") Beginning "+e.verb+" request ("+e.requestAbsoluteUrl+")"}),t(e)})},e.caching=function(e){return new Promise(function(t){if("GET"===e.verb&&e.isCached){c.Logger.write("["+e.requestId+"] ("+(new Date).getTime()+") Caching is enabled for request, checking cache...",c.LogLevel.Info);var r=new l.CachingOptions(e.requestAbsoluteUrl.toLowerCase());if(void 0!==e.cachingOptions&&(r=p.Util.extend(r,e.cachingOptions)),null!==r.store){var n=r.store.get(r.key);if(null!==n)return c.Logger.log({data:c.Logger.activeLogLevel===c.LogLevel.Info?{}:n,level:c.LogLevel.Info,message:"["+e.requestId+"] ("+(new Date).getTime()+") Value returned from cache."}),e.batchDependency(),e.parser.hasOwnProperty("hydrate")&&(n=e.parser.hydrate(n)),o(e,n).then(function(e){return t(e)})}c.Logger.write("["+e.requestId+"] ("+(new Date).getTime()+") Value not found in cache.",c.LogLevel.Info),e.parser=new l.CachingParserWrapper(e.parser,r)}return t(e)})},e.send=function(e){return new Promise(function(t,r){if(e.isBatched){var n=e.batch.add(e.requestAbsoluteUrl,e.verb,e.options,e.parser);e.batchDependency(),c.Logger.write("["+e.requestId+"] ("+(new Date).getTime()+") Batching request in batch "+e.batch.batchId+".",c.LogLevel.Info),t(o(e,n))}else{c.Logger.write("["+e.requestId+"] ("+(new Date).getTime()+") Sending request.",c.LogLevel.Info);var i=e.clientFactory(),s=p.Util.extend(e.options||{},{method:e.verb});i.fetch(e.requestAbsoluteUrl,s).then(function(t){return e.parser.parse(t)}).then(function(t){return o(e,t)}).then(function(e){return t(e)}).catch(function(e){return r(e)})}})},e.logEnd=function(e){return new Promise(function(t){e.isBatched?c.Logger.log({data:c.Logger.activeLogLevel===c.LogLevel.Info?{}:e,level:c.LogLevel.Info,message:"["+e.requestId+"] ("+(new Date).getTime()+") "+e.verb+" request will complete in batch "+e.batch.batchId+"."}):c.Logger.log({data:c.Logger.activeLogLevel===c.LogLevel.Info?{}:e,level:c.LogLevel.Info,message:"["+e.requestId+"] ("+(new Date).getTime()+") Completing "+e.verb+" request."}),t(e)})},Object.defineProperty(e,"default",{get:function(){return[e.logStart,e.caching,e.send,e.logEnd]},enumerable:!0,configurable:!0}),u([a(!0)],e,"logStart",null),u([a()],e,"caching",null),u([a()],e,"send",null),u([a(!0)],e,"logEnd",null),e}();t.PipelineMethods=d},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(61),o=r(0),i=r(4),s=r(2),a=r(11),u=function(){function e(){this._impl=i.RuntimeConfig.spFetchClientFactory(),this._digestCache=new n.DigestCache(this)}return e.prototype.fetch=function(e,t){var r=this;void 0===t&&(t={});var n=o.Util.extend(t,{cache:"no-cache",credentials:"same-origin"},!0),u=new Headers;if(a.mergeHeaders(u,i.RuntimeConfig.spHeaders),a.mergeHeaders(u,t.headers),u.has("Accept")||u.append("Accept","application/json"),u.has("Content-Type")||u.append("Content-Type","application/json;odata=verbose;charset=utf-8"),u.has("X-ClientService-ClientTag")||u.append("X-ClientService-ClientTag","PnPCoreJS:3.0.10"),u.has("User-Agent")||u.append("User-Agent","NONISV|SharePointPnP|PnPCoreJS/3.0.10"),n=o.Util.extend(n,{headers:u}),n.method&&"GET"!==n.method.toUpperCase()&&!u.has("X-RequestDigest")&&!u.has("Authorization")){var l=e.indexOf("_api/");if(l<0)throw new s.APIUrlException;var c=e.substr(0,l);return this._digestCache.getDigest(c).then(function(t){return u.append("X-RequestDigest",t),r.fetchRaw(e,n)})}return this.fetchRaw(e,n)},e.prototype.fetchRaw=function(e,t){var r=this;void 0===t&&(t={});var n=new Headers;a.mergeHeaders(n,t.headers),t=o.Util.extend(t,{headers:n});var i=function(n){r._impl.fetch(e,t).then(function(e){return n.resolve(e)}).catch(function(e){429!==e.status&&503!==e.status&&n.reject(e);var t=n.delay;n.delay*=2,n.attempts++,n.retryCount<=n.attempts&&n.reject(e),setTimeout(o.Util.getCtxCallback(r,i,n),t)})};return new Promise(function(e,t){var n={attempts:0,delay:100,reject:t,resolve:e,retryCount:7};i.call(r,n)})},e.prototype.get=function(e,t){void 0===t&&(t={});var r=o.Util.extend(t,{method:"GET"});return this.fetch(e,r)},e.prototype.post=function(e,t){void 0===t&&(t={});var r=o.Util.extend(t,{method:"POST"});return this.fetch(e,r)},e.prototype.patch=function(e,t){void 0===t&&(t={});var r=o.Util.extend(t,{method:"PATCH"});return this.fetch(e,r)},e.prototype.delete=function(e,t){void 0===t&&(t={});var r=o.Util.extend(t,{method:"DELETE"});return this.fetch(e,r)},e}();t.HttpClient=u},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=r(1),i=r(26),s=r(0),a=function(e){function t(t,r){return void 0===r&&(r="roleassignments"),e.call(this,t,r)||this}return n(t,e),t.prototype.add=function(e,r){return this.clone(t,"addroleassignment(principalid="+e+", roledefid="+r+")").postCore()},t.prototype.remove=function(e,r){return this.clone(t,"removeroleassignment(principalid="+e+", roledefid="+r+")").postCore()},t.prototype.getById=function(e){var t=new u(this);return t.concat("("+e+")"),t},t}(o.SharePointQueryableCollection);t.RoleAssignments=a;var u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),Object.defineProperty(t.prototype,"groups",{get:function(){return new i.SiteGroups(this,"groups")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bindings",{get:function(){return new p(this)},enumerable:!0,configurable:!0}),t.prototype.delete=function(){return this.postCore({headers:{"X-HTTP-Method":"DELETE"}})},t}(o.SharePointQueryableInstance);t.RoleAssignment=u;var l=function(e){function t(t,r){return void 0===r&&(r="roledefinitions"),e.call(this,t,r)||this}return n(t,e),t.prototype.getById=function(e){return new c(this,"getById("+e+")")},t.prototype.getByName=function(e){return new c(this,"getbyname('"+e+"')")},t.prototype.getByType=function(e){return new c(this,"getbytype("+e+")")},t.prototype.add=function(e,t,r,n){var o=this,i=JSON.stringify({BasePermissions:s.Util.extend({__metadata:{type:"SP.BasePermissions"}},n),Description:t,Name:e,Order:r,__metadata:{type:"SP.RoleDefinition"}});return this.postCore({body:i}).then(function(e){return{data:e,definition:o.getById(e.Id)}})},t}(o.SharePointQueryableCollection);t.RoleDefinitions=l;var c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.update=function(e){var t=this;void 0!==e.hasOwnProperty("BasePermissions")&&(e.BasePermissions=s.Util.extend({__metadata:{type:"SP.BasePermissions"}},e.BasePermissions));var r=JSON.stringify(s.Util.extend({__metadata:{type:"SP.RoleDefinition"}},e));return this.postCore({body:r,headers:{"X-HTTP-Method":"MERGE"}}).then(function(r){var n=t;if(e.hasOwnProperty("Name")){n=t.getParent(l,t.parentUrl,"").getByName(e.Name)}return{data:r,definition:n}})},t.prototype.delete=function(){return this.postCore({headers:{"X-HTTP-Method":"DELETE"}})},t}(o.SharePointQueryableInstance);t.RoleDefinition=c;var p=function(e){function t(t,r){return void 0===r&&(r="roledefinitionbindings"),e.call(this,t,r)||this}return n(t,e),t}(o.SharePointQueryableCollection);t.RoleDefinitionBindings=p},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=r(1),i=r(41),s=r(0);!function(e){e[e.None=0]="None",e[e.User=1]="User",e[e.DistributionList=2]="DistributionList",e[e.SecurityGroup=4]="SecurityGroup",e[e.SharePointGroup=8]="SharePointGroup",e[e.All=15]="All"}(t.PrincipalType||(t.PrincipalType={}));var a=function(e){function t(t,r){return void 0===r&&(r="sitegroups"),e.call(this,t,r)||this}return n(t,e),t.prototype.add=function(e){var t=this,r=JSON.stringify(s.Util.extend({__metadata:{type:"SP.Group"}},e));return this.postCore({body:r}).then(function(e){return{data:e,group:t.getById(e.Id)}})},t.prototype.getByName=function(e){return new u(this,"getByName('"+e+"')")},t.prototype.getById=function(e){var t=new u(this);return t.concat("("+e+")"),t},t.prototype.removeById=function(e){return this.clone(t,"removeById('"+e+"')").postCore()},t.prototype.removeByLoginName=function(e){return this.clone(t,"removeByLoginName('"+e+"')").postCore()},t}(o.SharePointQueryableCollection);t.SiteGroups=a;var u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),Object.defineProperty(t.prototype,"users",{get:function(){return new i.SiteUsers(this,"users")},enumerable:!0,configurable:!0}),t.prototype.update=function(e){var r=this,n=s.Util.extend({__metadata:{type:"SP.Group"}},e);return this.postCore({body:JSON.stringify(n),headers:{"X-HTTP-Method":"MERGE"}}).then(function(n){var o=r;return e.hasOwnProperty("Title")&&(o=r.getParent(t,r.parentUrl,"getByName('"+e.Title+"')")),{data:n,group:o}})},t}(o.SharePointQueryableInstance);t.SiteGroup=u},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=r(0),i=r(1),s=function(e){function t(t,r){return void 0===r&&(r="contenttypes"),e.call(this,t,r)||this}return n(t,e),t.prototype.getById=function(e){var t=new a(this);return t.concat("('"+e+"')"),t},t.prototype.addAvailableContentType=function(e){var r=this,n=JSON.stringify({contentTypeId:e});return this.clone(t,"addAvailableContentType").postAsCore({body:n}).then(function(e){return{contentType:r.getById(e.id),data:e}})},t.prototype.add=function(e,t,r,n,i){var s=this;void 0===r&&(r=""),void 0===n&&(n="Custom Content Types"),void 0===i&&(i={});var a=JSON.stringify(o.Util.extend({Description:r,Group:n,Id:{StringValue:e},Name:t,__metadata:{type:"SP.ContentType"}},i));return this.postCore({body:a}).then(function(e){return{contentType:s.getById(e.id),data:e}})},t}(i.SharePointQueryableCollection);t.ContentTypes=s;var a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),Object.defineProperty(t.prototype,"fieldLinks",{get:function(){return new u(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fields",{get:function(){return new i.SharePointQueryableCollection(this,"fields")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return new t(this,"parent")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"workflowAssociations",{get:function(){return new i.SharePointQueryableCollection(this,"workflowAssociations")},enumerable:!0,configurable:!0}),t.prototype.delete=function(){return this.postCore({headers:{"X-HTTP-Method":"DELETE"}})},t}(i.SharePointQueryableInstance);t.ContentType=a;var u=function(e){function t(t,r){return void 0===r&&(r="fieldlinks"),e.call(this,t,r)||this}return n(t,e),t.prototype.getById=function(e){var t=new l(this);return t.concat("(guid'"+e+"')"),t},t}(i.SharePointQueryableCollection);t.FieldLinks=u;var l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t}(i.SharePointQueryableInstance);t.FieldLink=l},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=r(1),i=r(0),s=r(19),a=function(e){function t(t,r){return void 0===r&&(r="fields"),e.call(this,t,r)||this}return n(t,e),t.prototype.getByTitle=function(e){return new u(this,"getByTitle('"+e+"')")},t.prototype.getByInternalNameOrTitle=function(e){return new u(this,"getByInternalNameOrTitle('"+e+"')")},t.prototype.getById=function(e){var t=new u(this);return t.concat("('"+e+"')"),t},t.prototype.createFieldAsXml=function(e){var r,n=this;r="string"==typeof e?{SchemaXml:e}:e;var o=JSON.stringify({parameters:i.Util.extend({__metadata:{type:"SP.XmlSchemaFieldCreationInformation"}},r)});return this.clone(t,"createfieldasxml").postAsCore({body:o}).then(function(e){return{data:e,field:n.getById(e.Id)}})},t.prototype.add=function(e,r,n){var o=this,s=JSON.stringify(i.Util.extend({Title:e,__metadata:{type:r}},n));return this.clone(t,null).postAsCore({body:s}).then(function(e){return{data:e,field:o.getById(e.Id)}})},t.prototype.addText=function(e,t,r){void 0===t&&(t=255);var n={FieldTypeKind:2,MaxLength:t};return this.add(e,"SP.FieldText",i.Util.extend(n,r))},t.prototype.addCalculated=function(e,t,r,n,o){void 0===n&&(n=s.FieldTypes.Text);var a={DateFormat:r,FieldTypeKind:17,Formula:t,OutputType:n};return this.add(e,"SP.FieldCalculated",i.Util.extend(a,o))},t.prototype.addDateTime=function(e,t,r,n,o){void 0===t&&(t=s.DateTimeFieldFormatType.DateOnly),void 0===r&&(r=s.CalendarType.Gregorian),void 0===n&&(n=0);var a={DateTimeCalendarType:r,DisplayFormat:t,FieldTypeKind:4,FriendlyDisplayFormat:n};return this.add(e,"SP.FieldDateTime",i.Util.extend(a,o))},t.prototype.addNumber=function(e,t,r,n){var o={FieldTypeKind:9};return void 0!==t&&(o=i.Util.extend({MinimumValue:t},o)),void 0!==r&&(o=i.Util.extend({MaximumValue:r},o)),this.add(e,"SP.FieldNumber",i.Util.extend(o,n))},t.prototype.addCurrency=function(e,t,r,n,o){void 0===n&&(n=1033);var s={CurrencyLocaleId:n,FieldTypeKind:10};return void 0!==t&&(s=i.Util.extend({MinimumValue:t},s)),void 0!==r&&(s=i.Util.extend({MaximumValue:r},s)),this.add(e,"SP.FieldCurrency",i.Util.extend(s,o))},t.prototype.addMultilineText=function(e,t,r,n,o,s,a){void 0===t&&(t=6),void 0===r&&(r=!0),void 0===n&&(n=!1),void 0===o&&(o=!1),void 0===s&&(s=!0);var u={AllowHyperlink:s,AppendOnly:o,FieldTypeKind:3,NumberOfLines:t,RestrictedMode:n,RichText:r};return this.add(e,"SP.FieldMultiLineText",i.Util.extend(u,a))},t.prototype.addUrl=function(e,t,r){void 0===t&&(t=s.UrlFieldFormatType.Hyperlink);var n={DisplayFormat:t,FieldTypeKind:11};return this.add(e,"SP.FieldUrl",i.Util.extend(n,r))},t.prototype.addUser=function(e,t,r){var n={FieldTypeKind:20,SelectionMode:t};return this.add(e,"SP.FieldUser",i.Util.extend(n,r))},t.prototype.addLookup=function(e,r,n,o){var s=this,a=JSON.stringify({parameters:i.Util.extend({FieldTypeKind:7,LookupFieldName:n,LookupListId:r,Title:e,__metadata:{type:"SP.FieldCreationInformation"}},o)});return this.clone(t,"addfield").postAsCore({body:a}).then(function(e){return{data:e,field:s.getById(e.Id)}})},t.prototype.addChoice=function(e,t,r,n,o){void 0===r&&(r=s.ChoiceFieldFormatType.Dropdown);var a={Choices:{results:t},EditFormat:r,FieldTypeKind:6,FillInChoice:n};return this.add(e,"SP.FieldChoice",i.Util.extend(a,o))},t.prototype.addMultiChoice=function(e,t,r,n){var o={Choices:{results:t},FieldTypeKind:15,FillInChoice:r};return this.add(e,"SP.FieldMultiChoice",i.Util.extend(o,n))},t.prototype.addBoolean=function(e,t){var r={FieldTypeKind:8};return this.add(e,"SP.Field",i.Util.extend(r,t))},t}(o.SharePointQueryableCollection);t.Fields=a;var u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.update=function(e,t){var r=this;void 0===t&&(t="SP.Field");var n=JSON.stringify(i.Util.extend({__metadata:{type:t}},e));return this.postCore({body:n,headers:{"X-HTTP-Method":"MERGE"}}).then(function(e){return{data:e,field:r}})},t.prototype.delete=function(){return this.postCore({headers:{"X-HTTP-Method":"DELETE"}})},t.prototype.setShowInDisplayForm=function(e){return this.clone(t,"setshowindisplayform("+e+")").postCore()},t.prototype.setShowInEditForm=function(e){return this.clone(t,"setshowineditform("+e+")").postCore()},t.prototype.setShowInNewForm=function(e){return this.clone(t,"setshowinnewform("+e+")").postCore()},t}(o.SharePointQueryableInstance);t.Field=u},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=r(1),i=r(0),s=function(e){function t(t,r){return void 0===r&&(r="usercustomactions"),e.call(this,t,r)||this}return n(t,e),t.prototype.getById=function(e){var t=new a(this);return t.concat("('"+e+"')"),t},t.prototype.add=function(e){var t=this,r=JSON.stringify(i.Util.extend({__metadata:{type:"SP.UserCustomAction"}},e));return this.postCore({body:r}).then(function(e){return{action:t.getById(e.Id),data:e}})},t.prototype.clear=function(){return this.clone(t,"clear").postCore()},t}(o.SharePointQueryableCollection);t.UserCustomActions=s;var a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.update=function(e){var t=this,r=JSON.stringify(i.Util.extend({__metadata:{type:"SP.UserCustomAction"}},e));return this.postCore({body:r,headers:{"X-HTTP-Method":"MERGE"}}).then(function(e){return{action:t,data:e}})},t.prototype.delete=function(){return e.prototype.deleteCore.call(this)},t}(o.SharePointQueryableInstance);t.UserCustomAction=a},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=r(1),i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.getById=function(e){var t=new s(this);return t.concat("("+e+")"),t},t.prototype.add=function(e,r,n){var o=this;void 0===n&&(n=!0);var i=JSON.stringify({IsVisible:n,Title:e,Url:r,__metadata:{type:"SP.NavigationNode"}});return this.clone(t,null).postCore({body:i}).then(function(e){return{data:e,node:o.getById(e.Id)}})},t.prototype.moveAfter=function(e,r){var n=JSON.stringify({nodeId:e,previousNodeId:r});return this.clone(t,"MoveAfter").postCore({body:n})},t}(o.SharePointQueryableCollection);t.NavigationNodes=i;var s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),Object.defineProperty(t.prototype,"children",{get:function(){return new i(this,"Children")},enumerable:!0,configurable:!0}),t.prototype.delete=function(){return e.prototype.deleteCore.call(this)},t}(o.SharePointQueryableInstance);t.NavigationNode=s;var a=function(e){function t(t,r){return void 0===r&&(r="navigation"),e.call(this,t,r)||this}return n(t,e),Object.defineProperty(t.prototype,"quicklaunch",{get:function(){return new i(this,"quicklaunch")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"topNavigationBar",{get:function(){return new i(this,"topnavigationbar")},enumerable:!0,configurable:!0}),t}(o.SharePointQueryable);t.Navigation=a;var u=function(e){function t(t){return void 0===t&&(t=null),e.call(this,"_api/navigation",t)||this}return n(t,e),t.prototype.getMenuState=function(e,r,n,o){return void 0===e&&(e=null),void 0===r&&(r=10),void 0===n&&(n=null),void 0===o&&(o=null),new t("MenuState").postCore({body:JSON.stringify({customProperties:o,depth:r,mapProviderName:n,menuNodeKey:e})})},t.prototype.getMenuNodeKey=function(e,r){return void 0===r&&(r=null),new t("MenuNodeKey").postCore({body:JSON.stringify({currentUrl:e,mapProviderName:r})})},t}(o.SharePointQueryable);t.NavigationService=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(5),i=r(24),s=r(11),a=r(4),u=r(2),l=function(){function e(e,t){void 0===t&&(t=n.Util.getGUID()),this.baseUrl=e,this._batchId=t,this._requests=[],this._dependencies=[]}return e.ParseResponse=function(e){return new Promise(function(t,r){for(var n,o,i=[],s=new RegExp("^HTTP/[0-9.]+ +([0-9]+) +(.*)","i"),a=e.split("\n"),l="batch",c=0;c<a.length;++c){var p=a[c];switch(l){case"batch":if("--batchresponse_"===p.substr(0,"--batchresponse_".length))l="batchHeaders";else if(""!==p.trim())throw new u.BatchParseException("Invalid response, line "+c);break;case"batchHeaders":""===p.trim()&&(l="status");break;case"status":var d=s.exec(p);if(3!==d.length)throw new u.BatchParseException("Invalid status, line "+c);n=parseInt(d[1],10),o=d[2],l="statusHeaders";break;case"statusHeaders":""===p.trim()&&(l="body");break;case"body":i.push(204===n?new Response:new Response(p,{status:n,statusText:o})),l="batch"}}"status"!==l&&r(new u.BatchParseException("Unexpected end of input")),t(i)})},Object.defineProperty(e.prototype,"batchId",{get:function(){return this._batchId},enumerable:!0,configurable:!0}),e.prototype.add=function(e,t,r,n){var o={method:t.toUpperCase(),options:r,parser:n,reject:null,resolve:null,url:e},i=new Promise(function(e,t){o.resolve=e,o.reject=t});return this._requests.push(o),i},e.prototype.addDependency=function(){var e,t=new Promise(function(t){e=t});return this._dependencies.push(t),e},e.prototype.execute=function(){var e=this;return Promise.all(this._dependencies).then(function(){return Promise.all(e._dependencies)}).then(function(){return e.executeImpl()})},e.prototype.executeImpl=function(){var t=this;if(o.Logger.write("["+this.batchId+"] ("+(new Date).getTime()+") Executing batch with "+this._requests.length+" requests.",o.LogLevel.Info),this._requests.length<1)return o.Logger.write("Resolving empty batch.",o.LogLevel.Info),Promise.resolve();var r=new i.HttpClient;return n.Util.toAbsoluteUrl(this.baseUrl).then(function(i){for(var l=[],c="",p=0;p<t._requests.length;p++){var d=t._requests[p];"GET"===d.method?(c.length>0&&(l.push("--changeset_"+c+"--\n\n"),c=""),l.push("--batch_"+t._batchId+"\n")):(c.length<1&&(c=n.Util.getGUID(),l.push("--batch_"+t._batchId+"\n"),l.push('Content-Type: multipart/mixed; boundary="changeset_'+c+'"\n\n')),l.push("--changeset_"+c+"\n")),l.push("Content-Type: application/http\n"),l.push("Content-Transfer-Encoding: binary\n\n");var f=new Headers,h=n.Util.isUrlAbsolute(d.url)?d.url:n.Util.combinePaths(i,d.url);if(o.Logger.write("["+t.batchId+"] ("+(new Date).getTime()+") Adding request "+d.method+" "+h+" to batch.",o.LogLevel.Verbose),"GET"!==d.method){var y=d.method;d.hasOwnProperty("options")&&d.options.hasOwnProperty("headers")&&void 0!==d.options.headers["X-HTTP-Method"]&&(y=d.options.headers["X-HTTP-Method"],delete d.options.headers["X-HTTP-Method"]),l.push(y+" "+h+" HTTP/1.1\n"),f.set("Content-Type","application/json;odata=verbose;charset=utf-8")}else l.push(d.method+" "+h+" HTTP/1.1\n");s.mergeHeaders(f,a.RuntimeConfig.spHeaders),d.options&&s.mergeHeaders(f,d.options.headers),f.has("Accept")||f.append("Accept","application/json"),f.has("Content-Type")||f.append("Content-Type","application/json;odata=verbose;charset=utf-8"),f.has("X-ClientService-ClientTag")||f.append("X-ClientService-ClientTag","PnPCoreJS:3.0.10"),f.forEach(function(e,t){l.push(t+": "+e+"\n")}),l.push("\n"),d.options.body&&l.push(d.options.body+"\n\n")}c.length>0&&(l.push("--changeset_"+c+"--\n\n"),c=""),l.push("--batch_"+t._batchId+"--\n");var g={"Content-Type":"multipart/mixed; boundary=batch_"+t._batchId},b={body:l.join(""),headers:g,method:"POST"};return o.Logger.write("["+t.batchId+"] ("+(new Date).getTime()+") Sending batch request.",o.LogLevel.Info),r.fetch(n.Util.combinePaths(i,"/_api/$batch"),b).then(function(e){return e.text()}).then(e.ParseResponse).then(function(e){if(e.length!==t._requests.length)throw new u.BatchParseException("Could not properly parse responses to match requests in batch.");return o.Logger.write("["+t.batchId+"] ("+(new Date).getTime()+") Resolving batched requests.",o.LogLevel.Info),e.reduce(function(e,r,n){var i=t._requests[n];return o.Logger.write("["+t.batchId+"] ("+(new Date).getTime()+") Resolving batched request "+i.method+" "+i.url+".",o.LogLevel.Verbose),e.then(function(e){return i.parser.parse(r).then(i.resolve).catch(i.reject)})},Promise.resolve())})})},e}();t.ODataBatch=l},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;!function(e){e[e.Text=2]="Text",e[e.Note=3]="Note",e[e.DateTime=4]="DateTime",e[e.Choice=6]="Choice",e[e.Lookup=7]="Lookup",e[e.Boolean=8]="Boolean",e[e.Number=9]="Number",e[e.MultiChoice=15]="MultiChoice",e[e.User=20]="User"}(n||(n={})),t.FieldType=n;var o;!function(e){e[e.ListColumn=0]="ListColumn",e[e.SiteColumn=1]="SiteColumn"}(o||(o={})),t.FieldScope=o},function(e,t,r){"use strict";function n(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0});var o=r(0),i=r(15),s=r(59),a=r(5),u=r(60),l=r(4),c=r(70);t.util=o.Util,t.sp=new u.SPRest,t.graph=new c.GraphRest,t.storage=new i.PnPClientStorage,t.config=new s.Settings,t.log=a.Logger,t.setup=l.setRuntimeConfig,n(r(79)),n(r(82)),n(r(84)),n(r(87)),n(r(88));var p={config:t.config,graph:t.graph,log:t.log,setup:t.setup,sp:t.sp,storage:t.storage,util:t.util};t.default=p},function(e,t){var r;r=function(){return this}();try{r=r||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(r=window)}e.exports=r},function(e,t,r){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function t(){}return t.prototype.fetch=function(t,r){return e.fetch(t,r)},t}();t.FetchClient=r}).call(t,r(34))},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=r(1),i=r(0),s=function(){function e(e,t){void 0===e&&(e=""),void 0===t&&(t={}),this._query=t,"string"==typeof e&&e.length>0&&this.extendQuery({Querytext:e})}return e.create=function(t,r){return void 0===t&&(t=""),void 0===r&&(r={}),new e(t,r)},e.prototype.text=function(e){return this.extendQuery({Querytext:e})},e.prototype.template=function(e){return this.extendQuery({QueryTemplate:e})},e.prototype.sourceId=function(e){return this.extendQuery({SourceId:e})},Object.defineProperty(e.prototype,"enableInterleaving",{get:function(){return this.extendQuery({EnableInterleaving:!0})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"enableStemming",{get:function(){return this.extendQuery({EnableStemming:!0})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"trimDuplicates",{get:function(){return this.extendQuery({TrimDuplicates:!0})},enumerable:!0,configurable:!0}),e.prototype.trimDuplicatesIncludeId=function(e){return this.extendQuery({TrimDuplicatesIncludeId:e})},Object.defineProperty(e.prototype,"enableNicknames",{get:function(){return this.extendQuery({EnableNicknames:!0})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"enableFql",{get:function(){return this.extendQuery({EnableFQL:!0})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"enablePhonetic",{get:function(){return this.extendQuery({EnablePhonetic:!0})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bypassResultTypes",{get:function(){return this.extendQuery({BypassResultTypes:!0})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"processBestBets",{get:function(){return this.extendQuery({ProcessBestBets:!0})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"enableQueryRules",{get:function(){return this.extendQuery({EnableQueryRules:!0})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"enableSorting",{get:function(){return this.extendQuery({EnableSorting:!0})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"generateBlockRankLog",{get:function(){return this.extendQuery({GenerateBlockRankLog:!0})},enumerable:!0,configurable:!0}),e.prototype.rankingModelId=function(e){return this.extendQuery({RankingModelId:e})},e.prototype.startRow=function(e){return this.extendQuery({StartRow:e})},e.prototype.rowLimit=function(e){return this.extendQuery({RowLimit:e})},e.prototype.rowsPerPage=function(e){return this.extendQuery({RowsPerPage:e})},e.prototype.selectProperties=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.extendQuery({SelectProperties:e})},e.prototype.culture=function(e){return this.extendQuery({Culture:e})},e.prototype.timeZoneId=function(e){return this.extendQuery({TimeZoneId:e})},e.prototype.refinementFilters=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.extendQuery({RefinementFilters:e})},e.prototype.refiners=function(e){return this.extendQuery({Refiners:e})},e.prototype.hiddenConstraints=function(e){return this.extendQuery({HiddenConstraints:e})},e.prototype.sortList=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.extendQuery({SortList:e})},e.prototype.timeout=function(e){return this.extendQuery({Timeout:e})},e.prototype.hithighlightedProperties=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.extendQuery({HitHighlightedProperties:e})},e.prototype.clientType=function(e){return this.extendQuery({ClientType:e})},e.prototype.personalizationData=function(e){return this.extendQuery({PersonalizationData:e})},e.prototype.resultsURL=function(e){return this.extendQuery({ResultsUrl:e})},e.prototype.queryTag=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.extendQuery({QueryTag:e})},e.prototype.properties=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.extendQuery({Properties:e})},Object.defineProperty(e.prototype,"processPersonalFavorites",{get:function(){return this.extendQuery({ProcessPersonalFavorites:!0})},enumerable:!0,configurable:!0}),e.prototype.queryTemplatePropertiesUrl=function(e){return this.extendQuery({QueryTemplatePropertiesUrl:e})},e.prototype.reorderingRules=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.extendQuery({ReorderingRules:e})},e.prototype.hitHighlightedMultivaluePropertyLimit=function(e){return this.extendQuery({HitHighlightedMultivaluePropertyLimit:e})},Object.defineProperty(e.prototype,"enableOrderingHitHighlightedProperty",{get:function(){return this.extendQuery({EnableOrderingHitHighlightedProperty:!0})},enumerable:!0,configurable:!0}),e.prototype.collapseSpecification=function(e){return this.extendQuery({CollapseSpecification:e})},e.prototype.uiLanguage=function(e){return this.extendQuery({UILanguage:e})},e.prototype.desiredSnippetLength=function(e){return this.extendQuery({DesiredSnippetLength:e})},e.prototype.maxSnippetLength=function(e){return this.extendQuery({MaxSnippetLength:e})},e.prototype.summaryLength=function(e){return this.extendQuery({SummaryLength:e})},e.prototype.toSearchQuery=function(){return this._query},e.prototype.extendQuery=function(e){return this._query=i.Util.extend(this._query,e),this},e}();t.SearchQueryBuilder=s;var a=function(e){function t(t,r){return void 0===r&&(r="_api/search/postquery"),e.call(this,t,r)||this}return n(t,e),t.prototype.execute=function(e){var t,r=this;t=e,t.SelectProperties&&(t.SelectProperties=this.fixupProp(e.SelectProperties)),t.RefinementFilters&&(t.RefinementFilters=this.fixupProp(e.RefinementFilters)),t.SortList&&(t.SortList=this.fixupProp(e.SortList)),t.HithighlightedProperties&&(t.HithighlightedProperties=this.fixupProp(e.HitHighlightedProperties)),t.ReorderingRules&&(t.ReorderingRules=this.fixupProp(e.ReorderingRules)),t.Properties&&(t.Properties=this.fixupProp(e.Properties));var n=JSON.stringify({request:i.Util.extend({__metadata:{type:"Microsoft.Office.Server.Search.REST.SearchRequest"}},t)});return this.postCore({body:n}).then(function(t){return new u(t,r.toUrl(),e)})},t.prototype.fixupProp=function(e){return e.hasOwnProperty("results")?e:{results:e}},t}(o.SharePointQueryableInstance);t.Search=a;var u=function(){function e(e,t,r,n,o){void 0===n&&(n=null),void 0===o&&(o=null),this._url=t,this._query=r,this._raw=n,this._primary=o,this._raw=e.postquery?e.postquery:e}return Object.defineProperty(e.prototype,"ElapsedTime",{get:function(){return this.RawSearchResults.ElapsedTime},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"RowCount",{get:function(){return this.RawSearchResults.PrimaryQueryResult.RelevantResults.RowCount},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"TotalRows",{get:function(){return this.RawSearchResults.PrimaryQueryResult.RelevantResults.TotalRows},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"TotalRowsIncludingDuplicates",{get:function(){return this.RawSearchResults.PrimaryQueryResult.RelevantResults.TotalRowsIncludingDuplicates},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"RawSearchResults",{get:function(){return this._raw},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"PrimarySearchResults",{get:function(){return null===this._primary&&(this._primary=this.formatSearchResults(this._raw.PrimaryQueryResult.RelevantResults.Table.Rows)),this._primary},enumerable:!0,configurable:!0}),e.prototype.getPage=function(e,t){if(this.TotalRows<this.RowCount)return Promise.resolve(null);var r=void 0!==t?t:this._query.hasOwnProperty("RowLimit")?this._query.RowLimit:10,n=i.Util.extend(this._query,{RowLimit:r,StartRow:r*(e-1)});return n.StartRow>this.TotalRows?Promise.resolve(null):new a(this._url,null).execute(n)},e.prototype.formatSearchResults=function(e){for(var t=new Array,r=e.results?e.results:e,n=0,o=r;n<o.length;n++){var i=o[n],s=i.Cells.results?i.Cells.results:i.Cells;t.push(s.reduce(function(e,t){return Object.defineProperty(e,t.Key,{configurable:!1,enumerable:!1,value:t.Value,writable:!1}),e},{}))}return t},e}();t.SearchResults=u;!function(e){e[e.Ascending=0]="Ascending",e[e.Descending=1]="Descending",e[e.FQLFormula=2]="FQLFormula"}(t.SortDirection||(t.SortDirection={}));!function(e){e[e.ResultContainsKeyword=0]="ResultContainsKeyword",e[e.TitleContainsKeyword=1]="TitleContainsKeyword",e[e.TitleMatchesKeyword=2]="TitleMatchesKeyword",e[e.UrlStartsWith=3]="UrlStartsWith",e[e.UrlExactlyMatches=4]="UrlExactlyMatches",e[e.ContentTypeIs=5]="ContentTypeIs",e[e.FileExtensionMatches=6]="FileExtensionMatches",e[e.ResultHasTag=7]="ResultHasTag",e[e.ManualCondition=8]="ManualCondition"}(t.ReorderingRuleMatchType||(t.ReorderingRuleMatchType={}));!function(e){e[e.None=0]="None",e[e.StringType=1]="StringType",e[e.Int32Type=2]="Int32Type",e[e.BooleanType=3]="BooleanType",e[e.StringArrayType=4]="StringArrayType",e[e.UnSupportedType=5]="UnSupportedType"}(t.QueryPropertyValueType||(t.QueryPropertyValueType={}));var l=function(){function e(){}return e.Documents="e7ec8cee-ded8-43c9-beb5-436b54b31e84",e.ItemsMatchingContentType="5dc9f503-801e-4ced-8a2c-5d1237132419",e.ItemsMatchingTag="e1327b9c-2b8c-4b23-99c9-3730cb29c3f7",e.ItemsRelatedToCurrentUser="48fec42e-4a92-48ce-8363-c2703a40e67d",e.ItemsWithSameKeywordAsThisItem="5c069288-1d17-454a-8ac6-9c642a065f48",e.LocalPeopleResults="b09a7990-05ea-4af9-81ef-edfab16c4e31",e.LocalReportsAndDataResults="203fba36-2763-4060-9931-911ac8c0583b",e.LocalSharePointResults="8413cd39-2156-4e00-b54d-11efd9abdb89",e.LocalVideoResults="78b793ce-7956-4669-aa3b-451fc5defebf",e.Pages="5e34578e-4d08-4edc-8bf3-002acf3cdbcc",e.Pictures="38403c8c-3975-41a8-826e-717f2d41568a",e.Popular="97c71db1-58ce-4891-8b64-585bc2326c12",e.RecentlyChangedItems="ba63bbae-fa9c-42c0-b027-9a878f16557c",e.RecommendedItems="ec675252-14fa-4fbe-84dd-8d098ed74181",e.Wiki="9479bf85-e257-4318-b5a8-81a180f5faa1",e}();t.SearchBuiltInSourceId=l},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(15),o=r(0),i=r(4),s=function(){function e(e){this.key=e,this.expiration=o.Util.dateAdd(new Date,"second",i.RuntimeConfig.defaultCachingTimeoutSeconds),this.storeName=i.RuntimeConfig.defaultCachingStore}return Object.defineProperty(e.prototype,"store",{get:function(){return"local"===this.storeName?e.storage.local:e.storage.session},enumerable:!0,configurable:!0}),e.storage=new n.PnPClientStorage,e}();t.CachingOptions=s;var a=function(){function e(e,t){this._parser=e,this._cacheOptions=t}return e.prototype.parse=function(e){var t=this;return this._parser.parse(e).then(function(e){return null!==t._cacheOptions.store&&t._cacheOptions.store.put(t._cacheOptions.key,e,t._cacheOptions.expiration),e})},e}();t.CachingParserWrapper=a},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=r(1),i=function(e){function t(t,r){return void 0===r&&(r="_api/search/suggest"),e.call(this,t,r)||this}return n(t,e),t.prototype.execute=function(e){return this.mapQueryToQueryString(e),this.get().then(function(e){return new s(e)})},t.prototype.mapQueryToQueryString=function(e){this.query.add("querytext","'"+e.querytext+"'"),e.hasOwnProperty("count")&&this.query.add("inumberofquerysuggestions",e.count.toString()),e.hasOwnProperty("personalCount")&&this.query.add("inumberofresultsuggestions",e.personalCount.toString()),e.hasOwnProperty("preQuery")&&this.query.add("fprequerysuggestions",e.preQuery.toString()),e.hasOwnProperty("hitHighlighting")&&this.query.add("fhithighlighting",e.hitHighlighting.toString()),e.hasOwnProperty("capitalize")&&this.query.add("fcapitalizefirstletters",e.capitalize.toString()),e.hasOwnProperty("culture")&&this.query.add("culture",e.culture.toString()),e.hasOwnProperty("stemming")&&this.query.add("enablestemming",e.stemming.toString()),e.hasOwnProperty("includePeople")&&this.query.add("showpeoplenamesuggestions",e.includePeople.toString()),e.hasOwnProperty("queryRules")&&this.query.add("enablequeryrules",e.queryRules.toString()),e.hasOwnProperty("prefixMatch")&&this.query.add("fprefixmatchallterms",e.prefixMatch.toString())},t}(o.SharePointQueryableInstance);t.SearchSuggest=i;var s=function(){function e(e){e.hasOwnProperty("suggest")?(this.PeopleNames=e.suggest.PeopleNames.results,this.PersonalResults=e.suggest.PersonalResults.results,this.Queries=e.suggest.Queries.results):(this.PeopleNames=e.PeopleNames,this.PersonalResults=e.PersonalResults,this.Queries=e.Queries)}return e}();t.SearchSuggestResult=s},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=r(1),i=r(12),s=r(29),a=r(3),u=r(31),l=r(43),c=function(e){function t(t,r){return void 0===r&&(r="_api/site"),e.call(this,t,r)||this}return n(t,e),Object.defineProperty(t.prototype,"rootWeb",{get:function(){return new i.Web(this,"rootweb")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"features",{get:function(){return new l.Features(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"userCustomActions",{get:function(){return new s.UserCustomActions(this)},enumerable:!0,configurable:!0}),t.prototype.getRootWeb=function(){return this.rootWeb.select("Url").get().then(function(e){return new i.Web(e.Url)})},t.prototype.getContextInfo=function(){return new t(this.parentUrl,"_api/contextinfo").postCore().then(function(e){if(e.hasOwnProperty("GetContextWebInformation")){var t=e.GetContextWebInformation;return t.SupportedSchemaVersions=t.SupportedSchemaVersions.results,t}return e})},t.prototype.getDocumentLibraries=function(e){var t=new o.SharePointQueryable("","_api/sp.web.getdocumentlibraries(@v)");return t.query.add("@v","'"+e+"'"),t.get().then(function(e){return e.hasOwnProperty("GetDocumentLibraries")?e.GetDocumentLibraries:e})},t.prototype.getWebUrlFromPageUrl=function(e){var t=new o.SharePointQueryable("","_api/sp.web.getweburlfrompageurl(@v)");return t.query.add("@v","'"+e+"'"),t.get().then(function(e){return e.hasOwnProperty("GetWebUrlFromPageUrl")?e.GetWebUrlFromPageUrl:e})},t.prototype.createBatch=function(){return new u.ODataBatch(this.parentUrl)},t.prototype.openWebById=function(e){return this.clone(t,"openWebById('"+e+"')").postCore().then(function(e){return{data:e,web:i.Web.fromUrl(a.spExtractODataId(e))}})},t}(o.SharePointQueryableInstance);t.Site=c},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=r(12),i=r(25),s=r(19),a=r(1),u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),Object.defineProperty(t.prototype,"roleAssignments",{get:function(){return new i.RoleAssignments(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"firstUniqueAncestorSecurableObject",{get:function(){return new a.SharePointQueryableInstance(this,"FirstUniqueAncestorSecurableObject")},enumerable:!0,configurable:!0}),t.prototype.getUserEffectivePermissions=function(e){var t=this.clone(a.SharePointQueryable,"getUserEffectivePermissions(@user)");return t.query.add("@user","'"+encodeURIComponent(e)+"'"),t.get().then(function(e){return e.hasOwnProperty("GetUserEffectivePermissions")?e.GetUserEffectivePermissions:e})},t.prototype.getCurrentUserEffectivePermissions=function(){var e=this;return o.Web.fromUrl(this.toUrl()).currentUser.select("LoginName").getAs().then(function(t){return e.getUserEffectivePermissions(t.LoginName)})},t.prototype.breakRoleInheritance=function(e,r){return void 0===e&&(e=!1),void 0===r&&(r=!1),this.clone(t,"breakroleinheritance(copyroleassignments="+e+", clearsubscopes="+r+")").postCore()},t.prototype.resetRoleInheritance=function(){return this.clone(t,"resetroleinheritance").postCore()},t.prototype.userHasPermissions=function(e,t){var r=this;return this.getUserEffectivePermissions(e).then(function(e){return r.hasPermissions(e,t)})},t.prototype.currentUserHasPermissions=function(e){var t=this;return this.getCurrentUserEffectivePermissions().then(function(r){return t.hasPermissions(r,e)})},t.prototype.hasPermissions=function(e,t){if(!t)return!0;var r=parseFloat(e.Low),n=parseFloat(e.High);if(t===s.PermissionKind.FullMask)return 32767==(32767&n)&&65535===r;t-=1;var o=1;return t>=0&&t<32?(o<<=t,0!=(r&o)):t>=32&&t<64&&(o<<=t-32,0!=(n&o))},t}(a.SharePointQueryableInstance);t.SharePointQueryableSecurable=u},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=r(1),i=r(26),s=r(0),a=function(e){function t(t,r){return void 0===r&&(r="siteusers"),e.call(this,t,r)||this}return n(t,e),t.prototype.getByEmail=function(e){return new u(this,"getByEmail('"+e+"')")},t.prototype.getById=function(e){return new u(this,"getById("+e+")")},t.prototype.getByLoginName=function(e){var t=new u(this);return t.concat("('!@v::"+encodeURIComponent(e)+"')"),t},t.prototype.removeById=function(e){return this.clone(t,"removeById("+e+")").postCore()},t.prototype.removeByLoginName=function(e){var r=this.clone(t,"removeByLoginName(@v)");return r.query.add("@v","'"+encodeURIComponent(e)+"'"),r.postCore()},t.prototype.add=function(e){var r=this;return this.clone(t,null).postCore({body:JSON.stringify({__metadata:{type:"SP.User"},LoginName:e})}).then(function(){return r.getByLoginName(e)})},t}(o.SharePointQueryableCollection);t.SiteUsers=a;var u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),Object.defineProperty(t.prototype,"groups",{get:function(){return new i.SiteGroups(this,"groups")},enumerable:!0,configurable:!0}),t.prototype.update=function(e){var t=this,r=s.Util.extend({__metadata:{type:"SP.User"}},e);return this.postCore({body:JSON.stringify(r),headers:{"X-HTTP-Method":"MERGE"}}).then(function(e){return{data:e,user:t}})},t.prototype.delete=function(){return this.postCore({headers:{"X-HTTP-Method":"DELETE"}})},t}(o.SharePointQueryableInstance);t.SiteUser=u;var l=function(e){function t(t,r){return void 0===r&&(r="currentuser"),e.call(this,t,r)||this}return n(t,e),t}(o.SharePointQueryableInstance);t.CurrentUser=l},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=r(1),i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),Object.defineProperty(t.prototype,"webparts",{get:function(){return new s(this,"webparts")},enumerable:!0,configurable:!0}),t.prototype.export=function(e){return this.clone(t,"ExportWebPart").postCore({body:JSON.stringify({webPartId:e})})},t.prototype.import=function(e){return this.clone(t,"ImportWebPart").postCore({body:JSON.stringify({webPartXml:e})})},t}(o.SharePointQueryable);t.LimitedWebPartManager=i;var s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.getById=function(e){return new a(this,"getbyid('"+e+"')")},t.prototype.getByControlId=function(e){return new a(this,"getByControlId('"+e+"')")},t}(o.SharePointQueryableCollection);t.WebPartDefinitions=s;var a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),Object.defineProperty(t.prototype,"webpart",{get:function(){return new u(this)},enumerable:!0,configurable:!0}),t.prototype.saveChanges=function(){return this.clone(t,"SaveWebPartChanges").postCore()},t.prototype.moveTo=function(e,r){return this.clone(t,"MoveWebPartTo(zoneID='"+e+"', zoneIndex="+r+")").postCore()},t.prototype.close=function(){return this.clone(t,"CloseWebPart").postCore()},t.prototype.open=function(){return this.clone(t,"OpenWebPart").postCore()},t.prototype.delete=function(){return this.clone(t,"DeleteWebPart").postCore()},t}(o.SharePointQueryableInstance);t.WebPartDefinition=a;var u=function(e){function t(t,r){return void 0===r&&(r="webpart"),e.call(this,t,r)||this}return n(t,e),t}(o.SharePointQueryableInstance);t.WebPart=u},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=r(1),i=function(e){function t(t,r){return void 0===r&&(r="features"),e.call(this,t,r)||this}return n(t,e),t.prototype.getById=function(e){var t=new s(this);return t.concat("('"+e+"')"),t},t.prototype.add=function(e,r){var n=this;return void 0===r&&(r=!1),this.clone(t,"add").postCore({body:JSON.stringify({featdefScope:0,featureId:e,force:r})}).then(function(t){return{data:t,feature:n.getById(e)}})},t.prototype.remove=function(e,r){return void 0===r&&(r=!1),this.clone(t,"remove").postCore({body:JSON.stringify({featureId:e,force:r})})},t}(o.SharePointQueryableCollection);t.Features=i;var s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.deactivate=function(e){var r=this;void 0===e&&(e=!1);var n=this.addBatchDependency();return new t(this).select("DefinitionId").getAs().then(function(t){var o=r.getParent(i,r.parentUrl,"",r.batch).remove(t.DefinitionId,e);return n(),o})},t}(o.SharePointQueryableInstance);t.Feature=s},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=r(1),i=r(9),s=r(3),a=r(0),u=function(e){function t(t,r){void 0===r&&(r="_api/web/tenantappcatalog/AvailableApps");var n="";return"string"==typeof t?n=t:void 0!==t&&(n=t.toUrl()),e.call(this,a.extractWebUrl(n),r)||this}return n(t,e),t.prototype.getAppById=function(e){return new l(this,"getById('"+e+"')")},t.prototype.add=function(e,r,n){return void 0===n&&(n=!0),new t(a.extractWebUrl(this.toUrl()),"_api/web/tenantappcatalog/add(overwrite="+n+",url='"+e+"')").postCore({body:r}).then(function(e){return{data:e,file:new i.File(s.spExtractODataId(e))}})},t}(o.SharePointQueryableCollection);t.AppCatalog=u;var l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.deploy=function(){return this.clone(t,"Deploy").postCore()},t.prototype.retract=function(){return this.clone(t,"Retract").postCore()},t.prototype.install=function(){return this.clone(t,"Install").postCore()},t.prototype.uninstall=function(){return this.clone(t,"Uninstall").postCore()},t.prototype.upgrade=function(){return this.clone(t,"Upgrade").postCore()},t.prototype.remove=function(){return this.clone(t,"Remove").postCore()},t}(o.SharePointQueryableInstance);t.App=l},function(e,t,r){"use strict";function n(e){return e.length<1?1:Math.max.apply(null,e.map(function(e){return e.order}))+1}function o(e,t){void 0===t&&(t=0);var r=this.substring(t).search(e);return r>=0?r+t:r}function i(e,t){var r=new RegExp(t+'="([^"]*?)"',"i"),n=r.exec(e);return n.length>0?n[1]:null}function s(e,t,r){var n=[];if(void 0===e||null===e)return n;var i=e.replace(/[\t\r\n]/g,""),s=o.call(i,t);if(s<0)return n;for(;s>-1;){for(var a=1,u=s+1,l=-1,c=-1;;){if(l=o.call(i,/<div[^>]*>/i,u),c=o.call(i,/<\/div>/i,u),l<0&&(l=i.length+1),l<c?(a++,u=l+1):c<l&&(a--,u=c+1),0===a){var p=i.substring(s,c+6).trim();n.push(r(p));break}if(a>1e3||a<0)throw new Error("getBoundedDivMarkup exceeded depth parameters.")}s=o.call(i,t,c)}return n}function a(e){for(var t=0;t<e.length;t++)e[t].order=t+1,e[t].hasOwnProperty("columns")?a(e[t].columns):e[t].hasOwnProperty("controls")&&a(e[t].controls)}var u=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var l=r(9),c=r(13),p=r(0),d=function(e){function t(t,r,n){void 0===r&&(r=[]),void 0===n&&(n=!1);var o=e.call(this,t)||this;return o.sections=r,o.commentsDisabled=n,o}return u(t,e),t.create=function(e,r,n,o){return void 0===o&&(o="Article"),e.rootFolder.files.select("Name").filter("Name eq '"+r+"'").get().then(function(i){if(i.length>0)throw new Error("A file with the name '"+r+"' already exists in the library '"+e.toUrl()+"'.");return e.rootFolder.select("ServerRelativePath").get().then(function(i){var s=p.Util.combinePaths("/",i.ServerRelativePath.DecodedUrl,r);return e.rootFolder.files.addTemplateFile(s,l.TemplateFileType.ClientSidePage).then(function(e){return e.file.getItem().then(function(e){return e.update({BannerImageUrl:{Url:"/_layouts/15/images/sitepagethumbnail.png"},CanvasContent1:"",ClientSideApplicationId:"b6917cb1-93a0-4b97-a84d-7cf49975d4ec",ContentTypeId:"0x0101009D1CB255DA76424F860D91F20E6C4118",PageLayoutType:o,PromotedState:0,Title:n}).then(function(e){return new t(e.item.file,e.item.CommentsDisabled)})})})})})},t.fromFile=function(e){var r=new t(e);return r.load().then(function(e){return r})},t.jsonToEscapedString=function(e){return JSON.stringify(e).replace(/"/g,"&quot;").replace(/:/g,"&#58;").replace(/{/g,"&#123;").replace(/}/g,"&#125;")},t.escapedStringToJson=function(e){return JSON.parse(e.replace(/&quot;/g,'"').replace(/&#58;/g,":").replace(/&#123;/g,"{").replace(/&#125;/g,"}"))},t.prototype.addSection=function(){var e=new f(this,n(this.sections));return this.sections.push(e),e},t.prototype.toHtml=function(){a(this.sections);var e=[];e.push("<div>");for(var t=0;t<this.sections.length;t++)e.push(this.sections[t].toHtml());return e.push("</div>"),e.join("")},t.prototype.fromHtml=function(e){var t=this;return this.sections=[],s(e,/<div\b[^>]*data-sp-canvascontrol[^>]*?>/i,function(e){var r=/controlType&quot;&#58;(\d*?),/i.exec(e),n=null==r||r.length<2?0:parseInt(r[1],10),o=null;switch(n){case 0:o=new y(null,0),o.fromHtml(e),t.mergeColumnToTree(o);break;case 3:o=new b(""),o.fromHtml(e),t.mergeControlToTree(o);break;case 4:o=new g,o.fromHtml(e),t.mergeControlToTree(o)}}),a(this.sections),this},t.prototype.load=function(){var e=this;return this.getItem("CanvasContent1","CommentsDisabled").then(function(t){e.fromHtml(t.CanvasContent1),e.commentsDisabled=t.CommentsDisabled})},t.prototype.save=function(){return this.updateProperties({CanvasContent1:this.toHtml()})},t.prototype.enableComments=function(){var e=this;return this.setCommentsOn(!0).then(function(t){return e.commentsDisabled=!1,t})},t.prototype.disableComments=function(){var e=this;return this.setCommentsOn(!1).then(function(t){return e.commentsDisabled=!0,t})},t.prototype.findControlById=function(e){return this.findControl(function(t){return t.id===e})},t.prototype.findControl=function(e){for(var t=0;t<this.sections.length;t++)for(var r=0;r<this.sections[t].columns.length;r++)for(var n=0;n<this.sections[t].columns[r].controls.length;n++)if(e(this.sections[t].columns[r].controls[n]))return this.sections[t].columns[r].controls[n];return null},t.prototype.setCommentsOn=function(e){return this.getItem().then(function(t){return new c.Item(t,"SetCommentsDisabled("+!e+")").update({})})},t.prototype.mergeControlToTree=function(e){var t=null,r=null,n=this.sections.filter(function(t){return t.order===e.controlData.position.zoneIndex});n.length<1?(t=new f(this,e.controlData.position.zoneIndex),this.sections.push(t)):t=n[0];var o=t.columns.filter(function(t){return t.order===e.controlData.position.sectionIndex});o.length<1?(r=new y(t,e.controlData.position.sectionIndex,e.controlData.position.sectionFactor),t.columns.push(r)):r=o[0],e.column=r,r.addControl(e)},t.prototype.mergeColumnToTree=function(e){var t=null,r=this.sections.filter(function(t){return t.order===e.controlData.position.zoneIndex});r.length<1?(t=new f(this,e.controlData.position.zoneIndex),this.sections.push(t)):t=r[0],e.section=t,t.columns.push(e)},t.prototype.updateProperties=function(e,t){return void 0===t&&(t="*"),this.getItem().then(function(r){return r.update(e,t)})},t}(l.File);t.ClientSidePage=d;var f=function(){function e(e,t,r){void 0===r&&(r=[]),this.page=e,this.order=t,this.columns=r}return Object.defineProperty(e.prototype,"defaultColumn",{get:function(){return this.columns.length<1&&this.addColumn(12),this.columns[0]},enumerable:!0,configurable:!0}),e.prototype.addColumn=function(e){var t=new y(this,n(this.columns),e);return this.columns.push(t),t},e.prototype.addControl=function(e){return this.defaultColumn.addControl(e),this},e.prototype.toHtml=function(){for(var e=[],t=0;t<this.columns.length;t++)e.push(this.columns[t].toHtml());return e.join("")},e}();t.CanvasSection=f;var h=function(){function e(e,t,r,n,o,i){void 0===r&&(r=null),void 0===n&&(n=1),void 0===o&&(o=p.Util.getGUID()),void 0===i&&(i=null),this.controlType=e,this.dataVersion=t,this.column=r,this.order=n,this.id=o,this.controlData=i}return Object.defineProperty(e.prototype,"jsonData",{get:function(){return d.jsonToEscapedString(this.getControlData())},enumerable:!0,configurable:!0}),e.prototype.fromHtml=function(e){this.controlData=d.escapedStringToJson(i(e,"data-sp-controldata")),this.dataVersion=i(e,"data-sp-canvasdataversion"),this.controlType=this.controlData.controlType,this.id=this.controlData.id},e}();t.CanvasControl=h;var y=function(e){function t(t,r,n,o,i){void 0===n&&(n=12),void 0===o&&(o=[]),void 0===i&&(i="1.0");var s=e.call(this,0,i)||this;return s.section=t,s.order=r,s.factor=n,s.controls=o,s}return u(t,e),t.prototype.addControl=function(e){return e.column=this,this.controls.push(e),this},t.prototype.getControl=function(e){return this.controls[e]},t.prototype.toHtml=function(){var e=[];if(this.controls.length<1)e.push('<div data-sp-canvascontrol="" data-sp-canvasdataversion="'+this.dataVersion+'" data-sp-controldata="'+this.jsonData+'"></div>');else for(var t=0;t<this.controls.length;t++)e.push(this.controls[t].toHtml(t+1));return e.join("")},t.prototype.fromHtml=function(t){e.prototype.fromHtml.call(this,t),this.controlData=d.escapedStringToJson(i(t,"data-sp-controldata")),this.factor=this.controlData.position.sectionFactor,this.order=this.controlData.position.sectionIndex},t.prototype.getControlData=function(){return{displayMode:2,position:{sectionFactor:this.factor,sectionIndex:this.order,zoneIndex:this.section.order}}},t}(h);t.CanvasColumn=y;var g=function(e){function t(t){void 0===t&&(t="");var r=e.call(this,4,"1.0")||this;return r.text=t,r}return u(t,e),Object.defineProperty(t.prototype,"text",{get:function(){return this._text},set:function(e){e.startsWith("<p>")||(e="<p>"+e+"</p>"),this._text=e},enumerable:!0,configurable:!0}),t.prototype.getControlData=function(){return{controlType:this.controlType,editorType:"CKEditor",id:this.id,position:{controlIndex:this.order,sectionFactor:this.column.factor,sectionIndex:this.column.order,zoneIndex:this.column.section.order}}},t.prototype.toHtml=function(e){this.order=e;var t=[];return t.push('<div data-sp-canvascontrol="" data-sp-canvasdataversion="'+this.dataVersion+'" data-sp-controldata="'+this.jsonData+'">'),t.push('<div data-sp-rte="">'),t.push(""+this.text),t.push("</div>"),t.push("</div>"),t.join("")},t.prototype.fromHtml=function(t){e.prototype.fromHtml.call(this,t);var r=/<div[^>]*data-sp-rte[^>]*>(.*?)<\/div>$/i.exec(t);this.text=r.length>1?r[1]:""},t}(h);t.ClientSideText=g;var b=function(e){function t(t,r,n,o,i,s){void 0===r&&(r=""),void 0===n&&(n={}),void 0===o&&(o=""),void 0===i&&(i=""),void 0===s&&(s=null);var a=e.call(this,3,"1.0")||this;return a.title=t,a.description=r,a.propertieJson=n,a.webPartId=o,a.htmlProperties=i,a.serverProcessedContent=s,a}return u(t,e),t.fromComponentDef=function(e){var r=new t("");return r.import(e),r},t.prototype.import=function(e){this.webPartId=e.Id.replace(/^\{|\}$/g,"");var t=JSON.parse(e.Manifest);this.title=t.preconfiguredEntries[0].title.default,this.description=t.preconfiguredEntries[0].description.default,this.propertieJson=this.parseJsonProperties(t.preconfiguredEntries[0].properties)},t.prototype.setProperties=function(e){return this.propertieJson=e,this},t.prototype.getProperties=function(){return this.propertieJson},t.prototype.toHtml=function(e){this.order=e;var t={dataVersion:this.dataVersion,description:this.description,id:this.webPartId,instanceId:this.id,properties:this.propertieJson,title:this.title},r=[];return r.push('<div data-sp-canvascontrol="" data-sp-canvasdataversion="'+this.dataVersion+'" data-sp-controldata="'+this.jsonData+'">'),r.push('<div data-sp-webpart="" data-sp-canvasdataversion="'+this.dataVersion+'" data-sp-webpartdata="'+d.jsonToEscapedString(t)+'">'),r.push("<div data-sp-componentid>"),r.push(this.webPartId),r.push("</div>"),r.push('<div data-sp-htmlproperties="">'),r.push(this.renderHtmlProperties()),r.push("</div>"),r.push("</div>"),r.push("</div>"),r.join("")},t.prototype.fromHtml=function(t){e.prototype.fromHtml.call(this,t);var r=d.escapedStringToJson(i(t,"data-sp-webpartdata"));this.title=r.title,this.description=r.description,this.webPartId=r.id,this.setProperties(r.properties),void 0!==r.serverProcessedContent&&(this.serverProcessedContent=r.serverProcessedContent);var n=s(t,/<div\b[^>]*data-sp-htmlproperties[^>]*?>/i,function(e){return e.replace(/^<div\b[^>]*data-sp-htmlproperties[^>]*?>/i,"").replace(/<\/div>$/i,"")});this.htmlProperties=n.length>0?n[0]:""},t.prototype.getControlData=function(){return{controlType:this.controlType,id:this.id,position:{controlIndex:this.order,sectionFactor:this.column.factor,sectionIndex:this.column.order,zoneIndex:this.column.section.order},webPartId:this.webPartId}},t.prototype.renderHtmlProperties=function(){var e=[];if(void 0===this.serverProcessedContent||null===this.serverProcessedContent)e.push(this.htmlProperties);else if(void 0!==this.serverProcessedContent){if(void 0!==this.serverProcessedContent.searchablePlainTexts)for(var t=0;t<this.serverProcessedContent.searchablePlainTexts.length;t++){var r=this.serverProcessedContent.searchablePlainTexts[t];e.push('<div data-sp-prop-name="'+r.Name+'" data-sp-searchableplaintext="true">'),e.push(r.Value),e.push("</div>")}if(void 0!==this.serverProcessedContent.imageSources)for(var t=0;t<this.serverProcessedContent.imageSources.length;t++){var r=this.serverProcessedContent.imageSources[t];e.push('<img data-sp-prop-name="'+r.Name+'" src="'+r.Value+'" />')}if(void 0!==this.serverProcessedContent.links)for(var t=0;t<this.serverProcessedContent.links.length;t++){var r=this.serverProcessedContent.links[t];e.push('<a data-sp-prop-name="'+r.Name+'" href="'+r.Value+'"></a>')}}return e.join("")},t.prototype.parseJsonProperties=function(e){return void 0!==e.webPartData&&void 0!==e.webPartData.serverProcessedContent?this.serverProcessedContent=e.webPartData.serverProcessedContent:void 0!==e.serverProcessedContent?this.serverProcessedContent=e.serverProcessedContent:this.serverProcessedContent=null,void 0!==e.webPartData&&void 0!==e.webPartData.properties?e.webPartData.properties:void 0!==e.properties?e.properties:e},t}(h);t.ClientSideWebpart=b},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=r(1),i=r(0),s=function(e){function t(t,r){return void 0===r&&(r="_api/social.following"),e.call(this,t,r)||this}return n(t,e),Object.defineProperty(t.prototype,"my",{get:function(){return new a(this)},enumerable:!0,configurable:!0}),t.prototype.getFollowedSitesUri=function(){return this.clone(t,"FollowedSitesUri").get().then(function(e){return e.FollowedSitesUri||e})},t.prototype.getFollowedDocumentsUri=function(){return this.clone(t,"FollowedDocumentsUri").get().then(function(e){return e.FollowedDocumentsUri||e})},t.prototype.follow=function(e){return this.clone(t,"follow").postCore({body:this.createSocialActorInfoRequestBody(e)})},t.prototype.isFollowed=function(e){return this.clone(t,"isfollowed").postCore({body:this.createSocialActorInfoRequestBody(e)})},t.prototype.stopFollowing=function(e){return this.clone(t,"stopfollowing").postCore({body:this.createSocialActorInfoRequestBody(e)})},t.prototype.createSocialActorInfoRequestBody=function(e){return JSON.stringify({actor:i.Util.extend({Id:null,__metadata:{type:"SP.Social.SocialActorInfo"}},e)})},t}(o.SharePointQueryableInstance);t.SocialQuery=s;var a=function(e){function t(t,r){return void 0===r&&(r="my"),e.call(this,t,r)||this}return n(t,e),t.prototype.followed=function(e){return this.clone(t,"followed(types="+e+")").get().then(function(e){return e.hasOwnProperty("Followed")?e.Followed.results:e})},t.prototype.followedCount=function(e){return this.clone(t,"followedcount(types="+e+")").get().then(function(e){return e.FollowedCount||e})},t.prototype.followers=function(){return this.clone(t,"followers").get().then(function(e){return e.hasOwnProperty("Followers")?e.Followers.results:e})},t.prototype.suggestions=function(){return this.clone(t,"suggestions").get().then(function(e){return e.hasOwnProperty("Suggestions")?e.Suggestions.results:e})},t}(o.SharePointQueryableInstance);t.MySocialQuery=a},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=r(1),i=r(0),s=r(9),a=r(3),u=function(e){function t(r,n){return e.call(this,t.getBaseUrl(r),"_api/SP.Utilities.Utility."+n)||this}return n(t,e),t.getBaseUrl=function(e){if("string"==typeof e)return e;var t=e,r=t.toUrl(),n=r.indexOf("_api/");return n<0?r:r.substr(0,n)},t.prototype.excute=function(e){return this.postAsCore({body:JSON.stringify(e)})},t.prototype.sendEmail=function(e){var r={properties:{Body:e.Body,From:e.From,Subject:e.Subject,__metadata:{type:"SP.Utilities.EmailProperties"}}};return e.To&&e.To.length>0&&(r.properties=i.Util.extend(r.properties,{To:{results:e.To}})),e.CC&&e.CC.length>0&&(r.properties=i.Util.extend(r.properties,{CC:{results:e.CC}})),e.BCC&&e.BCC.length>0&&(r.properties=i.Util.extend(r.properties,{BCC:{results:e.BCC}})),e.AdditionalHeaders&&(r.properties=i.Util.extend(r.properties,{AdditionalHeaders:e.AdditionalHeaders})),this.clone(t,"SendEmail",!0).excute(r)},t.prototype.getCurrentUserEmailAddresses=function(){return this.clone(t,"GetCurrentUserEmailAddresses",!0).excute({})},t.prototype.resolvePrincipal=function(e,r,n,o,i,s){void 0===s&&(s=!1);var a={addToUserInfoList:i,input:e,inputIsEmailOnly:o,matchUserInfoList:s,scopes:r,sources:n};return this.clone(t,"ResolvePrincipalInCurrentContext",!0).excute(a)},t.prototype.searchPrincipals=function(e,r,n,o,i){var s={groupName:o,input:e,maxCount:i,scopes:r,sources:n};return this.clone(t,"SearchPrincipalsUsingContextWeb",!0).excute(s)},t.prototype.createEmailBodyForInvitation=function(e){var r={pageAddress:e};return this.clone(t,"CreateEmailBodyForInvitation",!0).excute(r)},t.prototype.expandGroupsToPrincipals=function(e,r){void 0===r&&(r=30);var n={inputs:e,maxCount:r};return this.clone(t,"ExpandGroupsToPrincipals",!0).excute(n)},t.prototype.createWikiPage=function(e){return this.clone(t,"CreateWikiPageInContextWeb",!0).excute({parameters:e}).then(function(e){return{data:e,file:new s.File(a.spExtractODataId(e))}})},t}(o.SharePointQueryable);t.UtilityMethod=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(4),i=r(11),s=function(){function e(){this._impl=o.RuntimeConfig.graphFetchClientFactory()}return e.prototype.fetch=function(e,t){void 0===t&&(t={});var r=new Headers;i.mergeHeaders(r,o.RuntimeConfig.graphHeaders),i.mergeHeaders(r,t.headers);var s=n.Util.extend(t,{headers:r});return this.fetchRaw(e,s)},e.prototype.fetchRaw=function(e,t){var r=this;void 0===t&&(t={});var o=new Headers;i.mergeHeaders(o,t.headers),t=n.Util.extend(t,{headers:o});var s=function(o){r._impl.fetch(e,{},t).then(function(e){return o.resolve(e)}).catch(function(e){429!==e.status&&503!==e.status&&o.reject(e);var t=o.delay;o.delay*=2,o.attempts++,o.retryCount<=o.attempts&&o.reject(e),setTimeout(n.Util.getCtxCallback(r,s,o),t)})};return new Promise(function(e,t){var n={attempts:0,delay:100,reject:t,resolve:e,retryCount:7};s.call(r,n)})},e.prototype.get=function(e,t){void 0===t&&(t={});var r=n.Util.extend(t,{method:"GET"});return this.fetch(e,r)},e.prototype.post=function(e,t){void 0===t&&(t={});var r=n.Util.extend(t,{method:"POST"});return this.fetch(e,r)},e.prototype.patch=function(e,t){void 0===t&&(t={});var r=n.Util.extend(t,{method:"PATCH"});return this.fetch(e,r)},e.prototype.delete=function(e,t){void 0===t&&(t={});var r=n.Util.extend(t,{method:"DELETE"});return this.fetch(e,r)},e}();t.GraphHttpClient=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(15),o=r(2),i=function(){function e(e,t,r){this.wrappedProvider=e,this.store=r||this.selectPnPCache(),this.cacheKey="_configcache_"+t}return e.prototype.getWrappedProvider=function(){return this.wrappedProvider},e.prototype.getConfiguration=function(){var e=this;if(!this.store||!this.store.enabled)return this.wrappedProvider.getConfiguration();var t=this.store.get(this.cacheKey);if(t)return new Promise(function(e){e(t)});var r=this.wrappedProvider.getConfiguration();return r.then(function(t){e.store.put(e.cacheKey,t)}),r},e.prototype.selectPnPCache=function(){var e=new n.PnPClientStorage;if(e.local&&e.local.enabled)return e.local;if(e.session&&e.session.enabled)return e.session;throw new o.NoCacheAvailableException},e}();t.default=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(51),o=r(7),i=r(52),s=r(53),a=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(o,i){function s(e){try{u(n.next(e))}catch(e){i(e)}}function a(e){try{u(n.throw(e))}catch(e){i(e)}}function u(e){e.done?o(e.value):new r(function(t){t(e.value)}).then(s,a)}u((n=n.apply(e,t||[])).next())})},u=this&&this.__generator||function(e,t){function r(e){return function(t){return n([e,t])}}function n(r){if(o)throw new TypeError("Generator is already executing.");for(;u;)try{if(o=1,i&&(s=2&r[0]?i.return:r[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,r[1])).done)return s;switch(i=0,s&&(r=[2&r[0],s.value]),r[0]){case 0:case 1:s=r;break;case 4:return u.label++,{value:r[1],done:!1};case 5:u.label++,i=r[1],r=[0];continue;case 7:r=u.ops.pop(),u.trys.pop();continue;default:if(s=u.trys,!(s=s.length>0&&s[s.length-1])&&(6===r[0]||2===r[0])){u=0;continue}if(3===r[0]&&(!s||r[1]>s[0]&&r[1]<s[3])){u.label=r[1];break}if(6===r[0]&&u.label<s[1]){u.label=s[1],s=r;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(r);break}s[2]&&u.ops.pop(),u.trys.pop();continue}r=t.call(e,u)}catch(e){r=[6,e],i=0}finally{o=s=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}var o,i,s,a,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return a={next:r(0),throw:r(1),return:r(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a},l=function(){function e(e,t,r,n){this._logSource=void 0,this._webURL=void 0,this._client=void 0,this.listName=void 0,this.response=[],this.currentViewFields=[],this.listFieldDetails=[],this.cisloZiadanky="",this._listOperations=void 0,this._commonOperations=void 0,this._fieldOperations=void 0,this._logSource=r,this._webURL=t,this._client=e,this.listName=n}return Object.defineProperty(e.prototype,"listOperations",{get:function(){return this._listOperations||(this._listOperations=new s.SPListOperations(this._client,this._webURL,this._logSource)),this._listOperations},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"commonOperations",{get:function(){return this._commonOperations||(this._commonOperations=new s.SPCommonOperations(this._client,this._webURL,this._logSource)),this._commonOperations},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fieldOperations",{get:function(){return this._fieldOperations||(this._fieldOperations=new s.SPFieldOperations(this._client,this._webURL,this._logSource)),this._fieldOperations},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"createSelectQuery",{get:function(){var e=[],t=[];return o.Log.verbose(this._logSource,"initiating query creation based on the current view fields..."),this.listFieldDetails.forEach(function(r){switch(r.TypeAsString){case"User":case"Person or Group":e.push(r.InternalName+"/Title"),t.push(r.InternalName);break;case"Lookup":e.push(r.InternalName+"/"+r.LookupField),t.push(r.InternalName);break;default:e.push(r.InternalName)}}),o.Log.verbose(this._logSource,"Query generated: ?$select="+e.join(",")+"&$expand="+t.join(",")),"?$select="+e.join(",")+"&$expand="+t.join(",")},enumerable:!0,configurable:!0}),e.prototype.createDocument=function(){return a(this,void 0,void 0,function(){var e,t;return u(this,function(r){switch(r.label){case 0:return o.Log.verbose(this._logSource,"initiating get of all items in the list..."),[4,this.getItems()];case 1:return e=r.sent(),[4,this.validateColumnTypes()];case 2:return r.sent()?(t=confirm("QnA format can be printed with the selected view. Do you want to proceed with the QnA format ?\n Press Ok to continue with QnA format, cancel to continue with List Format"),t?this.generateQnAFormat(e):this.generateTableFormat(e)):this.generateTableFormat(e),[2]}})})},e.prototype.getItems=function(){return a(this,void 0,void 0,function(){var e,t,r=this;return u(this,function(n){switch(n.label){case 0:e={ok:!0,result:[]},n.label=1;case 1:return n.trys.push([1,3,4,5]),[4,this.getAllItems()];case 2:return n.sent(),o.Log.verbose(this._logSource,"got all items."),o.Log.verbose(this._logSource,"collecting all items..."),this.response.forEach(function(t){t.ok?e.result=e.result.concat(t.result):o.Log.error(r.listOperations.LogSource,t.error)}),o.Log.verbose(this._logSource,"items collected with the count "+e.result.length),[3,5];case 3:return t=n.sent(),o.Log.error(this._logSource,new Error("Error in the method Convert2Doc.getItems()")),o.Log.error(this._logSource,t),[3,5];case 4:return[2,Promise.resolve(e)];case 5:return[2]}})})},e.prototype.getAllItems=function(e){return a(this,void 0,void 0,function(){var t,r,n,i,s;return u(this,function(a){switch(a.label){case 0:return a.trys.push([0,6,,7]),e?(o.Log.verbose(this._logSource,"getting the next set of 5000 records"),r=(t=this.response).push,[4,this.listOperations.getListItemsByNextLink(e)]):[3,2];case 1:return r.apply(t,[a.sent()]),o.Log.verbose(this._logSource,"response received"),[3,5];case 2:return o.Log.verbose(this._logSource,"retreiving all the fields for the current view..."),[4,this.getCurrentViewFields()];case 3:return a.sent(),o.Log.verbose(this._logSource,"all fields retreived"),o.Log.verbose(this._logSource,"getting the first set of 5000 records"),i=(n=this.response).push,[4,this.listOperations.getListItemsByQuery(this.listName,this.createSelectQuery+"&$top=5000")];case 4:i.apply(n,[a.sent()]),o.Log.verbose(this._logSource,"response received"),a.label=5;case 5:return this.response[this.response.length-1].nextLink&&this.getAllItems(this.response[this.response.length-1].nextLink),[3,7];case 6:return s=a.sent(),o.Log.error(this._logSource,new Error("Error in the method Convert2Doc.getAllItems()")),o.Log.error(this._logSource,s),[3,7];case 7:return[2]}})})},e.prototype.getCurrentViewFields=function(){return a(this,void 0,void 0,function(){var e,t,r,n,i,a,l,c=this;return u(this,function(u){switch(u.label){case 0:return u.trys.push([0,7,,8]),e=s.SPCore.getParameterValue(location.href,"viewid"),e?[4,this.commonOperations.queryGETResquest(this._webURL+"/_api/web/lists/getByTitle('"+this.listName+"')/Views('"+e+"')/ViewFields")]:[3,2];case 1:return t=u.sent(),this.currentViewFields=t.result.Items,[3,5];case 2:return[4,this.listOperations.getDefaultView(this.listName)];case 3:return r=u.sent(),[4,this.fieldOperations.getFieldsByView(this.listName,r.view.Title)];case 4:n=u.sent(),this.currentViewFields=n.details.Items,u.label=5;case 5:return[4,this.fieldOperations.getFieldsByList(this.listName)];case 6:return i=u.sent(),this.listFieldDetails=i.details.filter(function(e){return c.currentViewFields.indexOf(e.InternalName)>-1}),a=[],this.currentViewFields.forEach(function(e){a.push(c.listFieldDetails.filter(function(t){return t.InternalName==e})[0])}),this.listFieldDetails=a,[3,8];case 7:return l=u.sent(),o.Log.error(this._logSource,new Error("Error in the method Convert2Doc.getCurrentViewFields()")),o.Log.error(this._logSource,l),[3,8];case 8:return[2]}})})},e.prototype.validateColumnTypes=function(){return a(this,void 0,void 0,function(){var e,t,r;return u(this,function(n){return e=!1,t=!1,r=!1,o.Log.verbose(this._logSource,"Check if the QnA format cane be created from the current view ?"),this.listFieldDetails.forEach(function(r){switch(r.TypeDisplayName.toLowerCase()){case"single line of text":case"computed":e="Title"===r.Title;break;case"multiple lines of text":t="Answer"===r.Title}}),2==this.currentViewFields.length&&e&&t&&(r=!0),o.Log.verbose(this._logSource,r+", is the response"),[2,Promise.resolve(r)]})})},e.prototype.generateTableFormat=function(e){var t=this,r="<table>",n=0;e.result.forEach(function(e){r+='<tr style="height:30px"></tr>';var o=n%2==0;t.listFieldDetails.forEach(function(n){var i="";switch(console.log("vypisujem k:"+n),n.TypeAsString){case"User":case"Person or Group":i=e[n.InternalName].Title;break;case"Lookup":i=e[n.InternalName][n.LookupField];break;case"TaxonomyFieldType":i=e[n.InternalName].Label;break;case"URL":i='<a href="'+e[n.InternalName].Url+'" style="cursor:pointer;">'+e[n.InternalName].Description+"</a>";break;case"DateTime":i=new Date(e[n.InternalName]).toLocaleString();break;default:i=e[n.InternalName]}console.log("Cislo Žiadanky z table format"),t.cisloZiadanky=(new Date).getFullYear()+"/"+n.InternalName.ID.toString(),console.log(t.cisloZiadanky),r+='<tr style="background-color:'+(o?"#f3f3f3":"#ffffff")+'">',r+='<td style="width:30%; border:'+(o?"1px solid #ffffff":"1px solid #bcb7b7")+';">'+n.Title+"</td>",r+='<td style="width:70%;border:'+(o?"1px solid #ffffff":"1px solid #bcb7b7")+';">'+i+"</td>",r+="</tr>"}),n+=1}),r+="</table>",this.generateDocument(r,this.cisloZiadanky)},e.prototype.generateQnAFormat=function(e){var t=this,r="";e.result.forEach(function(e){t.currentViewFields.forEach(function(t){t.toLowerCase().indexOf("title")>-1?r+="<h3>"+e[t]+"</h3>":r+="<p>"+e[t]+"</p>"})}),this.generateDocument(r,this.cisloZiadanky)},e.prototype.generateDocument=function(e,t){var r="<html xmlns:o='urn:schemas-microsoft-com:office:office' xmlns:w='urn:schemas-microsoft-com:office:word' xmlns='http://www.w3.org/TR/REC-html40'>\n        <head><meta charset='utf-8'><title>"+this.listName+"</title></head><body>",e=(this.listName,r+'<div id="source-html">'+e+"</div></body>My Example</html>"),n="data:application/vnd.ms-word;charset=utf-8,"+encodeURIComponent(e);console.log("source"),console.log(n);var o=document.createElement("a");document.body.appendChild(o),o.href=n,o.download="Žiadanka/"+t+".doc",o.click(),document.body.removeChild(o)},e}(),c=r(33),p=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),d=this&&this.__decorate||function(e,t,r,n){var o,i=arguments.length,s=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,r,s):o(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s},f=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(o,i){function s(e){try{u(n.next(e))}catch(e){i(e)}}function a(e){try{u(n.throw(e))}catch(e){i(e)}}function u(e){e.done?o(e.value):new r(function(t){t(e.value)}).then(s,a)}u((n=n.apply(e,t||[])).next())})},h=this&&this.__generator||function(e,t){function r(e){return function(t){return n([e,t])}}function n(r){if(o)throw new TypeError("Generator is already executing.");for(;u;)try{if(o=1,i&&(s=2&r[0]?i.return:r[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,r[1])).done)return s;switch(i=0,s&&(r=[2&r[0],s.value]),r[0]){case 0:case 1:s=r;break;case 4:return u.label++,{value:r[1],done:!1};case 5:u.label++,i=r[1],r=[0];continue;case 7:r=u.ops.pop(),u.trys.pop();continue;default:if(s=u.trys,!(s=s.length>0&&s[s.length-1])&&(6===r[0]||2===r[0])){u=0;continue}if(3===r[0]&&(!s||r[1]>s[0]&&r[1]<s[3])){u.label=r[1];break}if(6===r[0]&&u.label<s[1]){u.label=s[1],s=r;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(r);break}s[2]&&u.ops.pop(),u.trys.pop();continue}r=t.call(e,u)}catch(e){r=[6,e],i=0}finally{o=s=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}var o,i,s,a,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return a={next:r(0),throw:r(1),return:r(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a},y=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return p(t,e),t.prototype.onInit=function(){return o.Log.info("Export2WordCommandSet","Initialized Export2WordCommandSet"),Promise.resolve()},t.prototype.onListViewUpdated=function(e){var t=this.tryGetCommand("Export2Word"),r=this.context.pageContext.list.title;t&&(t.visible=1===e.selectedRows.length&&"Denník dispečera"==r)},t.prototype.onExecute=function(e){switch(e.itemId){case"Export2Word":var t=new l(this.context.spHttpClient,this.context.pageContext.web.absoluteUrl,"Export2WordCommandSet",this.context.pageContext.list.title);0==e.selectedRows.length?t.createDocument():this.createDocumentSelectedItems(e,t);break;default:throw new Error("Unknown command")}},t.prototype.returnID=function(){return this.properties.ID.toString()},t.prototype.getUserProperties=function(){return f(this,void 0,void 0,function(){var e,t,r;return h(this,function(n){switch(n.label){case 0:return e="https://pozfond.sharepoint.com/sites/poolcars",t="",r="",[4,c.sp.profiles.myProperties.get().then(function(e){var r=e.UserProfileProperties,n={};console.log("Manazer"),console.log(t),console.log(r[14].Value),console.log(n),t+=r[14].Value,r.forEach(function(e){n[e.Key]=e.Value})})];case 1:return n.sent(),""==t?[3,3]:[4,c.sp.profiles.getPropertiesFor(t).then(function(e){r+=e.UserProfileProperties[4].Value+" "+e.UserProfileProperties[6].Value})];case 2:n.sent(),n.label=3;case 3:return[2,r]}})})},t.prototype.dateConvert=function(e){var t=e.split(". "),r=[t[0],t[1]],n=t[2].split(" ")[0],o=t[2].split(" ")[1].split(":");return new Date(Number(n),Number(r[1])-1,Number(r[0]),Number(o[0]),Number(o[1])).toLocaleString()},t.prototype.createDocumentSelectedItems=function(e,t){return f(this,void 0,void 0,function(){var r,n,o,i,s,a,u,l,c,p,d,f,y,g,b,m;return h(this,function(h){switch(h.label){case 0:return r="<table>",n=0,o=[],i="",s="",a="",u="",l=0,c="",p=[],d={},f="",y=0,g="",e.selectedRows.forEach(function(e){e.fields.forEach(function(t){e.getValue(t);d[t.internalName]=e.getValue(t),console.log(e.getValue(t)+": "+t.internalName)}),n+=1}),console.log(d),d.acColPosadka.length>0&&d.acColPosadka.forEach(function(e){i+=e.title+", "}),"Áno"==d.acColSpiatocnaCesta&&(s="a späť"),d.acColVodic.length>0&&d.acColVodic.forEach(function(e){a+=e.title+" "}),d.acColLookupVozidlo.length>0&&d.acColLookupVozidlo.forEach(function(e){u=e.lookupValue+" "}),b=new Date(this.dateConvert(d.acColDatumCasOd)),m=new Date(this.dateConvert(d.acColDatumCasDo)),c+=Math.floor((Number(m)-Number(b))/864e5),y+=(Number(m)-Number(b))/1e3%86400/3600%1,l+=0==y?(Number(m)-Number(b))/1e3%86400/3600:Number(((Number(m)-Number(b))/1e3%86400/3600).toFixed(2)),this.properties.ID=d.ID.toString(),g+=(new Date).getFullYear()+"/"+d.ID,Number(c)<1&&(c=""),[4,this.getUserProperties().then(function(e){f=e})];case 1:return h.sent(),console.log("nadriadeny"+f),console.log(c,l),r+='<table style="border-collapse:collapse;border:none;">\n    <tbody>\n        <tr>\n            <td colspan="2" rowspan="4" style="width: 145.25pt;border-width: 1.5pt 1.5pt 1pt;border-style: solid;border-color: windowtext;border-image: initial;padding: 0in 3.5pt;height: 17.1pt;vertical-align: top;">\n                <p style=\'margin:0in;margin-bottom:.0001pt;font-size:16px;font-family:"Times New Roman",serif;margin-top:2.0pt;\'><span style="font-size:11px;color:#C00000;">Organiz&aacute;cia (pečiatka)</span></p>\n                <p style=\'margin:0in;margin-bottom:.0001pt;font-size:16px;font-family:"Times New Roman",serif;margin-left:.25in;\'><span style="font-size:11px;color:#C00000;">&nbsp;</span></p>\n                <p style=\'margin:0in;margin-bottom:.0001pt;font-size:16px;font-family:"Times New Roman",serif;margin-left:.25in;\'><span style="font-size:11px;color:#C00000;">&nbsp;</span></p>\n                <p style=\'margin:0in;margin-bottom:.0001pt;font-size:16px;font-family:"Times New Roman",serif;margin-left:.25in;\'><span style="font-size:11px;color:#C00000;">&nbsp;</span></p>\n                <p style=\'margin:0in;margin-bottom:.0001pt;font-size:16px;font-family:"Times New Roman",serif;margin-left:.25in;\'><span style="font-size:11px;color:#C00000;">&nbsp;</span></p>\n                <p style=\'margin:0in;margin-bottom:.0001pt;font-size:16px;font-family:"Times New Roman",serif;margin-left:.25in;\'><span style="font-size:11px;color:#C00000;">&nbsp;</span></p>\n                <p style=\'margin:0in;margin-bottom:.0001pt;font-size:16px;font-family:"Times New Roman",serif;margin-top:3.0pt;\'><span style="font-size:11px;color:#C00000;">Žiadateľ &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><strong><span style="font-size:13px;">&nbsp;</span></strong></p>\n                <p style=\'margin:0in;margin-bottom:.0001pt;font-size:16px;font-family:"Times New Roman",serif;\'><strong><span style=\'font-size:15px;font-family:"Calibri",sans-serif;color:black;\'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; '+d.acColZiadatelOJ+' &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span></strong></p>\n            </td>\n            <td colspan="2" rowspan="3" style="width: 134.7pt;border-top: 1.5pt solid windowtext;border-right: 1.5pt solid windowtext;border-bottom: 1.5pt solid windowtext;border-image: initial;border-left: none;padding: 0in 3.5pt;height: 17.1pt;vertical-align: top;">\n                <p style=\'margin:0in;margin-bottom:.0001pt;font-size:16px;font-family:"Times New Roman",serif;text-align:center;\'><strong><span style="font-size:19px;color:#C00000;">ŽIADANKA</span></strong></p>\n                <p style=\'margin:0in;margin-bottom:.0001pt;font-size:16px;font-family:"Times New Roman",serif;text-align:center;\'><strong><span style="font-size:19px;color:#C00000;">na prepravu</span></strong></p>\n                <p style=\'margin:0in;margin-bottom:.0001pt;font-size:16px;font-family:"Times New Roman",serif;\'><strong><span style="color:#C00000;">&nbsp;</span></strong></p>\n                <p style=\'margin:0in;margin-bottom:.0001pt;font-size:16px;font-family:"Times New Roman",serif;\'><strong><span style="font-size:11px;">os&ocirc;b*</span></strong><span style="font-size:11px;color:#C00000;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <s>n&aacute;kladu*</s>)</span></p>\n            </td>\n            <td rowspan="2" style="width: 148.8pt;border-top: 1.5pt solid windowtext;border-left: none;border-bottom: 1pt solid windowtext;border-right: 1.5pt solid windowtext;padding: 0in 3.5pt;height: 17.1pt;vertical-align: top;">\n                <p style=\'margin:0in;margin-bottom:.0001pt;font-size:16px;font-family:"Times New Roman",serif;margin-top:2.0pt;\'><span style="font-size:11px;color:#C00000;">Č&iacute;slo objedn&aacute;vky žiadateľa</span></p>\n                <p style=\'margin:0in;margin-bottom:.0001pt;font-size:16px;font-family:"Times New Roman",serif;margin-top:2.0pt;\'><strong><em><span style="color:#C00000;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span></em></strong></p>\n            </td>\n            <td style="height:17.1pt;border:none;"><br></td>\n        </tr>\n        <tr>\n            <td style="height:14.2pt;border:none;"><br></td>\n        </tr>\n        <tr>\n            <td rowspan="2" style="width: 148.8pt;border-top: none;border-left: none;border-bottom: 1pt solid windowtext;border-right: 1.5pt solid windowtext;padding: 0in 3.5pt;height: 16.85pt;vertical-align: top;">\n                <p style=\'margin:0in;margin-bottom:.0001pt;font-size:16px;font-family:"Times New Roman",serif;margin-top:2.0pt;\'><span style="font-size:11px;color:#C00000;">Č&iacute;slo objedn&aacute;vky &uacute;tvaru</span></p>\n                <p style=\'margin:0in;margin-bottom:.0001pt;font-size:16px;font-family:"Times New Roman",serif;\'><span style="font-size:11px;color:#C00000;">dopravy</span></p>\n                <p style=\'margin:0in;margin-bottom:.0001pt;font-size:18px;font-family:"Times New Roman",serif;\'><strong>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; '+g+'</strong></p>\n                <p style=\'margin:0in;margin-bottom:.0001pt;font-size:16px;font-family:"Times New Roman",serif;\'><span style="font-size:11px;">&nbsp;</span></p>\n                <p style=\'margin:0in;margin-bottom:.0001pt;font-size:16px;font-family:"Times New Roman",serif;\'><span style="font-size:11px;color:#C00000;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span></p>\n            </td>\n            <td style="height:16.85pt;border:none;"><br></td>\n        </tr>\n        <tr>\n            <td colspan="2" style="width: 134.7pt;border-top: none;border-right: none;border-left: none;border-image: initial;border-bottom: 1pt solid windowtext;padding: 0in 3.5pt;height: 0.2in;vertical-align: bottom;">\n                <h2 style=\'margin:0in;margin-bottom:.0001pt;font-size:15px;font-family:"Times New Roman",serif;\'><span style="font-size:13px;color:#C00000;">&nbsp;</span></h2>\n            </td>\n            <td style="height:.2in;border:none;"><br></td>\n        </tr>\n        <tr>\n            <td colspan="5" style="width: 428.75pt;border-top: none;border-left: 1.5pt solid windowtext;border-bottom: 1pt solid windowtext;border-right: 1.5pt solid windowtext;padding: 0in 3.5pt;height: 23.7pt;vertical-align: bottom;">\n                <p style=\'margin:0in;margin-bottom:.0001pt;font-size:16px;font-family:"Times New Roman",serif;\'><span style="font-size:11px;color:#C00000;">Men&aacute; cestuj&uacute;cich*) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span style="font-size:12px;">'+i+'<span style="color:#C00000;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span></span></p>\n            </td>\n            <td style="height:23.7pt;border:none;"><br></td>\n        </tr>\n        <tr>\n            <td colspan="5" style="width: 428.75pt;border-top: none;border-left: 1.5pt solid windowtext;border-bottom: 1pt solid windowtext;border-right: 1.5pt solid windowtext;padding: 0in 3.5pt;height: 11.85pt;vertical-align: bottom;">\n                <p style=\'margin:0in;margin-bottom:.0001pt;font-size:16px;font-family:"Times New Roman",serif;\'><span style="font-size:11px;color:#C00000;">Druh, hmotnosť a rozmer n&aacute;kladu*) &nbsp;</span></p>\n                <p style=\'margin:0in;margin-bottom:.0001pt;font-size:16px;font-family:"Times New Roman",serif;margin-left:.25in;\'><strong><em><span style="font-size:15px;color:#C00000;">&nbsp;</span></em></strong></p>\n            </td>\n            <td style="height:11.85pt;border:none;"><br></td>\n        </tr>\n        <tr>\n            <td colspan="5" style="width: 428.75pt;border-top: none;border-left: 1.5pt solid windowtext;border-bottom: 1pt solid windowtext;border-right: 1.5pt solid windowtext;padding: 0in 3.5pt;height: 11.85pt;vertical-align: top;">\n                <p style=\'margin:0in;margin-bottom:.0001pt;font-size:16px;font-family:"Times New Roman",serif;margin-left:135.0pt;\'><strong><span style="font-size:13px;color:#C00000;">&nbsp;</span></strong></p>\n            </td>\n            <td style="height:11.85pt;border:none;"><br></td>\n        </tr>\n        <tr>\n            <td colspan="5" style="width: 428.75pt;border-top: none;border-left: 1.5pt solid windowtext;border-bottom: 1pt solid windowtext;border-right: 1.5pt solid windowtext;padding: 0in 3.5pt;height: 18.65pt;vertical-align: bottom;">\n                <p style=\'margin:0in;margin-bottom:.0001pt;font-size:16px;font-family:"Times New Roman",serif;\'><span style="font-size:11px;color:#C00000;">Deň, hodina a miesto pristavenia*) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><span style="font-size:19px;color:black;">'+b.getDate()+"."+(b.getMonth()+1)+".&nbsp;-&nbsp;"+m.getDate()+"."+(m.getMonth()+1)+"."+m.getFullYear()+'&nbsp;</span></p>\n            </td>\n            <td style="height:18.65pt;border:none;"><br></td>\n        </tr>\n        <tr>\n            <td colspan="5" style="width: 428.75pt;border-top: none;border-left: 1.5pt solid windowtext;border-bottom: 1pt solid windowtext;border-right: 1.5pt solid windowtext;padding: 0in 3.5pt;height: 11.85pt;vertical-align: bottom;">\n                <p style=\'margin:0in;margin-bottom:.0001pt;font-size:16px;font-family:"Times New Roman",serif;\'><span style="font-size:11px;color:#C00000;">Odkiaľ &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span style="font-size:15px;color:black;">'+d.acColOdkial+"-"+d.acColKam+" &nbsp;"+s+' &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span></p>\n            </td>\n            <td style="height:11.85pt;border:none;"><br></td>\n        </tr>\n        <tr>\n            <td colspan="5" style="width: 428.75pt;border-top: none;border-left: 1.5pt solid windowtext;border-bottom: 1pt solid windowtext;border-right: 1.5pt solid windowtext;padding: 0in 3.5pt;height: 11.85pt;vertical-align: bottom;">\n                <p style=\'margin:0in;margin-bottom:.0001pt;font-size:16px;font-family:"Times New Roman",serif;\'><span style="font-size:11px;color:#C00000;">Vodič sa hl&aacute;si u&nbsp;</span></p>\n            </td>\n            <td style="height:11.85pt;border:none;"><br></td>\n        </tr>\n        <tr>\n            <td colspan="5" style="width: 428.75pt;border-top: none;border-left: 1.5pt solid windowtext;border-bottom: 1pt solid windowtext;border-right: 1.5pt solid windowtext;padding: 0in 3.5pt;height: 11.85pt;vertical-align: bottom;">\n                <p style=\'margin:0in;margin-bottom:.0001pt;font-size:16px;font-family:"Times New Roman",serif;\'><span style="font-size:11px;color:#C00000;">Vozidlo je požadovan&eacute; na &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="font-size:13px;color:black;">'+l+'</span> &nbsp; &nbsp;hod&iacute;n</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<strong><span style="font-size:11px;">&nbsp; &nbsp; &nbsp;</span></strong><span style="font-size:11px;color:#C00000;"><span style="font-size:13px;color:black;">'+c+'</span>&nbsp; &nbsp; dni &nbsp;</span></p>\n                <p style=\'margin:0in;margin-bottom:.0001pt;font-size:16px;font-family:"Times New Roman",serif;margin-left:.25in;\'><span style="font-size:11px;color:#C00000;">&nbsp;</span></p>\n            </td>\n            <td style="height:11.85pt;border:none;"><br></td>\n        </tr>\n        <tr>\n            <td colspan="3" style="width: 185.35pt;border-top: none;border-left: 1.5pt solid windowtext;border-bottom: 1pt solid windowtext;border-right: 1pt solid windowtext;padding: 0in 3.5pt;height: 20.4pt;vertical-align: bottom;">\n                <p style=\'margin:0in;margin-bottom:.0001pt;font-size:16px;font-family:"Times New Roman",serif;\'><span style="font-size:11px;color:#C00000;">&Uacute;čel jazdy &nbsp;</span><span style="font-size:13px;color:black;">'+d.Title+',&nbsp;</span></p>\n            </td>\n            <td colspan="2" rowspan="2" style="width: 243.4pt;border-top: none;border-left: none;border-bottom: 1pt solid windowtext;border-right: 1.5pt solid windowtext;padding: 0in 3.5pt;height: 20.4pt;vertical-align: top;">\n                <h1 style=\'margin:0in;margin-bottom:.0001pt;text-align:center;font-size:21px;font-family:"Times New Roman",serif;font-weight:normal;\'><strong><span style="font-size:15px;color:#C00000;border:solid windowtext 1.0pt;padding:0in;background:white;">PR&Iacute;KAZ NA JAZDU</span></strong><span style="font-size:15px;color:#C00000;border:solid windowtext 1.0pt;padding:0in;background:white;">&nbsp; &nbsp;</span><span style="font-size:15px;color:#C00000;background:  white;">&nbsp;&nbsp;</span></h1>\n                <p style=\'margin:0in;margin-bottom:.0001pt;font-size:16px;font-family:"Times New Roman",serif;margin-top:4.0pt;\'><span style="font-size:11px;color:#C00000;">Meno vodiča &nbsp; &nbsp;&nbsp;</span><span style="color:black;">'+a+'</span></p>\n            </td>\n            <td style="height:20.4pt;border:none;"><br></td>\n        </tr>\n        <tr>\n            <td colspan="3" style="width: 185.35pt;border-top: none;border-left: 1.5pt solid windowtext;border-bottom: 1pt solid windowtext;border-right: 1pt solid windowtext;padding: 0in 3.5pt;height: 27.8pt;vertical-align: bottom;">\n                <p style=\'margin:0in;margin-bottom:.0001pt;font-size:16px;font-family:"Times New Roman",serif;\'><span style="font-size:11px;color:#C00000;">Vy&uacute;čtuje na vrub &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><strong><span style="font-size:15px;">OKa&Scaron;Č</span></strong></p>\n            </td>\n            <td style="height:27.8pt;border:none;"><br></td>\n        </tr>\n        <tr>\n            <td colspan="3" rowspan="2" style="width: 185.35pt;border-top: none;border-left: 1.5pt solid windowtext;border-bottom: 1pt solid windowtext;border-right: 1pt solid windowtext;padding: 0in 3.5pt;height: 11.85pt;vertical-align: top;">\n                <p style=\'margin:0in;margin-bottom:.0001pt;font-size:16px;font-family:"Times New Roman",serif;margin-top:2.0pt;\'><span style="font-size:11px;color:#C00000;">Pozn&aacute;mka žiadateľa :&nbsp;</span><span style="font-size:13px;color:black;">'+d.acColPoznamka+',&nbsp;</span></p></p>\n            </td>\n            <td colspan="2" style="width: 243.4pt;border-top: none;border-left: none;border-bottom: 1pt solid windowtext;border-right: 1.5pt solid windowtext;padding: 0in 3.5pt;height: 11.85pt;vertical-align: bottom;">\n                <p style=\'margin:0in;margin-bottom:.0001pt;font-size:16px;font-family:"Times New Roman",serif;\'><span style="font-size:11px;color:#C00000;">Druh vozidla &nbsp; &nbsp;&nbsp;</span><span style="font-size:11px;color:black;">'+d.Vozidlo_x003a_Druh_x0020_vozidla+'</span></p>\n            </td>\n            <td style="height:11.85pt;border:none;"><br></td>\n        </tr>\n        <tr>\n            <td colspan="2" style="width: 243.4pt;border-top: none;border-left: none;border-bottom: 1pt solid windowtext;border-right: 1.5pt solid windowtext;padding: 0in 3.5pt;height: 11.85pt;vertical-align: bottom;">\n                <p style=\'margin:0in;margin-bottom:.0001pt;font-size:16px;font-family:"Times New Roman",serif;\'><span style="font-size:11px;color:#C00000;">&Scaron;PZ &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><strong><span style="font-size:13px;">'+u+'</span></strong></p>\n            </td>\n            <td style="height:11.85pt;border:none;"><br></td>\n        </tr>\n        <tr>\n            <td style="width: 92.45pt;border-top: none;border-left: 1.5pt solid windowtext;border-bottom: 1.5pt solid windowtext;border-right: 1pt solid windowtext;padding: 0in 3.5pt;height: 47.25pt;vertical-align: top;">\n                <p style=\'margin:0in;margin-bottom:.0001pt;font-size:16px;font-family:"Times New Roman",serif;\'><span style="font-size:11px;color:#C00000;">D&aacute;tum a podpis&nbsp;</span></p>\n                <p style=\'margin:0in;margin-bottom:.0001pt;font-size:16px;font-family:"Times New Roman",serif;\'><span style="font-size:11px;color:#C00000;">žiadateľa &nbsp;&nbsp;</span></p>\n                <p style=\'margin:0in;margin-bottom:.0001pt;font-size:16px;font-family:"Times New Roman",serif;\'><strong><span style="font-size:11px;">'+f+'</span></strong></p>\n                <p style=\'margin:0in;margin-bottom:.0001pt;font-size:16px;font-family:"Times New Roman",serif;\'><strong><span style="font-size:11px;">'+b.getDate()+"."+(b.getMonth()+1)+"."+b.getFullYear()+'</span></strong></p>\n            </td>\n            <td colspan="2" style="width: 92.9pt;border-top: none;border-left: none;border-bottom: 1.5pt solid windowtext;border-right: 1pt solid windowtext;padding: 0in 3.5pt;height: 47.25pt;vertical-align: top;">\n                <p style=\'margin:0in;margin-bottom:.0001pt;font-size:16px;font-family:"Times New Roman",serif;\'><span style="font-size:11px;color:#C00000;">D&aacute;tum a&nbsp;podpis</span></p>\n                <p style=\'margin:0in;margin-bottom:.0001pt;font-size:16px;font-family:"Times New Roman",serif;\'><span style="font-size:11px;color:#C00000;">schvaľuj&uacute;ceho</span></p>\n                <p style=\'margin:0in;margin-bottom:.0001pt;font-size:16px;font-family:"Times New Roman",serif;\'><strong><span style="font-size:11px;">Ing. Puchelov&aacute;</span></strong></p>\n                <p style=\'margin:0in;margin-bottom:.0001pt;font-size:16px;font-family:"Times New Roman",serif;\'><strong><span style="font-size:11px;">'+b.getDate()+"."+(b.getMonth()+1)+"."+b.getFullYear()+'</span></strong></p>\n            </td>\n            <td colspan="2" style="width: 243.4pt;border-top: none;border-left: none;border-bottom: 1.5pt solid windowtext;border-right: 1.5pt solid windowtext;padding: 0in 3.5pt;height: 47.25pt;vertical-align: top;">\n                <p style=\'margin:0in;margin-bottom:.0001pt;font-size:16px;font-family:"Times New Roman",serif;\'><span style="font-size:11px;color:#C00000;">D&aacute;tum a podpis osoby zodpovednej</span></p>\n                <p style=\'margin:0in;margin-bottom:.0001pt;font-size:16px;font-family:"Times New Roman",serif;\'><span style="font-size:11px;color:#C00000;">za autoprev&aacute;dzku</span></p>\n                <p style=\'margin:0in;margin-bottom:.0001pt;font-size:16px;font-family:"Times New Roman",serif;\'><strong><span style="font-size:11px;">Peter &Scaron;tetina</span></strong></p>\n                <p style=\'margin:0in;margin-bottom:.0001pt;font-size:16px;font-family:"Times New Roman",serif;\'><strong><span style="font-size:11px;">'+b.getDate()+"."+(b.getMonth()+1)+"."+b.getFullYear()+'</span></strong></p>\n            </td>\n            <td style="height:47.25pt;border:none;"><br></td>\n        </tr>\n    </tbody>\n</table>',console.log("cisloZiadanky - return"),console.log(this.returnID()),[4,t.generateDocument(r,g)];case 2:return h.sent(),[2]}})})},d([n.override],t.prototype,"onInit",null),d([n.override],t.prototype,"onListViewUpdated",null),d([n.override],t.prototype,"onExecute",null),t}(i.BaseListViewCommandSet);t.default=y},function(e,r){e.exports=t},function(e,t){e.exports=r},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(54);t.SPCommonOperations=n.SPCommonOperations;var o=r(56);t.SPFieldOperations=o.SPFieldOperations;var i=r(14);t.SPCore=i.SPCore;var s=r(57);t.SPListOperations=s.SPListOperations;var a=r(32);t.FieldScope=a.FieldScope,t.FieldType=a.FieldType;var u=r(58);t.BaseTemplate=u.BaseTemplate},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),o=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(o,i){function s(e){try{u(n.next(e))}catch(e){i(e)}}function a(e){try{u(n.throw(e))}catch(e){i(e)}}function u(e){e.done?o(e.value):new r(function(t){t(e.value)}).then(s,a)}u((n=n.apply(e,t||[])).next())})},i=this&&this.__generator||function(e,t){function r(e){return function(t){return n([e,t])}}function n(r){if(o)throw new TypeError("Generator is already executing.");for(;u;)try{if(o=1,i&&(s=i[2&r[0]?"return":r[0]?"throw":"next"])&&!(s=s.call(i,r[1])).done)return s;switch(i=0,s&&(r=[0,s.value]),r[0]){case 0:case 1:s=r;break;case 4:return u.label++,{value:r[1],done:!1};case 5:u.label++,i=r[1],r=[0];continue;case 7:r=u.ops.pop(),u.trys.pop();continue;default:if(s=u.trys,!(s=s.length>0&&s[s.length-1])&&(6===r[0]||2===r[0])){u=0;continue}if(3===r[0]&&(!s||r[1]>s[0]&&r[1]<s[3])){u.label=r[1];break}if(6===r[0]&&u.label<s[1]){u.label=s[1],s=r;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(r);break}s[2]&&u.ops.pop(),u.trys.pop();continue}r=t.call(e,u)}catch(e){r=[6,e],i=0}finally{o=s=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}var o,i,s,a,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return a={next:r(0),throw:r(1),return:r(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a};Object.defineProperty(t,"__esModule",{value:!0});var s=r(21),a=r(7),u=function(e){function t(t,r,n){return e.call(this,t,r,n)||this}return n(t,e),t.getInstance=function(e,r,n){return new t(e,r,n)},t.prototype.getDocIconByFiles=function(e){return o(this,void 0,void 0,function(){var t,r,n,o,s,u=this;return i(this,function(i){switch(i.label){case 0:t=[],r=[],i.label=1;case 1:return i.trys.push([1,3,4,5]),e.forEach(function(e){var r=e.slice(e.lastIndexOf("."));-1==t.indexOf(r)&&t.push(r)}),n=[],t.forEach(function(e){var t=u.WebUrl+"/_api/web/maptoicon(filename='abc"+e+"', progid='', size='3')";n.push(u.spQueryGET(t))}),[4,Promise.all(n)];case 2:return o=i.sent(),e.forEach(function(e){var n=e.slice(e.lastIndexOf(".")),i=t.indexOf(n),s=o[i];r.push({error:s.error,fileName:e,imageUrl:s.error?void 0:"/_layouts/15/images/"+s.result.value,ok:s.ok})}),[3,5];case 3:return s=i.sent(),a.Log.error(this.LogSource,new Error("Error occured in SPCommonOperations.getDocIconByFiles")),a.Log.error(this.LogSource,s),r=[{error:s,imageUrl:void 0,fileName:void 0,ok:!1}],[3,5];case 4:return[2,Promise.resolve(r)];case 5:return[2]}})})},t.prototype.queryGETResquest=function(e){return o(this,void 0,void 0,function(){return i(this,function(t){switch(t.label){case 0:return[4,this.spQueryGET(e)];case 1:return[2,t.sent()]}})})},t.prototype.queryPOSTRequest=function(e){return o(this,void 0,void 0,function(){return i(this,function(t){switch(t.label){case 0:return[4,this.spQueryPOST(e)];case 1:return[2,t.sent()]}})})},t.prototype.queryMERGERequest=function(e){return o(this,void 0,void 0,function(){return i(this,function(t){switch(t.label){case 0:return[4,this.spQueryMERGE(e)];case 1:return[2,t.sent()]}})})},t.prototype.queryPATCHRequest=function(e){return o(this,void 0,void 0,function(){return i(this,function(t){switch(t.label){case 0:return[4,this.spQueryPATCH(e)];case 1:return[2,t.sent()]}})})},t}(s.SPBase);t.SPCommonOperations=u},function(e,t){e.exports=n},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),o=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(o,i){function s(e){try{u(n.next(e))}catch(e){i(e)}}function a(e){try{u(n.throw(e))}catch(e){i(e)}}function u(e){e.done?o(e.value):new r(function(t){t(e.value)}).then(s,a)}u((n=n.apply(e,t||[])).next())})},i=this&&this.__generator||function(e,t){function r(e){return function(t){return n([e,t])}}function n(r){if(o)throw new TypeError("Generator is already executing.");for(;u;)try{if(o=1,i&&(s=i[2&r[0]?"return":r[0]?"throw":"next"])&&!(s=s.call(i,r[1])).done)return s;switch(i=0,s&&(r=[0,s.value]),r[0]){case 0:case 1:s=r;break;case 4:return u.label++,{value:r[1],done:!1};case 5:u.label++,i=r[1],r=[0];continue;case 7:r=u.ops.pop(),u.trys.pop();continue;default:if(s=u.trys,!(s=s.length>0&&s[s.length-1])&&(6===r[0]||2===r[0])){u=0;continue}if(3===r[0]&&(!s||r[1]>s[0]&&r[1]<s[3])){u.label=r[1];break}if(6===r[0]&&u.label<s[1]){u.label=s[1],s=r;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(r);break}s[2]&&u.ops.pop(),u.trys.pop();continue}r=t.call(e,u)}catch(e){r=[6,e],i=0}finally{o=s=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}var o,i,s,a,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return a={next:r(0),throw:r(1),return:r(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a};Object.defineProperty(t,"__esModule",{value:!0});var s=r(21),a=r(14),u=r(32),l=r(7),c="SPFieldOperations",p=function(e){function t(t,r,n){return e.call(this,t,r,n)||this}return n(t,e),t.getInstance=function(e,r,n){return new t(e,r,n)},t.prototype.addFieldToView=function(e,t,r){return o(this,void 0,void 0,function(){var n,o,s,a;return i(this,function(i){switch(i.label){case 0:return i.trys.push([0,4,5,6]),[4,this.isFieldInView(e,t,r)];case 1:return(o=i.sent())?[3,3]:(s=this.WebUrl+"/_api/web/lists/getByTitle('"+e+"')/views/getByTitle('"+t+"')/ViewFields/addviewfield('"+r+"')",[4,this.spQueryPOST({body:void 0,url:s})]);case 2:n=i.sent(),i.label=3;case 3:return[3,6];case 4:return a=i.sent(),l.Log.error(this.LogSource,new Error("Error occured in "+c+".addFieldToView")),l.Log.error(this.LogSource,a),n={ok:!1,error:a},[3,6];case 5:return[2,Promise.resolve(n)];case 6:return[2]}})})},t.prototype.isFieldInView=function(e,t,r){return o(this,void 0,void 0,function(){var n,o,s;return i(this,function(i){switch(i.label){case 0:n=!1,i.label=1;case 1:return i.trys.push([1,3,4,5]),[4,this.getFieldsByView(e,t)];case 2:return o=i.sent(),o.ok&&(n=o.result.Items.indexOf(r)>-1),[3,5];case 3:return s=i.sent(),l.Log.error(this.LogSource,new Error("Error occured in "+c+".isFieldInView")),l.Log.error(this.LogSource,s),[3,5];case 4:return[2,Promise.resolve(n)];case 5:return[2]}})})},t.prototype.getFieldsByView=function(e,t){return o(this,void 0,void 0,function(){var r,n,o,s;return i(this,function(i){switch(i.label){case 0:r={ok:!1},i.label=1;case 1:return i.trys.push([1,3,4,5]),n=this.WebUrl+"/_api/web/lists/getByTitle('"+e+"')/views/getByTitle('"+t+"')/ViewFields/",[4,this.spQueryGET(n)];case 2:return o=i.sent(),r={ok:o.ok,details:o.result,error:o.error},[3,5];case 3:return s=i.sent(),l.Log.error(this.LogSource,new Error("Error occured in "+c+".getFieldsByView")),l.Log.error(this.LogSource,s),r={ok:!1,error:s},[3,5];case 4:return[2,Promise.resolve(r)];case 5:return[2]}})})},t.prototype.getFieldsByList=function(e){return o(this,void 0,void 0,function(){var t,r,n,o;return i(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,3,4]),r=this.WebUrl+"/_api/web/lists/getByTitle('"+e+"')/fields/",[4,this.spQueryGET(r)];case 1:return n=i.sent(),t={details:n.result.value?n.result.value:n.result,ok:n.ok,error:n.error},[3,4];case 2:return o=i.sent(),l.Log.error(this.LogSource,new Error("Error occured in "+c+".getFieldsByList")),l.Log.error(this.LogSource,o),t={ok:!1,error:o},[3,4];case 3:return[2,Promise.resolve(t)];case 4:return[2]}})})},t.prototype.getFieldByList=function(e,t){return o(this,void 0,void 0,function(){var r,n,o,s;return i(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,3,4]),n=this.WebUrl+"/_api/web/lists/getByTitle('"+t+"')/fields?&$filter=Title eq '"+e+"'",[4,this.spQueryGET(n)];case 1:return o=i.sent(),r=o.ok&&o.result.value&&o.result.value.length>0?{ok:!0,detail:o.result.value[0],error:void 0}:{ok:o.ok,error:o.ok?new Error("Could not find the field with the specified title '"+e+"' in the list"):o.error},[3,4];case 2:return s=i.sent(),l.Log.error(this.LogSource,new Error("Error occured in "+c+".getFieldByList")),l.Log.error(this.LogSource,s),r={ok:!1,error:s},[3,4];case 3:return[2,Promise.resolve(r)];case 4:return[2]}})})},t.prototype.addSiteColumnToList=function(e,t){return o(this,void 0,void 0,function(){var r,n,o,s,a,u;return i(this,function(i){switch(i.label){case 0:return i.trys.push([0,4,5,6]),[4,this.getFieldBySite(e)];case 1:return n=i.sent(),n.ok?(o=this.WebUrl+"/_api/web/lists/getByTitle('"+t+"')/fields/createfieldasxml",s=JSON.stringify({parameters:{__metadata:{type:"SP.XmlSchemaFieldCreationInformation"},Options:8,SchemaXml:n.detail.SchemaXml}}),[4,this.spQueryPOST({body:s,url:o})]):[3,3];case 2:a=i.sent(),r={ok:a.ok,error:a.error,detail:a.result},i.label=3;case 3:return[3,6];case 4:return u=i.sent(),l.Log.error(this.LogSource,new Error("Error occured in "+c+".addSiteColumnToList")),l.Log.error(this.LogSource,u),r={ok:!1,error:u,detail:void 0},[3,6];case 5:return[2,Promise.resolve(r)];case 6:return[2]}})})},t.prototype.createSiteColumn=function(e){return o(this,void 0,void 0,function(){var t,r,n,o;return i(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,3,4]),r=this.WebUrl+"/_api/web/fields/"+(e.fieldType==u.FieldType.Lookup?"addfield":""),[4,this.spQueryPOST({body:this.getColumnMetadata(e,u.FieldScope.SiteColumn),url:r})];case 1:return n=i.sent(),t={ok:n.ok,error:n.error,detail:n.result},[3,4];case 2:return o=i.sent(),l.Log.error(this.LogSource,new Error("Error occured in "+c+".createSiteColumn")),l.Log.error(this.LogSource,o),t={ok:!1,error:o},[3,4];case 3:return[2,Promise.resolve(t)];case 4:return[2]}})})},t.prototype.getFieldBySite=function(e){return o(this,void 0,void 0,function(){var t,r,n,o;return i(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,3,4]),r=this.WebUrl+"/_api/web/fields?$filter=Title eq '"+e+"'",[4,this.spQueryGET(r)];case 1:return n=i.sent(),t=n.ok&&n.result.value&&n.result.value.length>0?{ok:!0,detail:n.result.value[0],error:void 0}:{ok:n.ok,error:n.ok?new Error("Could not find the field with the specified title '"+e+"' in the site"):n.error},[3,4];case 2:return o=i.sent(),l.Log.error(this.LogSource,new Error("Error occured in "+c+".getFieldBySite")),l.Log.error(this.LogSource,o),t={ok:!1,error:o},[3,4];case 3:return[2,Promise.resolve(t)];case 4:return[2]}})})},t.prototype.getColumnMetadata=function(e,t){var r;switch(e.allowMultiValues=!a.SPCore.isNull(e.allowMultiValues)&&e.allowMultiValues,e.fieldType){case u.FieldType.MultiChoice:var n="'"+e.choices.join("','")+"'";e.defaultValue=a.SPCore.isEmptyString(e.defaultValue)?e.choices[0]:e.defaultValue,r="{ '__metadata': { 'type': 'SP.FieldMultiChoice' }, 'FieldTypeKind': 15, 'DefaultValue': '"+e.defaultValue+"', {COLUMNGROUP}, 'Required': "+e.isRequired+", 'Title': '"+e.title+"', 'Choices': { '__metadata': { 'type': 'Collection(Edm.String)' }, 'results': ["+n+"] }, 'EditFormat': 0 }";break;case u.FieldType.Choice:var o="'"+e.choices.join("','")+"'";e.defaultValue=a.SPCore.isEmptyString(e.defaultValue)?e.choices[0]:e.defaultValue,r="{ '__metadata': { 'type': 'SP.FieldChoice' }, 'FieldTypeKind': 6, 'DefaultValue': '"+e.defaultValue+"', {COLUMNGROUP} 'Required':  "+e.isRequired+", 'Title': '"+e.title+"', 'Choices': { '__metadata': { 'type': 'Collection(Edm.String)' }, 'results': ["+o+"] }, 'EditFormat': 0 }";break;case u.FieldType.Number:r="{ '__metadata': { 'type': 'SP.FieldNumber' }, 'FieldTypeKind': 9, {COLUMNGROUP} 'Required':  "+e.isRequired+", 'Title': '"+e.title+"'";break;case u.FieldType.Lookup:r="{ 'parameters': { '__metadata': { 'type': 'SP.FieldCreationInformation' }, 'FieldTypeKind': 7, {COLUMNGROUP} 'Required':  "+e.isRequired+", 'Title': '"+e.title+"', 'LookupListId': '"+e.lookupListID+"', 'LookupFieldName': '"+e.lookupColName+"' }}";break;case u.FieldType.Note:r="{ '__metadata': { 'type': 'SP.FieldMultiLineText' }, 'FieldTypeKind': 3,{COLUMNGROUP} 'Required':  "+e.isRequired+", 'Title': '"+e.title+"', 'NumberOfLines': 12, 'RichText': true, 'AllowHyperlink' : true, 'RestrictedMode': true}";break;case u.FieldType.Text:r="{ '__metadata': { 'type': 'SP.Field' }, 'FieldTypeKind': 2, {COLUMNGROUP} 'Required':  "+e.isRequired+", 'Title': '"+e.title+"'}";break;case u.FieldType.User:r="{ '__metadata': { 'type': 'SP.FieldUser' }, 'FieldTypeKind': 20, {COLUMNGROUP} 'Required':  "+e.isRequired+", 'Title': '"+e.title+"', 'SelectionMode': 0, 'Presence': true}";break;case u.FieldType.Boolean:case u.FieldType.DateTime:}return r=t==u.FieldScope.ListColumn?r.replace("{COLUMNGROUP}",""):r.replace("{COLUMNGROUP}","'Group': '"+e.group+"',")},t.prototype.createListColumn=function(e){return o(this,void 0,void 0,function(){var t,r,n,o;return i(this,function(i){switch(i.label){case 0:return i.trys.push([0,4,5,6]),r=this.WebUrl+"/_api/web/lists/getByTitle('"+e.listName+"')/fields/"+(e.fieldType==u.FieldType.Lookup?"addfield":""),[4,this.spQueryPOST({body:this.getColumnMetadata(e,u.FieldScope.ListColumn),url:r})];case 1:return n=i.sent(),!e.addToView||a.SPCore.isEmptyString(e.viewName)||a.SPCore.isEmptyString(e.listName)?[3,3]:[4,this.addFieldToView(e.listName,e.viewName,n.result.InternalName)];case 2:i.sent(),i.label=3;case 3:return t={ok:n.ok,error:n.error,detail:n.result},[3,6];case 4:return o=i.sent(),l.Log.error(this.LogSource,new Error("Error occured in "+c+".createListColumn")),l.Log.error(this.LogSource,o),t={ok:!1,error:o},[3,6];case 5:return[2,Promise.resolve(t)];case 6:return[2]}})})},t}(s.SPBase);t.SPFieldOperations=p},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),o=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(o,i){function s(e){try{u(n.next(e))}catch(e){i(e)}}function a(e){try{u(n.throw(e))}catch(e){i(e)}}function u(e){e.done?o(e.value):new r(function(t){t(e.value)}).then(s,a)}u((n=n.apply(e,t||[])).next())})},i=this&&this.__generator||function(e,t){function r(e){return function(t){return n([e,t])}}function n(r){if(o)throw new TypeError("Generator is already executing.");for(;u;)try{if(o=1,i&&(s=i[2&r[0]?"return":r[0]?"throw":"next"])&&!(s=s.call(i,r[1])).done)return s;switch(i=0,s&&(r=[0,s.value]),r[0]){case 0:case 1:s=r;break;case 4:return u.label++,{value:r[1],done:!1};case 5:u.label++,i=r[1],r=[0];continue;case 7:r=u.ops.pop(),u.trys.pop();continue;default:if(s=u.trys,!(s=s.length>0&&s[s.length-1])&&(6===r[0]||2===r[0])){u=0;continue}if(3===r[0]&&(!s||r[1]>s[0]&&r[1]<s[3])){u.label=r[1];break}if(6===r[0]&&u.label<s[1]){u.label=s[1],s=r;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(r);break}s[2]&&u.ops.pop(),u.trys.pop();continue}r=t.call(e,u)}catch(e){r=[6,e],i=0}finally{o=s=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}var o,i,s,a,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return a={next:r(0),throw:r(1),return:r(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a};Object.defineProperty(t,"__esModule",{value:!0});var s=r(21),a=r(7),u=r(14),l="SPListOperations",c=function(e){function t(t,r,n){return e.call(this,t,r,n)||this}return n(t,e),t.getInstance=function(e,r,n){return new t(e,r,n)},t.prototype.getListByTitle=function(e){return o(this,void 0,void 0,function(){var t,r,n,o;return i(this,function(i){switch(i.label){case 0:if(u.SPCore.isEmptyString(e))return[2,Promise.resolve({exists:!1,ok:!1,error:new Error("List Title cannot be blank")})];i.label=1;case 1:return i.trys.push([1,3,4,5]),r=this.WebUrl+"/_api/web/lists/getByTitle('"+e+"')",[4,this.spQueryGET(r)];case 2:return n=i.sent(),t=n.ok?{exists:!!n.result,ok:!0,details:n.result}:{exists:!1,ok:!1,error:n.error},[3,5];case 3:return o=i.sent(),a.Log.error(this.LogSource,new Error("Error occured in "+l+".getListByTitle")),a.Log.error(this.LogSource,o),t={exists:!1,ok:!1,error:o},[3,5];case 4:return[2,Promise.resolve(t)];case 5:return[2]}})})},t.prototype.createList=function(e){return o(this,void 0,void 0,function(){var t,r,n,o;return i(this,function(i){switch(i.label){case 0:if(!e)return[2,Promise.resolve({exists:!1,ok:!1,error:new Error("List detail object cannot be null")})];i.label=1;case 1:return i.trys.push([1,6,7,8]),a.Log.verbose(this.LogSource,"Check if the list with the same title exists"),[4,this.getListByTitle(e.title)];case 2:return r=i.sent(),r.exists&&r.details.BaseTemplate===e.baseTemplate?(a.Log.verbose(this.LogSource,"List exists with same title and base template, so not created new"),t=r,[3,5]):[3,3];case 3:return[4,this.spQueryPOST(this.getListMetadata(e))];case 4:n=i.sent(),t=n.ok?{ok:!0,exists:!0,details:n.result}:{exists:!1,ok:!1,error:n.error},i.label=5;case 5:return[3,8];case 6:return o=i.sent(),a.Log.error(this.LogSource,new Error("Error occured in "+l+".createList")),a.Log.error(this.LogSource,o),t={exists:!1,ok:!1,error:o},[3,8];case 7:return[2,Promise.resolve(t)];case 8:return[2]}})})},t.prototype.getListItemsByQuery=function(e,t){return o(this,void 0,void 0,function(){return i(this,function(r){switch(r.label){case 0:return[4,this.getListItemsBase(e,t)];case 1:return[2,r.sent()]}})})},t.prototype.getListItemsByNextLink=function(e){return o(this,void 0,void 0,function(){var t,r,n;return i(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,3,4]),[4,this.spQueryGET(e)];case 1:return r=o.sent(),t=r.ok?{ok:!0,result:r.result.value,nextLink:r.result["odata.nextLink"]?r.result["odata.nextLink"]:void 0}:{ok:!1,error:r.error},[3,4];case 2:return n=o.sent(),a.Log.error(this.LogSource,new Error("Error occured in "+l+".getListItemsByNextLink")),a.Log.error(this.LogSource,n),t={ok:!1,error:n},[3,4];case 3:return[2,Promise.resolve(t)];case 4:return[2]}})})},t.prototype.getListItemsBase=function(e,t){return o(this,void 0,void 0,function(){var r,n,o,s;return i(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,3,4]),n=this.WebUrl+"/_api/web/lists/getByTitle('"+e+"')/Items",n=u.SPCore.isEmptyString(t)?n:""+n+t,[4,this.spQueryGET(n)];case 1:return o=i.sent(),r=o.ok?{ok:!0,result:o.result.value,nextLink:o.result["odata.nextLink"]?o.result["odata.nextLink"]:void 0}:{ok:!1,error:o.error},[3,4];case 2:return s=i.sent(),a.Log.error(this.LogSource,new Error("Error occured in "+l+".getListItemsBase")),a.Log.error(this.LogSource,s),r={ok:!1,error:s},[3,4];case 3:return[2,Promise.resolve(r)];case 4:return[2]}})})},t.prototype.getListItemByID=function(e,t){return o(this,void 0,void 0,function(){var r,n,o,s;return i(this,function(i){switch(i.label){case 0:r={ok:!1},i.label=1;case 1:return i.trys.push([1,3,4,5]),n=this.WebUrl+"/_api/web/lists/getByTitle('"+e+"')/Items("+t+")",[4,this.spQueryGET(n)];case 2:return o=i.sent(),r=o.ok?{ok:!0,result:o.result}:{ok:!1,error:o.error},[3,5];case 3:return s=i.sent(),a.Log.error(this.LogSource,new Error("Error occured in "+l+".getListItemByID")),a.Log.error(this.LogSource,s),r={ok:!1,error:s},[3,5];case 4:return[2,Promise.resolve(r)];case 5:return[2]}})})},t.prototype.getListItems=function(e,t){return o(this,void 0,void 0,function(){var r;return i(this,function(n){switch(n.label){case 0:return r=t&&t>0?"?$top="+t:void 0,[4,this.getListItemsBase(e,r)];case 1:return[2,n.sent()]}})})},t.prototype.getLibraryItemsBase=function(e,t){return o(this,void 0,void 0,function(){var r,n,o,s;return i(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,3,4]),n=this.WebUrl+"/_api/web/lists/getByTitle('"+e+"')/Files",n=u.SPCore.isEmptyString(t)?n:""+n+t,[4,this.spQueryGET(n)];case 1:return o=i.sent(),r=o.ok?{ok:!0,result:o.result.value,nextLink:o.result["odata.nextLink"]?o.result["odata.nextLink"]:void 0}:{ok:!1,error:o.error},[3,4];case 2:return s=i.sent(),a.Log.error(this.LogSource,new Error("Error occured in "+l+".getLibraryItemsBase")),a.Log.error(this.LogSource,s),r={ok:!1,error:s},[3,4];case 3:return[2,Promise.resolve(r)];case 4:return[2]}})})},t.prototype.getLibraryItemByFileID=function(e,t){return o(this,void 0,void 0,function(){var r,n,o,s;return i(this,function(i){switch(i.label){case 0:r={ok:!1},i.label=1;case 1:return i.trys.push([1,3,4,5]),n=this.WebUrl+"/_api/web/lists/getByTitle('"+e+"')/Files('"+t+"')",[4,this.spQueryGET(n)];case 2:return o=i.sent(),r=o.ok?{ok:!0,result:o.result}:{ok:!1,error:o.error},[3,5];case 3:return s=i.sent(),a.Log.error(this.LogSource,new Error("Error occured in "+l+".getLibraryItemByFileID")),a.Log.error(this.LogSource,s),r={ok:!1,error:s},[3,5];case 4:return[2,Promise.resolve(r)];case 5:return[2]}})})},t.prototype.getLibraryItems=function(e,t){return o(this,void 0,void 0,function(){var r;return i(this,function(n){switch(n.label){case 0:return r=t&&t>0?"?$top="+t:void 0,[4,this.getLibraryItemsBase(e,r)];case 1:return[2,n.sent()]}})})},t.prototype.createListItem=function(e,t){return o(this,void 0,void 0,function(){var r,n,o,s,u;return i(this,function(i){switch(i.label){case 0:r={ok:!1},i.label=1;case 1:return i.trys.push([1,6,7,8]),[4,this.getListByTitle(e)];case 2:return n=i.sent(),n.exists?(o={__metadata:{type:""+n.details.ListItemEntityTypeFullName}},t.forEach(function(e){o[""+e.fieldName]=e.fieldValue}),[4,this.spQueryPOST({body:JSON.stringify(o),url:this.WebUrl+"/_api/web/lists/getByTitle('"+e+"')/items"})]):[3,4];case 3:return s=i.sent(),r={ok:s.ok,error:s.error,result:s.result},[3,5];case 4:r.error=n.error,r.ok=n.ok,i.label=5;case 5:return[3,8];case 6:return u=i.sent(),a.Log.error(this.LogSource,new Error("Error occured in "+l+".createListItem")),a.Log.error(this.LogSource,u),r.error=u,[3,8];case 7:return[2,Promise.resolve(r)];case 8:return[2]}})})},t.prototype.createFolderInDocLib=function(e,t){return o(this,void 0,void 0,function(){var r,n,o;return i(this,function(i){switch(i.label){case 0:r={ok:!1},i.label=1;case 1:return i.trys.push([1,3,4,5]),[4,this.spQueryPOST({body:void 0,url:this.WebUrl+"/_api/web/folders/add('"+e+"/"+t+"')"})];case 2:return n=i.sent(),r={error:n.error,ok:n.ok,result:n.result},[3,5];case 3:return o=i.sent(),a.Log.error(this.LogSource,new Error("Error occured in "+l+".createFolderInDocLib")),a.Log.error(this.LogSource,o),r.error=o,[3,5];case 4:return[2,Promise.resolve(r)];case 5:return[2]}})})},t.prototype.createFolderInList=function(e,t){return o(this,void 0,void 0,function(){var r,n,o,s,u;return i(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,3,4]),n=[{fieldName:"Title",fieldValue:""+t},{fieldName:"FileLeafRef",fieldValue:""+t},{fieldName:"FileSystemObjectType",fieldValue:"1"},{fieldName:"ContentTypeId",fieldValue:"0x0120"}],[4,this.createListItem(e,n)];case 1:return r=i.sent(),r.ok&&(o=JSON.stringify({__metadata:{type:""+r.result["odata.type"]},Title:""+t,FileLeafRef:""+t}),s=this.WebUrl+"/_api/web/lists/getByTitle('"+e+"')/items("+r.result.Id+")",this.spQueryPATCH({body:o,url:s})),[3,4];case 2:return u=i.sent(),a.Log.error(this.LogSource,new Error("Error occured in "+l+".createFolderInList")),a.Log.error(this.LogSource,u),r={ok:!1,error:u},[3,4];case 3:return[2,Promise.resolve(r)];case 4:return[2]}})})},t.prototype.updateListItem=function(e,t,r){return o(this,void 0,void 0,function(){var n,o,s,u,c;return i(this,function(i){switch(i.label){case 0:n={ok:!1},i.label=1;case 1:return i.trys.push([1,5,6,7]),[4,this.getListByTitle(e)];case 2:return o=i.sent(),o.exists?(s={__metadata:{type:""+o.details.ListItemEntityTypeFullName}},r.forEach(function(e){s[""+e.fieldName]=e.fieldValue}),[4,this.spQueryMERGE({body:JSON.stringify(s),url:this.WebUrl+"/_api/web/lists/getByTitle('"+e+"')/items("+t+")"})]):[3,4];case 3:u=i.sent(),n={ok:u.ok,error:u.error,result:u.result},i.label=4;case 4:return[3,7];case 5:return c=i.sent(),a.Log.error(this.LogSource,new Error("Error occured in "+l+".updateListItem")),a.Log.error(this.LogSource,c),n.error=c,[3,7];case 6:return[2,Promise.resolve(n)];case 7:return[2]}})})},t.prototype.getListMetadata=function(e){return{body:"{ '__metadata': { 'type': 'SP.List' }, 'BaseTemplate': "+e.baseTemplate+",'EnableFolderCreation': "+e.allowFolder+", 'ContentTypesEnabled': "+e.allowContentTypes+", 'AllowContentTypes': "+e.allowContentTypes+", 'Description': '"+e.description+"', 'Title':'"+e.title+"'}",url:this.WebUrl+"/_api/web/lists"}},t.prototype.getListsDetailsByBaseTemplateID=function(e){return o(this,void 0,void 0,function(){var t;return i(this,function(r){switch(r.label){case 0:return t=this.WebUrl+"/_api/web/lists?$filter=BaseTemplate eq "+e,[4,this.spQueryGET(t)];case 1:return[2,r.sent()]}})})},t.prototype.getViewsByList=function(e){return o(this,void 0,void 0,function(){var t,r,n,o;return i(this,function(i){switch(i.label){case 0:t={ok:!1},i.label=1;case 1:return i.trys.push([1,3,4,5]),r=this.WebUrl+"/_api/web/lists/getByTitle('"+e+"')/views/",[4,this.spQueryGET(r)];case 2:return n=i.sent(),t=n.ok?{ok:!0,views:n.result.value}:{ok:!1,error:n.error},[3,5];case 3:return o=i.sent(),a.Log.error(this.LogSource,new Error("Error occured in "+l+".getViewsByList")),a.Log.error(this.LogSource,o),t={ok:!1,error:o},[3,5];case 4:return[2,Promise.resolve(t)];case 5:return[2]}})})},t.prototype.getDefaultView=function(e){return o(this,void 0,void 0,function(){var t,r,n,o;return i(this,function(i){switch(i.label){case 0:t={ok:!1},i.label=1;case 1:return i.trys.push([1,3,4,5]),r=this.WebUrl+"/_api/web/lists/getByTitle('"+e+"')/views?$filter=DefaultView eq true",[4,this.spQueryGET(r)];case 2:return n=i.sent(),t=n.ok?{ok:!0,view:n.result.value[0]}:{ok:!1,error:n.error},[3,5];case 3:return o=i.sent(),a.Log.error(this.LogSource,new Error("Error occured in "+l+".getDefaultView")),a.Log.error(this.LogSource,o),t={ok:!1,error:o},[3,5];case 4:return[2,Promise.resolve(t)];case 5:return[2]}})})},t.prototype.getContentTypesByList=function(e){return o(this,void 0,void 0,function(){var t;return i(this,function(r){switch(r.label){case 0:return t=this.WebUrl+"/_api/web/lists/getByTitle('"+e+"')/contentTypes/",[4,this.spQueryGET(t)];case 1:return[2,r.sent()]}})})},t}(s.SPBase);t.SPListOperations=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;!function(e){e[e.GenericList=100]="GenericList",e[e.DocumentLibrary=101]="DocumentLibrary",e[e.PictureLibrary=109]="PictureLibrary"}(n||(n={})),t.BaseTemplate=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(10),o=function(){function e(){this._settings=new n.Dictionary}return e.prototype.add=function(e,t){this._settings.add(e,t)},e.prototype.addJSON=function(e,t){this._settings.add(e,JSON.stringify(t))},e.prototype.apply=function(e){var t=this;return new Promise(function(r,n){try{t._settings.merge(e),r()}catch(e){n(e)}})},e.prototype.load=function(e){var t=this;return new Promise(function(r,n){e.getConfiguration().then(function(e){t._settings.merge(e),r()}).catch(function(e){n(e)})})},e.prototype.get=function(e){return this._settings.get(e)},e.prototype.getJSON=function(e){var t=this.get(e);return void 0===t||null===t?t:JSON.parse(t)},e}();t.Settings=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(36),o=r(38),i=r(39),s=r(12),a=r(0),u=r(68),l=r(46),c=r(30),p=r(2),d=r(47),f=function(){function e(e,t){void 0===e&&(e={}),void 0===t&&(t=""),this._options=e,this._baseUrl=t}return e.prototype.configure=function(t,r){return void 0===r&&(r=""),new e(t,r)},e.prototype.searchSuggest=function(e){var t;return t="string"==typeof e?{querytext:e}:e,new o.SearchSuggest(this._baseUrl).configure(this._options).execute(t)},e.prototype.search=function(e){var t;return t="string"==typeof e?{Querytext:e}:e instanceof n.SearchQueryBuilder?e.toSearchQuery():e,new n.Search(this._baseUrl).configure(this._options).execute(t)},Object.defineProperty(e.prototype,"site",{get:function(){return new i.Site(this._baseUrl).configure(this._options)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"web",{get:function(){return new s.Web(this._baseUrl).configure(this._options)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"profiles",{get:function(){return new u.UserProfileQuery(this._baseUrl).configure(this._options)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"social",{get:function(){return new l.SocialQuery(this._baseUrl).configure(this._options)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"navigation",{get:function(){return new c.NavigationService},enumerable:!0,configurable:!0}),e.prototype.createBatch=function(){return this.web.createBatch()},Object.defineProperty(e.prototype,"utility",{get:function(){return new d.UtilityMethod(this._baseUrl,"").configure(this._options)},enumerable:!0,configurable:!0}),e.prototype.crossDomainSite=function(e,t){return this._cdImpl(i.Site,e,t,"site")},e.prototype.crossDomainWeb=function(e,t){return this._cdImpl(s.Web,e,t,"web")},e.prototype._cdImpl=function(e,t,r,n){if(!a.Util.isUrlAbsolute(t))throw new p.UrlException("The addInWebUrl parameter must be an absolute url.");if(!a.Util.isUrlAbsolute(r))throw new p.UrlException("The hostWebUrl parameter must be an absolute url.");var o=a.Util.combinePaths(t,"_api/SP.AppContextSite(@target)"),i=new e(o,n);return i.query.add("@target","'"+encodeURIComponent(r)+"'"),i.configure(this._options)},e}();t.SPRest=f},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(10),o=r(0),i=r(8),s=r(4),a=function(){function e(){}return e}();t.CachedDigest=a;var u=new n.Dictionary,l=function(){function e(e,t){void 0===t&&(t=u),this._httpClient=e,this._digests=t}return e.prototype.getDigest=function(e){var t=this,r=this._digests.get(e);if(null!==r){if(new Date<r.expiration)return Promise.resolve(r.value)}var n=o.Util.combinePaths(e,"/_api/contextinfo"),u={Accept:"application/json;odata=verbose","Content-Type":"application/json;odata=verbose;charset=utf-8"};return this._httpClient.fetchRaw(n,{cache:"no-cache",credentials:"same-origin",headers:o.Util.extend(u,s.RuntimeConfig.spHeaders,!0),method:"POST"}).then(function(e){return(new i.ODataDefaultParser).parse(e).then(function(e){return e.GetContextWebInformation})}).then(function(r){var n=new a;n.value=r.FormDigestValue;var o=r.FormDigestTimeoutSeconds,i=new Date;return i.setTime(i.getTime()+1e3*o),n.expiration=i,t._digests.add(e,n),n.value})},e.prototype.clear=function(){this._digests.clear()},e}();t.DigestCache=l},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=r(1),i=r(8),s=function(e){function t(t,r){return void 0===r&&(r="AttachmentFiles"),e.call(this,t,r)||this}return n(t,e),t.prototype.getByName=function(e){var t=new a(this);return t.concat("('"+e+"')"),t},t.prototype.add=function(e,r){var n=this;return this.clone(t,"add(FileName='"+e+"')",!1).postCore({body:r}).then(function(t){return{data:t,file:n.getByName(e)}})},t.prototype.addMultiple=function(e){var r=this;return e.reduce(function(e,n){return e.then(function(){return r.clone(t,"add(FileName='"+n.name+"')",!1).postCore({body:n.content})})},Promise.resolve())},t.prototype.deleteMultiple=function(){for(var e=this,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return t.reduce(function(t,r){return t.then(function(){return e.getByName(r).delete()})},Promise.resolve())},t.prototype.recycleMultiple=function(){for(var e=this,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return t.reduce(function(t,r){return t.then(function(){return e.getByName(r).recycle()})},Promise.resolve())},t}(o.SharePointQueryableCollection);t.AttachmentFiles=s;var a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.getText=function(){return this.clone(t,"$value",!1).get(new i.TextFileParser)},t.prototype.getBlob=function(){return this.clone(t,"$value",!1).get(new i.BlobFileParser)},t.prototype.getBuffer=function(){return this.clone(t,"$value",!1).get(new i.BufferFileParser)},t.prototype.getJSON=function(){return this.clone(t,"$value",!1).get(new i.JSONFileParser)},t.prototype.setContent=function(e){var r=this;return this.clone(t,"$value",!1).postCore({body:e,headers:{"X-HTTP-Method":"PUT"}}).then(function(e){return new t(r)})},t.prototype.delete=function(e){return void 0===e&&(e="*"),this.postCore({headers:{"IF-Match":e,"X-HTTP-Method":"DELETE"}})},t.prototype.recycle=function(e){return void 0===e&&(e="*"),this.clone(t,"recycleObject").postCore({headers:{"IF-Match":e,"X-HTTP-Method":"DELETE"}})},t}(o.SharePointQueryableInstance);t.AttachmentFile=a},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=r(1),i=r(0),s=function(e){function t(t,r){return void 0===r&&(r="views"),e.call(this,t,r)||this}return n(t,e),t.prototype.getById=function(e){var t=new a(this);return t.concat("('"+e+"')"),t},t.prototype.getByTitle=function(e){return new a(this,"getByTitle('"+e+"')")},t.prototype.add=function(e,r,n){var o=this;void 0===r&&(r=!1),void 0===n&&(n={});var s=JSON.stringify(i.Util.extend({PersonalView:r,Title:e,__metadata:{type:"SP.View"}},n));return this.clone(t,null).postAsCore({body:s}).then(function(e){return{data:e,view:o.getById(e.Id)}})},t}(o.SharePointQueryableCollection);t.Views=s;var a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),Object.defineProperty(t.prototype,"fields",{get:function(){return new u(this)},enumerable:!0,configurable:!0}),t.prototype.update=function(e){var t=this,r=JSON.stringify(i.Util.extend({__metadata:{type:"SP.View"}},e));return this.postCore({body:r,headers:{"X-HTTP-Method":"MERGE"}}).then(function(e){return{data:e,view:t}})},t.prototype.delete=function(){return this.postCore({headers:{"X-HTTP-Method":"DELETE"}})},t.prototype.renderAsHtml=function(){return this.clone(o.SharePointQueryable,"renderashtml").get()},t}(o.SharePointQueryableInstance);t.View=a;var u=function(e){function t(t,r){return void 0===r&&(r="viewfields"),e.call(this,t,r)||this}return n(t,e),t.prototype.getSchemaXml=function(){return this.clone(o.SharePointQueryable,"schemaxml").get()},t.prototype.add=function(e){return this.clone(t,"addviewfield('"+e+"')").postCore()},t.prototype.move=function(e,r){return this.clone(t,"moveviewfieldto").postCore({body:JSON.stringify({field:e,index:r})})},t.prototype.removeAll=function(){return this.clone(t,"removeallviewfields").postCore()},t.prototype.remove=function(e){return this.clone(t,"removeviewfield('"+e+"')").postCore()},t}(o.SharePointQueryableCollection);t.ViewFields=u},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=r(1),i=function(e){function t(t,r){return void 0===r&&(r="forms"),e.call(this,t,r)||this}return n(t,e),t.prototype.getById=function(e){var t=new s(this);return t.concat("('"+e+"')"),t},t}(o.SharePointQueryableCollection);t.Forms=i;var s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t}(o.SharePointQueryableInstance);t.Form=s},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=r(1),i=function(e){function t(t,r){return void 0===r&&(r="subscriptions"),e.call(this,t,r)||this}return n(t,e),t.prototype.getById=function(e){var t=new s(this);return t.concat("('"+e+"')"),t},t.prototype.add=function(e,t,r){var n=this,o=JSON.stringify({clientState:r||"pnp-js-core-subscription",expirationDateTime:t,notificationUrl:e,resource:this.toUrl()});return this.postCore({body:o,headers:{"Content-Type":"application/json"}}).then(function(e){return{data:e,subscription:n.getById(e.id)}})},t}(o.SharePointQueryableCollection);t.Subscriptions=i;var s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.update=function(e){var t=this,r=JSON.stringify({expirationDateTime:e});return this.patchCore({body:r,headers:{"Content-Type":"application/json"}}).then(function(e){return{data:e,subscription:t}})},t.prototype.delete=function(){return e.prototype.deleteCore.call(this)},t}(o.SharePointQueryableInstance);t.Subscription=s},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=r(1),i=r(3),s=r(0),a=function(e){function t(t,r){return void 0===r&&(r="regionalsettings"),e.call(this,t,r)||this}return n(t,e),Object.defineProperty(t.prototype,"installedLanguages",{get:function(){return new u(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"globalInstalledLanguages",{get:function(){return new u(this,"globalinstalledlanguages")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"timeZone",{get:function(){return new l(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"timeZones",{get:function(){return new c(this)},enumerable:!0,configurable:!0}),t}(o.SharePointQueryableInstance);t.RegionalSettings=a;var u=function(e){function t(t,r){return void 0===r&&(r="installedlanguages"),e.call(this,t,r)||this}return n(t,e),t}(o.SharePointQueryableCollection);t.InstalledLanguages=u;var l=function(e){function t(t,r){return void 0===r&&(r="timezone"),e.call(this,t,r)||this}return n(t,e),t.prototype.utcToLocalTime=function(e){var r;return r="string"==typeof e?e:e.toISOString(),this.clone(t,"utctolocaltime('"+r+"')").postCore().then(function(e){return e.hasOwnProperty("UTCToLocalTime")?e.UTCToLocalTime:e})},t.prototype.localTimeToUTC=function(e){var r;return r="string"==typeof e?e:s.Util.dateAdd(e,"minute",-1*e.getTimezoneOffset()).toISOString(),this.clone(t,"localtimetoutc('"+r+"')").postCore().then(function(e){return e.hasOwnProperty("LocalTimeToUTC")?e.LocalTimeToUTC:e})},t}(o.SharePointQueryableInstance);t.TimeZone=l;var c=function(e){function t(t,r){return void 0===r&&(r="timezones"),e.call(this,t,r)||this}return n(t,e),t.prototype.getById=function(e){return this.clone(t,"GetById("+e+")").postAsCore({},i.spODataEntity(l))},t}(o.SharePointQueryableCollection);t.TimeZones=c},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=r(1),i=function(e){function t(t,r){return void 0===r&&(r="_api/SP.RelatedItemManager"),e.call(this,t,r)||this}return n(t,e),t.FromUrl=function(e){if(null===e)return new t("");var r=e.indexOf("_api/");return new t(r>-1?e.substr(0,r):e)},t.prototype.getRelatedItems=function(e,r){var n=this.clone(t,null);return n.concat(".GetRelatedItems"),n.postCore({body:JSON.stringify({SourceItemID:r,SourceListName:e})})},t.prototype.getPageOneRelatedItems=function(e,r){var n=this.clone(t,null);return n.concat(".GetPageOneRelatedItems"),n.postCore({body:JSON.stringify({SourceItemID:r,SourceListName:e})})},t.prototype.addSingleLink=function(e,r,n,o,i,s,a){void 0===a&&(a=!1);var u=this.clone(t,null);return u.concat(".AddSingleLink"),u.postCore({body:JSON.stringify({SourceItemID:r,SourceListName:e,SourceWebUrl:n,TargetItemID:i,TargetListName:o,TargetWebUrl:s,TryAddReverseLink:a})})},t.prototype.addSingleLinkToUrl=function(e,r,n,o){void 0===o&&(o=!1);var i=this.clone(t,null);return i.concat(".AddSingleLinkToUrl"),i.postCore({body:JSON.stringify({SourceItemID:r,SourceListName:e,TargetItemUrl:n,TryAddReverseLink:o})})},t.prototype.addSingleLinkFromUrl=function(e,r,n,o){void 0===o&&(o=!1);var i=this.clone(t,null);return i.concat(".AddSingleLinkFromUrl"),i.postCore({body:JSON.stringify({SourceItemUrl:e,TargetItemID:n,TargetListName:r,TryAddReverseLink:o})})},t.prototype.deleteSingleLink=function(e,r,n,o,i,s,a){void 0===a&&(a=!1);var u=this.clone(t,null);return u.concat(".DeleteSingleLink"),u.postCore({body:JSON.stringify({SourceItemID:r,SourceListName:e,SourceWebUrl:n,TargetItemID:i,TargetListName:o,TargetWebUrl:s,TryDeleteReverseLink:a})})},t}(o.SharePointQueryable);t.RelatedItemManagerImpl=i},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=r(1),i=r(69),s=r(0),a=r(8),u=function(e){function t(t,r){void 0===r&&(r="_api/sp.userprofiles.peoplemanager");var n=e.call(this,t,r)||this;return n.clientPeoplePickerQuery=new c(t),n.profileLoader=new l(t),n}return n(t,e),Object.defineProperty(t.prototype,"editProfileLink",{get:function(){return this.clone(t,"EditProfileLink").getAs(a.ODataValue())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isMyPeopleListPublic",{get:function(){return this.clone(t,"IsMyPeopleListPublic").getAs(a.ODataValue())},enumerable:!0,configurable:!0}),t.prototype.amIFollowedBy=function(e){var r=this.clone(t,"amifollowedby(@v)");return r.query.add("@v","'"+encodeURIComponent(e)+"'"),r.get()},t.prototype.amIFollowing=function(e){var r=this.clone(t,"amifollowing(@v)");return r.query.add("@v","'"+encodeURIComponent(e)+"'"),r.get()},t.prototype.getFollowedTags=function(e){return void 0===e&&(e=20),this.clone(t,"getfollowedtags("+e+")").get()},t.prototype.getFollowersFor=function(e){var r=this.clone(t,"getfollowersfor(@v)");return r.query.add("@v","'"+encodeURIComponent(e)+"'"),r.get()},Object.defineProperty(t.prototype,"myFollowers",{get:function(){return new o.SharePointQueryableCollection(this,"getmyfollowers")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"myProperties",{get:function(){return new t(this,"getmyproperties")},enumerable:!0,configurable:!0}),t.prototype.getPeopleFollowedBy=function(e){var r=this.clone(t,"getpeoplefollowedby(@v)");return r.query.add("@v","'"+encodeURIComponent(e)+"'"),r.get()},t.prototype.getPropertiesFor=function(e){var r=this.clone(t,"getpropertiesfor(@v)");return r.query.add("@v","'"+encodeURIComponent(e)+"'"),r.get()},Object.defineProperty(t.prototype,"trendingTags",{get:function(){var e=this.clone(t,null);return e.concat(".gettrendingtags"),e.get()},enumerable:!0,configurable:!0}),t.prototype.getUserProfilePropertyFor=function(e,r){var n=this.clone(t,"getuserprofilepropertyfor(accountname=@v, propertyname='"+r+"')");return n.query.add("@v","'"+encodeURIComponent(e)+"'"),n.get()},t.prototype.hideSuggestion=function(e){var r=this.clone(t,"hidesuggestion(@v)");return r.query.add("@v","'"+encodeURIComponent(e)+"'"),r.postCore()},t.prototype.isFollowing=function(e,r){var n=this.clone(t,null);return n.concat(".isfollowing(possiblefolloweraccountname=@v, possiblefolloweeaccountname=@y)"),n.query.add("@v","'"+encodeURIComponent(e)+"'"),n.query.add("@y","'"+encodeURIComponent(r)+"'"),n.get()},t.prototype.setMyProfilePic=function(e){var r=this;return new Promise(function(n,o){i.readBlobAsArrayBuffer(e).then(function(e){new t(r,"setmyprofilepicture").postCore({body:String.fromCharCode.apply(null,new Uint16Array(e))}).then(function(e){return n()})}).catch(function(e){return o(e)})})},t.prototype.setSingleValueProfileProperty=function(e,r,n){var o=JSON.stringify({accountName:e,propertyName:r,propertyValue:n});return this.clone(t,"SetSingleValueProfileProperty").postCore({body:o})},t.prototype.setMultiValuedProfileProperty=function(e,r,n){var o=JSON.stringify({accountName:e,propertyName:r,propertyValues:n});return this.clone(t,"SetMultiValuedProfileProperty").postCore({body:o})},t.prototype.createPersonalSiteEnqueueBulk=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.profileLoader.createPersonalSiteEnqueueBulk(e)},Object.defineProperty(t.prototype,"ownerUserProfile",{get:function(){return this.profileLoader.ownerUserProfile},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"userProfile",{get:function(){return this.profileLoader.userProfile},enumerable:!0,configurable:!0}),t.prototype.createPersonalSite=function(e){return void 0===e&&(e=!1),this.profileLoader.createPersonalSite(e)},t.prototype.shareAllSocialData=function(e){return this.profileLoader.shareAllSocialData(e)},t.prototype.clientPeoplePickerResolveUser=function(e){return this.clientPeoplePickerQuery.clientPeoplePickerResolveUser(e)},t.prototype.clientPeoplePickerSearchUser=function(e){return this.clientPeoplePickerQuery.clientPeoplePickerSearchUser(e)},t}(o.SharePointQueryableInstance);t.UserProfileQuery=u;var l=function(e){function t(t,r){return void 0===r&&(r="_api/sp.userprofiles.profileloader.getprofileloader"),e.call(this,t,r)||this}return n(t,e),t.prototype.createPersonalSiteEnqueueBulk=function(e){return this.clone(t,"createpersonalsiteenqueuebulk",!1).postCore({body:JSON.stringify({emailIDs:e})})},Object.defineProperty(t.prototype,"ownerUserProfile",{get:function(){var e=this.getParent(t,this.parentUrl,"_api/sp.userprofiles.profileloader.getowneruserprofile");return this.hasBatch&&(e=e.inBatch(this.batch)),e.postAsCore()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"userProfile",{get:function(){return this.clone(t,"getuserprofile").postAsCore()},enumerable:!0,configurable:!0}),t.prototype.createPersonalSite=function(e){return void 0===e&&(e=!1),this.clone(t,"getuserprofile/createpersonalsiteenque("+e+")").postCore()},t.prototype.shareAllSocialData=function(e){return this.clone(t,"getuserprofile/shareallsocialdata("+e+")").postCore()},t}(o.SharePointQueryable),c=function(e){function t(t,r){return void 0===r&&(r="_api/sp.ui.applicationpages.clientpeoplepickerwebserviceinterface"),e.call(this,t,r)||this}return n(t,e),t.prototype.clientPeoplePickerResolveUser=function(e){var r=this.clone(t,null);return r.concat(".clientpeoplepickerresolveuser"),r.postAsCore({body:this.createClientPeoplePickerQueryParametersRequestBody(e)}).then(function(e){return JSON.parse(e)})},t.prototype.clientPeoplePickerSearchUser=function(e){var r=this.clone(t,null);return r.concat(".clientpeoplepickersearchuser"),r.postAsCore({body:this.createClientPeoplePickerQueryParametersRequestBody(e)}).then(function(e){return JSON.parse(e)})},t.prototype.createClientPeoplePickerQueryParametersRequestBody=function(e){return JSON.stringify({queryParams:s.Util.extend({__metadata:{type:"SP.UI.ApplicationPages.ClientPeoplePickerQueryParameters"}},e)})},t}(o.SharePointQueryable)},function(e,t,r){"use strict";function n(e){return i(e,"string")}function o(e){return i(e,"buffer")}function i(e,t){return new Promise(function(r,n){try{var o=new FileReader;switch(o.onload=function(e){r(e.target.result)},t){case"string":o.readAsText(e);break;case"buffer":o.readAsArrayBuffer(e)}}catch(e){n(e)}})}Object.defineProperty(t,"__esModule",{value:!0}),t.readBlobAsText=n,t.readBlobAsArrayBuffer=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(71),o=function(){function e(){}return Object.defineProperty(e.prototype,"v1",{get:function(){return new n.V1("")},enumerable:!0,configurable:!0}),e}();t.GraphRest=o},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=r(6),i=r(72),s=function(e){function t(t,r){return void 0===r&&(r="v1.0"),e.call(this,t,r)||this}return n(t,e),Object.defineProperty(t.prototype,"groups",{get:function(){return new i.Groups(this)},enumerable:!0,configurable:!0}),t}(o.GraphQueryable);t.V1=s},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var o,i=r(6),s=r(73),a=r(0),u=r(74),l=r(75),c=r(77),p=r(78);!function(e){e[e.Office365=0]="Office365",e[e.Dynamic=1]="Dynamic",e[e.Security=2]="Security"}(o=t.GroupType||(t.GroupType={}));var d=function(e){function t(t,r){return void 0===r&&(r="groups"),e.call(this,t,r)||this}return n(t,e),t.prototype.getById=function(e){return new f(this,e)},t.prototype.add=function(e,t,r,n){var i=this;void 0===n&&(n={});var s=a.Util.extend({displayName:e,mailEnabled:r===o.Office365,mailNickname:t,securityEnabled:r!==o.Office365},n);return r!==o.Security&&(s=a.Util.extend(s,{groupTypes:[r===o.Office365?"Unified":"DynamicMembership"]})),this.postCore({body:JSON.stringify(s)}).then(function(e){return{data:e,group:i.getById(e.id)}})},t}(i.GraphQueryableCollection);t.Groups=d;var f=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),Object.defineProperty(t.prototype,"caldendar",{get:function(){return new u.Calendar(this,"calendar")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"events",{get:function(){return new u.Events(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"owners",{get:function(){return new s.Owners(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"plans",{get:function(){return new c.Plans(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"members",{get:function(){return new s.Members(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"conversations",{get:function(){return new l.Conversations(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"acceptedSenders",{get:function(){return new l.Senders(this,"acceptedsenders")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rejectedSenders",{get:function(){return new l.Senders(this,"rejectedsenders")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"photo",{get:function(){return new p.Photo(this)},enumerable:!0,configurable:!0}),t.prototype.addFavorite=function(){return this.clone(t,"addFavorite").postCore()},t.prototype.getMemberGroups=function(e){return void 0===e&&(e=!1),this.clone(t,"getMemberGroups").postCore({body:JSON.stringify({securityEnabledOnly:e})})},t.prototype.delete=function(){return this.deleteCore()},t.prototype.update=function(e){return this.patchCore({body:JSON.stringify(e)})},t.prototype.removeFavorite=function(){return this.clone(t,"removeFavorite").postCore()},t.prototype.resetUnseenCount=function(){return this.clone(t,"resetUnseenCount").postCore()},t.prototype.subscribeByMail=function(){return this.clone(t,"subscribeByMail").postCore()},t.prototype.unsubscribeByMail=function(){return this.clone(t,"unsubscribeByMail").postCore()},t.prototype.getCalendarView=function(e,r){var n=this.clone(t,"calendarView");return n.query.add("startDateTime",e.toISOString()),n.query.add("endDateTime",r.toISOString()),n.get()},t}(i.GraphQueryableInstance);t.Group=f},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=r(6),i=function(e){function t(t,r){return void 0===r&&(r="members"),e.call(this,t,r)||this}return n(t,e),t.prototype.add=function(e){return this.clone(t,"$ref").postCore({body:JSON.stringify({"@odata.id":e})})},t.prototype.getById=function(e){return new s(this,e)},t}(o.GraphQueryableCollection);t.Members=i;var s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t}(o.GraphQueryableInstance);t.Member=s;var a=function(e){function t(t,r){return void 0===r&&(r="owners"),e.call(this,t,r)||this}return n(t,e),t}(i);t.Owners=a},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=r(6),i=function(e){function t(t,r){return void 0===r&&(r="calendars"),e.call(this,t,r)||this}return n(t,e),t}(o.GraphQueryableCollection);t.Calendars=i;var s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),Object.defineProperty(t.prototype,"events",{get:function(){return new a(this)},enumerable:!0,configurable:!0}),t}(o.GraphQueryableInstance);t.Calendar=s;var a=function(e){function t(t,r){return void 0===r&&(r="events"),e.call(this,t,r)||this}return n(t,e),t.prototype.getById=function(e){return new u(this,e)},t.prototype.add=function(e){var t=this;return this.postCore({body:JSON.stringify(e)}).then(function(e){return{data:e,event:t.getById(e.id)}})},t}(o.GraphQueryableCollection);t.Events=a;var u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.update=function(e){return this.patchCore({body:JSON.stringify(e)})},t.prototype.delete=function(){return this.deleteCore()},t}(o.GraphQueryableInstance);t.Event=u},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=r(6),i=r(76),s=function(e){function t(t,r){return void 0===r&&(r="conversations"),e.call(this,t,r)||this}return n(t,e),t.prototype.add=function(e){return this.postCore({body:JSON.stringify(e)})},t.prototype.getById=function(e){return new l(this,e)},t}(o.GraphQueryableCollection);t.Conversations=s;var a=function(e){function t(t,r){return void 0===r&&(r="threads"),e.call(this,t,r)||this}return n(t,e),t.prototype.getById=function(e){return new c(this,e)},t.prototype.add=function(e){return this.postCore({body:JSON.stringify(e)})},t}(o.GraphQueryableCollection);t.Threads=a;var u=function(e){function t(t,r){return void 0===r&&(r="posts"),e.call(this,t,r)||this}return n(t,e),t.prototype.getById=function(e){return new p(this,e)},t.prototype.add=function(e){return this.postCore({body:JSON.stringify(e)})},t}(o.GraphQueryableCollection);t.Posts=u;var l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),Object.defineProperty(t.prototype,"threads",{get:function(){return new a(this)},enumerable:!0,configurable:!0}),t.prototype.update=function(e){return this.patchCore({body:JSON.stringify(e)})},t.prototype.delete=function(){return this.deleteCore()},t}(o.GraphQueryableInstance);t.Conversation=l;var c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),Object.defineProperty(t.prototype,"posts",{get:function(){return new u(this)},enumerable:!0,configurable:!0}),t.prototype.reply=function(e){return this.clone(t,"reply").postCore({body:JSON.stringify({post:e})})},t.prototype.delete=function(){return this.deleteCore()},t}(o.GraphQueryableInstance);t.Thread=c;var p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),Object.defineProperty(t.prototype,"attachments",{get:function(){return new i.Attachments(this)},enumerable:!0,configurable:!0}),t.prototype.delete=function(){return this.deleteCore()},t.prototype.forward=function(e){return this.clone(t,"forward").postCore({body:JSON.stringify(e)})},t.prototype.reply=function(e){return this.clone(t,"reply").postCore({body:JSON.stringify({post:e})})},t}(o.GraphQueryableInstance);t.Post=p;var d=function(e){function t(t,r){return e.call(this,t,r)||this}return n(t,e),t.prototype.add=function(e){return this.clone(t,"$ref").postCore({body:JSON.stringify({"@odata.id":e})})},t.prototype.remove=function(e){var r=this.clone(t,"$ref");return r.query.add("$id",e),r.deleteCore()},t}(o.GraphQueryableCollection);t.Senders=d},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=r(6),i=function(e){function t(t,r){return void 0===r&&(r="attachments"),e.call(this,t,r)||this}return n(t,e),t.prototype.getById=function(e){return new s(this,e)},t.prototype.addFile=function(e,t){return this.postCore({body:JSON.stringify({"@odata.type":"#microsoft.graph.fileAttachment",contentBytes:t,name:e})})},t}(o.GraphQueryableCollection);t.Attachments=i;var s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t}(o.GraphQueryableInstance);t.Attachment=s},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=r(6),i=function(e){function t(t,r){return void 0===r&&(r="planner/plans"),e.call(this,t,r)||this}return n(t,e),t.prototype.getById=function(e){return new s(this,e)},t}(o.GraphQueryableCollection);t.Plans=i;var s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t}(o.GraphQueryableInstance);t.Plan=s},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=r(6),i=r(8),s=function(e){function t(t,r){return void 0===r&&(r="photo"),e.call(this,t,r)||this}return n(t,e),t.prototype.getBlob=function(){return this.clone(t,"$value",!1).get(new i.BlobFileParser)},t.prototype.getBuffer=function(){return this.clone(t,"$value",!1).get(new i.BufferFileParser)},t.prototype.setContent=function(e){return this.clone(t,"$value",!1).patchCore({body:e})},t}(o.GraphQueryableInstance);t.Photo=s},function(e,t,r){"use strict";function n(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),n(r(80));var o=r(10);t.Dictionary=o.Dictionary;var i=r(0);t.Util=i.Util,n(r(5)),n(r(2)),n(r(15))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(49);t.CachingConfigurationProvider=n.default;var o=r(81);t.SPListConfigurationProvider=o.default},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(49),o=function(){function e(e,t){void 0===t&&(t="config"),this.sourceWeb=e,this.sourceListTitle=t}return Object.defineProperty(e.prototype,"web",{get:function(){return this.sourceWeb},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"listTitle",{get:function(){return this.sourceListTitle},enumerable:!0,configurable:!0}),e.prototype.getConfiguration=function(){return this.web.lists.getByTitle(this.listTitle).items.select("Title","Value").getAs().then(function(e){return e.reduce(function(e,t){return Object.defineProperty(e,t.Title,{configurable:!1,enumerable:!1,value:t.Value,writable:!1})},{})})},e.prototype.asCaching=function(){var e="splist_"+this.web.toUrl()+"+"+this.listTitle;return new n.default(this,e)},e}();t.default=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}(r(83))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(6);t.GraphQueryable=n.GraphQueryable,t.GraphQueryableCollection=n.GraphQueryableCollection,t.GraphQueryableInstance=n.GraphQueryableInstance,t.GraphQueryableSearchableCollection=n.GraphQueryableSearchableCollection},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(24);t.HttpClient=n.HttpClient;var o=r(85);t.SPRequestExecutorClient=o.SPRequestExecutorClient;var i=r(86);t.NodeFetchClient=i.NodeFetchClient;var s=r(35);t.FetchClient=s.FetchClient;var a=r(48);t.GraphHttpClient=a.GraphHttpClient},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(2),i=function(){function e(){this.convertToResponse=function(e){var t=new Headers;for(var r in e.headers)e.headers[r]&&t.append(r,e.headers[r]);var n=204===e.statusCode?null:e.body;return new Response(n,{headers:t,status:e.statusCode,statusText:e.statusText})}}return e.prototype.fetch=function(e,t){var r=this;if("undefined"==typeof SP||void 0===SP.RequestExecutor)throw new o.SPRequestExecutorUndefinedException;var i,s,a=e.substring(0,e.indexOf("/_api")),u=new SP.RequestExecutor(a),l={};if(t.headers&&t.headers instanceof Headers)for(i=t.headers.entries(),s=i.next();!s.done;)l[s.value[0]]=s.value[1],s=i.next();else l=t.headers;var c=["files/add","files/addTemplateFile","file/startUpload","file/continueUpload","file/finishUpload","attachmentfiles/add"],p=new RegExp(c.join("|"),"i").test(e);return new Promise(function(o,i){var s={error:function(e){i(r.convertToResponse(e))},headers:l,method:t.method,success:function(e){o(r.convertToResponse(e))},url:e};t.body&&(s=n.Util.extend(s,{body:t.body}),p&&(s=n.Util.extend(s,{binaryStringRequestBody:!0}))),u.executeAsync(s)})},e}();t.SPRequestExecutorClient=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2),o=function(){function e(){}return e.prototype.fetch=function(){throw new n.NodeFetchClientUnsupportedException},e}();t.NodeFetchClient=o},function(e,t,r){"use strict";function n(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),n(r(16)),n(r(8)),n(r(37)),n(r(22))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}(r(89))},function(e,t,r){"use strict";function n(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0});var o=r(44);t.AppCatalog=o.AppCatalog,t.App=o.App,n(r(45));var i=r(31);t.ODataBatch=i.ODataBatch;var s=r(28);t.Field=s.Field,t.Fields=s.Fields;var a=r(9);t.CheckinType=a.CheckinType,t.WebPartsPersonalizationScope=a.WebPartsPersonalizationScope,t.MoveOperations=a.MoveOperations,t.TemplateFileType=a.TemplateFileType,t.File=a.File,t.Files=a.Files;var u=r(20);t.Folder=u.Folder,t.Folders=u.Folders;var l=r(13);t.Item=l.Item,t.Items=l.Items,t.ItemVersion=l.ItemVersion,t.ItemVersions=l.ItemVersions,t.PagedItemCollection=l.PagedItemCollection;var c=r(30);t.NavigationNodes=c.NavigationNodes,t.NavigationNode=c.NavigationNode;var p=r(17);t.List=p.List,t.Lists=p.Lists;var d=r(3);t.spExtractODataId=d.spExtractODataId,t.spODataEntity=d.spODataEntity,t.spODataEntityArray=d.spODataEntityArray;var f=r(1);t.SharePointQueryable=f.SharePointQueryable,t.SharePointQueryableInstance=f.SharePointQueryableInstance,t.SharePointQueryableCollection=f.SharePointQueryableCollection;var h=r(25);t.RoleDefinitionBindings=h.RoleDefinitionBindings;var y=r(36);t.Search=y.Search,t.SearchQueryBuilder=y.SearchQueryBuilder,t.SearchResults=y.SearchResults,t.SortDirection=y.SortDirection,t.ReorderingRuleMatchType=y.ReorderingRuleMatchType,t.QueryPropertyValueType=y.QueryPropertyValueType,t.SearchBuiltInSourceId=y.SearchBuiltInSourceId;var g=r(38);t.SearchSuggest=g.SearchSuggest,t.SearchSuggestResult=g.SearchSuggestResult;var b=r(39);t.Site=b.Site,n(r(46)),n(r(19));var m=r(47);t.UtilityMethod=m.UtilityMethod;var v=r(42);t.WebPartDefinitions=v.WebPartDefinitions,t.WebPartDefinition=v.WebPartDefinition,t.WebPart=v.WebPart;var w=r(12);t.Web=w.Web}])});